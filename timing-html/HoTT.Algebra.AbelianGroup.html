<html>
<head>
<title>AbelianGroup.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for AbelianGroup.v</h1>

<div class="code" title="File: AbelianGroup.v
Line: 1
Time: 0.048s">
<div class="time" style="width: 4.4651162790698%"></div>
<pre>Require Import HoTT.Basics HoTT.Types UnivalenceImpliesFunext.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 1
Time: 0.182s">
<div class="time" style="width: 16.93023255814%"></div>
<pre>
Require Import Truncations.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 2
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import HIT.Coeq.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 3
Time: 0.234s">
<div class="time" style="width: 21.767441860465%"></div>
<pre>
Require Import Algebra.Group.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 4
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
Require Import Algebra.Subgroup.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 5
Time: 0.012s">
<div class="time" style="width: 1.1162790697674%"></div>
<pre>
Require Import Cubical.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 6
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
Import TrM.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope mc_mult_scope.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * Abelian groups *)

(** Definition of an abelian group *)

</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 14
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>Class AbGroup := {
  abgroup_type : Type;
  abgroup_sgop :&gt; SgOp abgroup_type;
  abgroup_unit :&gt; MonUnit abgroup_type;
  abgroup_inverse :&gt; Negate abgroup_type;
  abgroup_isabgroup :&gt; IsAbGroup abgroup_type;
}.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We want abelian groups to be coerced to the underlying type. *)</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Coercion abgroup_type : AbGroup &gt;-&gt; Sortclass.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The underlying group of an abelian group. *)</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition group_abgroup : AbGroup -&gt; Group.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros [G ? ? ? [l ?]].</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  ntc_rapply (Build_Group G _ _ _ l).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We also want abelian groups to be coerced to the underlying group. *)</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Coercion group_abgroup : AbGroup &gt;-&gt; Group.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Definition of Abelianization.

  Given a map F that turns any group into an abelian group, and a unit homomorphism eta_X : X -&gt; F X. This data is considered an Abelianization if and only if for all maps X -&gt; A, there exists a unique g such that h == g o eta X. *)</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 34
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>Definition IsAbelianization {G : Group} (G_ab : AbGroup)
  (eta : GroupHomomorphism G G_ab)
  := forall (A : AbGroup) (h : GroupHomomorphism G A),
    Contr (exists (g : GroupHomomorphism G_ab A), h == g o eta).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 37
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>

Existing Class IsAbelianization.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Here we define abelianization as a HIT. Specifically as a set-coequalizer of the following to maps: (a, b, c) |-&gt; a (b c) and (a, b, c) |-&gt; a (c b).

From this we can show that Abel G is an abelian group.

In fact this models the following HIT:

HIT Abel (G : Group) := 
 | ab : G -&gt; Abel G
 | ab_comm : forall x y z, ab (x * (y * z)) = ab (x * (z * y)).

We also derive ab and ab_comm from our coequalizer definition, and even prove the induction and computation rules for this HIT.

This HIT was suggested by Dan Christensen.
*)

</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Abel.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Let G be a group. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Context (G : Group).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We locally define a map uncurry2 that lets us uncurry A * B * C -&gt; D twice. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition uncurry2 {A B C D : Type}
    : (A -&gt; B -&gt; C -&gt; D) -&gt; A * B * C -&gt; D.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros f [[a b] c].</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    by apply f.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The type Abel is defined to be the set coequalizer of the following maps G^3 -&gt; G. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 69
Time: 0.003s">
<div class="time" style="width: 0.27906976744186%"></div>
<pre>Definition Abel
    := Tr 0 (Coeq
      (uncurry2 (fun a b c =&gt; a * (b * c)))
      (uncurry2 (fun a b c =&gt; a * (c * b)))).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We have a natural map from G to Abel G *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition ab : G -&gt; Abel.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro g.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply tr, coeq, g.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** This map has to satisfy the condition ab_comm *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 82
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>Definition ab_comm a b c
    : ab (a * (b * c)) = ab (a * (c * b)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (ap tr).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (cglue (a, b, c)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 86
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** It is clear that Abel is a set. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 90
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>Global Instance istrunc_abel : IsHSet Abel := _.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We can derive the induction principle from the ones for truncation and the coequalizer. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 93
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>Definition Abel_ind (P : Abel -&gt; Type) `{forall x, IsHSet (P x)} 
    (a : forall x, P (ab x)) (c : forall x y z, DPath P (ab_comm x y z)
      (a (x * (y * z))) (a (x * (z * y))))
    : forall (x : Abel), P x.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 97
Time: 0.014s">
<div class="time" style="width: 1.3023255813953%"></div>
<pre>
    serapply Trunc_ind.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 98
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
    serapply Coeq_ind.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: apply a.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 100
Time: 0.006s">
<div class="time" style="width: 0.55813953488372%"></div>
<pre>
    intros [[x y] z].</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 101
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
    refine (transport_compose _ _ _ _ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 102
Time: 0.012s">
<div class="time" style="width: 1.1162790697674%"></div>
<pre>
    serapply dp_path_transport^-1.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 103
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
    apply c.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 104
Time: 0.008s">
<div class="time" style="width: 0.74418604651163%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The computation rule can also be prove. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 108
Time: 0.003s">
<div class="time" style="width: 0.27906976744186%"></div>
<pre>Definition Abel_ind_beta_ab_comm (P : Abel -&gt; Type)
    `{forall x, IsHSet (P x)}(a : forall x, P (ab x))
    (c : forall x y z, DPath P (ab_comm x y z)
      (a (x * (y * z))) (a (x * (z * y))))
    (x y z : G) : dp_apD (Abel_ind P a c) (ab_comm x y z) = c x y z.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold ab_comm.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 114
Time: 0.003s">
<div class="time" style="width: 0.27906976744186%"></div>
<pre>
    apply dp_apD_path_transport.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 115
Time: 0.029s">
<div class="time" style="width: 2.6976744186047%"></div>
<pre>
    rewrite (apD_compose' tr).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 116
Time: 0.121s">
<div class="time" style="width: 11.255813953488%"></div>
<pre>
    rewrite (Coeq_ind_beta_cglue _ _ _ (x, y, z)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 117
Time: 0.008s">
<div class="time" style="width: 0.74418604651163%"></div>
<pre>
    unfold Abel_ind.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 118
Time: 0.055s">
<div class="time" style="width: 5.1162790697674%"></div>
<pre>
    refine (_ @ concat_1p _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 119
Time: 0.074s">
<div class="time" style="width: 6.8837209302326%"></div>
<pre>
    refine (concat_p_pp _ _ _ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 120
Time: 0.121s">
<div class="time" style="width: 11.255813953488%"></div>
<pre>
    apply whiskerR.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 121
Time: 0.042s">
<div class="time" style="width: 3.906976744186%"></div>
<pre>
    apply concat_Vp.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 122
Time: 1.075s">
<div class="time" style="width: 100%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We also have a recursion princple. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 126
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>Definition Abel_rec (P : Type) `{IsHSet P} (a : G -&gt; P)
    (c : forall x y z, a (x * (y * z)) = a (x * (z * y)))
    : Abel -&gt; P.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 129
Time: 0.003s">
<div class="time" style="width: 0.27906976744186%"></div>
<pre>
    apply (Abel_ind _ a).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros; apply dp_const, c.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Here is a simpler version of Abel_ind when our target is a HProp. This lets us discard all the higher paths. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Abel_ind_hprop (P : Abel -&gt; Type) `{forall x, IsHProp (P x)} 
    (a : forall x, P (ab x)) : forall (x : Abel), P x.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 137
Time: 0.006s">
<div class="time" style="width: 0.55813953488372%"></div>
<pre>
    serapply (Abel_ind _ a).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros; apply dp_path_transport.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_ishprop.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** And its recursion version. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Abel_rec_hprop (P : Type) `{IsHProp P}
    (a : G -&gt; P) : Abel -&gt; P.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 146
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>
    apply (Abel_rec _ a).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros; apply path_ishprop.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 149
Time: 0.81s">
<div class="time" style="width: 75.348837209302%"></div>
<pre>

End Abel.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We make sure that G is implicit in the arguments of ab and ab_comm. *)</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Arguments ab {_}.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments ab_comm {_}.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Now we can show that Abel G is infact an abelian group. *)

</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section AbelGroup.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context `{Funext} (G : Group).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Firstly we derive the operation on Abel G. This is defined as follows:
        ab x + ab y := ab (x y)
      But we need to also check that it preserves ab_comm in the appropriate way. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance abel_sgop : SgOp (Abel G).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 165
Time: 0.017s">
<div class="time" style="width: 1.5813953488372%"></div>
<pre>
    serapply Abel_rec.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro a.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 167
Time: 0.005s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      serapply Abel_rec.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro b.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (ab (a * b)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros b c d; cbn.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ab_comm _ _ _ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap _ _ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 174
Time: 0.03s">
<div class="time" style="width: 2.7906976744186%"></div>
<pre> refine (ap _ (associativity _ _ _)^ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 174
Time: 0.03s">
<div class="time" style="width: 2.7906976744186%"></div>
<pre>
        refine (associativity _ _ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 175
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 175
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ab_comm _ _ _ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 176
Time: 0.032s">
<div class="time" style="width: 2.9767441860465%"></div>
<pre>
      refine (ap _ (associativity _ _ _)^ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ab_comm _ _ _ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 178
Time: 0.031s">
<div class="time" style="width: 2.8837209302326%"></div>
<pre>
      refine (ap _ (ap _ (associativity _ _ _)^)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a b c.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 180
Time: 0.008s">
<div class="time" style="width: 0.74418604651163%"></div>
<pre>
    apply path_forall.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 181
Time: 0.101s">
<div class="time" style="width: 9.3953488372093%"></div>
<pre>
    serapply Abel_ind_hprop.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 182
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
    cbn; intro d.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 183
Time: 0.031s">
<div class="time" style="width: 2.8837209302326%"></div>
<pre>
    refine (ap _ (associativity _ _ _)^ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 184
Time: 0.031s">
<div class="time" style="width: 2.8837209302326%"></div>
<pre>
    refine (ap _ (ap _ (associativity _ _ _)^) @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ab_comm _ _ _ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 186
Time: 0.03s">
<div class="time" style="width: 2.7906976744186%"></div>
<pre>
    refine (ap _ (ap _ (associativity _ _ _)^) @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 187
Time: 0.036s">
<div class="time" style="width: 3.3488372093023%"></div>
<pre>
    refine (ap _ (associativity _ _ _) @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ab_comm _ _ _ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 189
Time: 0.035s">
<div class="time" style="width: 3.2558139534884%"></div>
<pre>
    refine (ap _ (associativity _ _ _)^ @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 190
Time: 0.033s">
<div class="time" style="width: 3.0697674418605%"></div>
<pre>
    refine (ap _ (ap _ (associativity _ _ _)) @ _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 191
Time: 0.034s">
<div class="time" style="width: 3.1627906976744%"></div>
<pre>
    refine (ap _ (associativity _ _ _)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 192
Time: 0.046s">
<div class="time" style="width: 4.2790697674419%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We can now easily show that this operation is associative by associativity in G and the fact that being associative is a proposition. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance abel_sgop_associative : Associative abel_sgop.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 197
Time: 0.025s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>
    serapply Abel_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 198
Time: 0.026s">
<div class="time" style="width: 2.4186046511628%"></div>
<pre>
    serapply Abel_ind_hprop; intro y.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 199
Time: 0.016s">
<div class="time" style="width: 1.4883720930233%"></div>
<pre>
    serapply Abel_ind_hprop; intro z.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 200
Time: 0.047s">
<div class="time" style="width: 4.3720930232558%"></div>
<pre>
    cbn; apply ap, associativity.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 201
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 202
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** From this we know that Abel G is a semigroup. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 205
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>Global Instance abel_issemigroup : IsSemiGroup (Abel G) := {}.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We define the unit as ab of the unit of G *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 208
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>Global Instance abel_mon_unit : MonUnit (Abel G) := ab mon_unit.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** By using Abel_ind_hprop we can prove the left and right identity laws. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance abel_leftidentity : LeftIdentity abel_sgop abel_mon_unit.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 212
Time: 0.013s">
<div class="time" style="width: 1.2093023255814%"></div>
<pre>
    serapply Abel_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 213
Time: 0.02s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>
    cbn; apply ap, left_identity.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 214
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance abel_rightidentity : RightIdentity abel_sgop abel_mon_unit.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 218
Time: 0.017s">
<div class="time" style="width: 1.5813953488372%"></div>
<pre>
    serapply Abel_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 219
Time: 0.02s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>
    cbn; apply ap, right_identity.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 220
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Hence Abel G is a monoid *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 224
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>Global Instance ismonoid_abel : IsMonoid (Abel G) := {}.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 224
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We can also prove that the operation is commutative! This will come in handy later. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance abel_commutative : Commutative abel_sgop.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 228
Time: 0.017s">
<div class="time" style="width: 1.5813953488372%"></div>
<pre>
    serapply Abel_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 229
Time: 0.013s">
<div class="time" style="width: 1.2093023255814%"></div>
<pre>
    serapply Abel_ind_hprop; intro y.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 230
Time: 0.007s">
<div class="time" style="width: 0.65116279069767%"></div>
<pre>
    cbn.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 231
Time: 0.005s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    rewrite &lt;- (left_identity (x * y)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 232
Time: 0.006s">
<div class="time" style="width: 0.55813953488372%"></div>
<pre>
    rewrite &lt;- (left_identity (y * x)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ab_comm.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 234
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 235
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Now we can define the negation. This is just
        - (ab g) := (ab (g^-1) 
      However when checking that it respects ab_comm we have to show the following:
        ab (- z * - y * - x) = ab (- y * - z * - x)
      there is no obvious way to do this, but we note that ab (x * y) is exactly the definition of ab x + ab y! Hence by commutativity we can show this. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance abel_negate : Negate (Abel G).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 243
Time: 0.004s">
<div class="time" style="width: 0.37209302325581%"></div>
<pre>
    serapply Abel_rec.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro g.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (ab (-g)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x y z; cbn.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 247
Time: 0.007s">
<div class="time" style="width: 0.65116279069767%"></div>
<pre>
    rewrite ?negate_sg_op.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 248
Time: 0.004s">
<div class="time" style="width: 0.37209302325581%"></div>
<pre>
    change (ab(- z) * ab(- y) * ab (- x) = ab (- y) * ab (- z) * ab(- x)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 249
Time: 0.005s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    by rewrite (commutativity (ab (-z)) (ab (-y))).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 250
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 251
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Again by Abel_ind_hprop and the corresponding laws for G we can prove the left and right inverse laws. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance abel_leftinverse : LeftInverse abel_sgop abel_negate abel_mon_unit.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 255
Time: 0.015s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
    serapply Abel_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 256
Time: 0.005s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    cbn; apply ap; apply left_inverse.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 257
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 258
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Instance abel_rightinverse : RightInverse abel_sgop abel_negate abel_mon_unit.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 260
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 261
Time: 0.013s">
<div class="time" style="width: 1.2093023255814%"></div>
<pre>
    serapply Abel_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 262
Time: 0.005s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    cbn; apply ap; apply right_inverse.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 263
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Thus Abel G is a group *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 267
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>Global Instance isgroup_abel : IsGroup (Abel G) := {}.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** And since the operation is commutative and abelian group. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 270
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>Global Instance isabgroup_abel : IsAbGroup (Abel G) := {}.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 270
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** By definition, the map ab is also a group homomorphism. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 273
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance issemigrouppreserving_ab : IsSemiGroupPreserving ab.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 273
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 274
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
    by unfold IsSemiGroupPreserving.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 275
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 276
Time: 0.034s">
<div class="time" style="width: 3.1627906976744%"></div>
<pre>

End AbelGroup.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We can easily prove that ab is a surjection. *)</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance issurj_ab `{Funext} {G : Group} : IsSurjection ab.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 281
Time: 0.011s">
<div class="time" style="width: 1.0232558139535%"></div>
<pre>
  serapply Abel_ind_hprop.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro x; cbn.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exists (tr (x; @idpath _ (ab x))).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_ishprop.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 285
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Now we finally check that our definition of abelianization satisfies the universal property of being an abelianization. *)</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 288
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Abelianization.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 288
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context `{Funext}.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 290
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We define abel to be the abelianization of a group. This is a map from Group to AbGroup. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition abel : Group -&gt; AbGroup.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 294
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro G.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 295
Time: 0.004s">
<div class="time" style="width: 0.37209302325581%"></div>
<pre>
    serapply (Build_AbGroup (Abel G)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 296
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The unit of this map is the map ab which typeclasses can pick up to be a homomorphism. We write it out explicitly here. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition abel_unit (X : Group)
    : GroupHomomorphism X (abel X).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simple notypeclasses refine (Build_GroupHomomorphism _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 303
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact ab.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Finally we can prove that our construction abel is an abelianization. *)
 </pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 309
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isabelianization_abel {G : Group}
    : IsAbelianization (abel G) (abel_unit G).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A h.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    serapply Build_Contr.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 314
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre> srefine (_;_).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simple notypeclasses refine (Build_GroupHomomorphism _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        {</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 316
Time: 0.037s">
<div class="time" style="width: 3.4418604651163%"></div>
<pre> serapply (Abel_rec _ _ h).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          intros x y z.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 317
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
          refine (grp_homo_op _ _ _ @ _ @ (grp_homo_op _ _ _)^).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 318
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply (ap (_ *.)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 319
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          refine (grp_homo_op _ _ _ @ _ @ (grp_homo_op _ _ _)^).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 320
Time: 0.017s">
<div class="time" style="width: 1.5813953488372%"></div>
<pre>
          apply commutativity.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 321
Time: 0.116s">
<div class="time" style="width: 10.790697674419%"></div>
<pre>
        serapply Abel_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 322
Time: 0.072s">
<div class="time" style="width: 6.6976744186047%"></div>
<pre>
        serapply Abel_ind_hprop; intro y.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 323
Time: 0.02s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>
        apply grp_homo_op.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 324
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 324
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>
      cbn; reflexivity.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 325
Time: 0.2s">
<div class="time" style="width: 18.604651162791%"></div>
<pre>
    intros [g p].</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 326
Time: 0.182s">
<div class="time" style="width: 16.93023255814%"></div>
<pre>
    apply path_sigma_hprop; cbn.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 327
Time: 0.015s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
    apply equiv_path_grouphomomorphism.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 328
Time: 0.506s">
<div class="time" style="width: 47.06976744186%"></div>
<pre>
    serapply Abel_ind_hprop.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact p.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 330
Time: 0.663s">
<div class="time" style="width: 61.674418604651%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 331
Time: 0.206s">
<div class="time" style="width: 19.162790697674%"></div>
<pre>

End Abelianization.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem groupiso_isabelianization {G : Group}
  (A B : AbGroup)
  (eta1 : GroupHomomorphism G A)
  (eta2 : GroupHomomorphism G B)
  {x : IsAbelianization A eta1}
  {y : IsAbelianization B eta2}
  : GroupIsomorphism A B.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 342
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold IsAbelianization in x, y.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 343
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
  destruct (x B eta2) as [[a ah] ac].</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 344
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>
  destruct (y A eta1) as [[b bh] bc].</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 345
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>
  destruct (x A eta1) as [[c ch] cc].</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 346
Time: 0.003s">
<div class="time" style="width: 0.27906976744186%"></div>
<pre>
  destruct (y B eta2) as [[d dh] dc].</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 347
Time: 0.104s">
<div class="time" style="width: 9.6744186046512%"></div>
<pre>
  serapply (Build_GroupIsomorphism _ _ a).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 348
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
  serapply (isequiv_adjointify _ b).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 349
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 350
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap10.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 350
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change (@grp_homo_map _ _ (grp_homo_compose a b)
      = @grp_homo_map _ _ grp_homo_id).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 352
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ap (@grp_homo_map _ _) _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 353
Time: 0.003s">
<div class="time" style="width: 0.27906976744186%"></div>
<pre>
    refine (ap pr1 ((dc (_; _))^ @ dc (grp_homo_id; _))).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 354
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
    1: exact (fun i =&gt; ah i @ ap a (bh i)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 355
Time: 0.005s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 356
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 356
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 357
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre> apply ap10.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 357
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change (@grp_homo_map _ _ (grp_homo_compose b a)
      = @grp_homo_map _ _ grp_homo_id).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 359
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ap (@grp_homo_map _ _) _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 360
Time: 0.003s">
<div class="time" style="width: 0.27906976744186%"></div>
<pre>
    refine (ap pr1 ((cc (_; _))^ @ cc (grp_homo_id; _))).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 361
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
    1: exact (fun i =&gt; bh i @ ap b (ah i)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 362
Time: 0.006s">
<div class="time" style="width: 0.55813953488372%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 363
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 363
Time: 0.082s">
<div class="time" style="width: 7.6279069767442%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 364
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>

Theorem homotopic_isabelianization {G : Group} (A B : AbGroup)
  (eta1 : GroupHomomorphism G A) (eta2 : GroupHomomorphism G B)
  {x : IsAbelianization A eta1} {y : IsAbelianization B eta2}
  : eta2 == grp_homo_compose (groupiso_isabelianization A B eta1 eta2) eta1.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 369
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 370
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold IsAbelianization in x, y.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 371
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>
  destruct (x B eta2) as [[a ah] ac].</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 372
Time: 0.003s">
<div class="time" style="width: 0.27906976744186%"></div>
<pre>
  destruct (y A eta1) as [[b bh] bc].</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 373
Time: 0.018s">
<div class="time" style="width: 1.6744186046512%"></div>
<pre>
  refine (transport (fun e : GroupHomomorphism A B
    =&gt; _ == (fun x : G =&gt; e (eta1 x))) (ap pr1 (ac _)) ah).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 375
Time: 0.004s">
<div class="time" style="width: 0.37209302325581%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Hence any abelianization is surjective. *)</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 378
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>Global Instance issurj_isabelianization `{Funext} {G : Group}
  (A : AbGroup) (eta : GroupHomomorphism G A)
  : IsAbelianization A eta -&gt; IsSurjection eta.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 381
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros k.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 382
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
  pose (homotopic_isabelianization A (abel G) eta (abel_unit G)) as p.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 383
Time: 0.006s">
<div class="time" style="width: 0.55813953488372%"></div>
<pre>
  refine (@cancelR_isequiv_conn_map _ _ _ _ _ _ _
    (conn_map_homotopic _ _ _ p _)).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 385
Time: 0.003s">
<div class="time" style="width: 0.27906976744186%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 386
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance isequiv_abgroup_abelianization `{U : Univalence}
  (A B : AbGroup) (eta : GroupHomomorphism A B) {H : IsAbelianization B eta}
  : IsEquiv eta.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 390
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 391
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>
  destruct (H A grp_homo_id) as [[a ah] ac].</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 392
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  serapply (isequiv_adjointify eta a).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 394
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 394
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Require HIT.epi.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 395
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ap10.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 396
Time: 0.038s">
<div class="time" style="width: 3.5348837209302%"></div>
<pre>
    pose (epi.issurj_isepi eta _) as i.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 397
Time: 0.03s">
<div class="time" style="width: 2.7906976744186%"></div>
<pre>
    refine (i _ _ idmap _).</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 398
Time: 0.001s">
<div class="time" style="width: 0.093023255813954%"></div>
<pre>
    apply path_forall.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 399
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro x.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ap.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 401
Time: 0.002s">
<div class="time" style="width: 0.18604651162791%"></div>
<pre>
    symmetry.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ah.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 403
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 404
Time: 0.003s">
<div class="time" style="width: 0.27906976744186%"></div>
<pre> change (a o eta == idmap); symmetry.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 404
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ah.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 405
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre></pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 405
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ap10.
    pose (epi.issurj_isepi eta _) as i.
    refine (i _ _ idmap _).
    apply path_forall.
    intro x.
    apply ap.
    symmetry.
    apply ah.
  + change (a o eta == idmap); symmetry.
    apply ah.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 415
Time: 0.003s">
<div class="time" style="width: 0.27906976744186%"></div>
<pre>Defined.</pre>
</div>
<div class="code" title="File: AbelianGroup.v
Line: 416
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

