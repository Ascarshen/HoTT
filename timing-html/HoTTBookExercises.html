<html>
<head>
<title>HoTTBookExercises.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for HoTTBookExercises.v</h1>

<div class="code" title="File: HoTTBookExercises.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** The HoTT Book Exercises formalization. *)

(** This file records formalized solutions to the HoTT Book exercises. *)

(*  See HoTTBook.v for an IMPORTANT NOTE FOR THE HoTT DEVELOPERS.

    PROCEDURE FOR UPDATING THE FILE:

   1. Compile the latest version of the HoTT Book to update the LaTeX
      labels. Do not forget to pull in changes from HoTT/HoTT.

   2. Run `etc/Book.py` using the `--exercises` flag (so your command
      should look like `cat ../book/*.aux | etc/Book.py --exercises contrib/HoTTBookExercises.v`)
      If it complains, fix things.

   3. Add contents to new entries.

   4. Run `etc/Book.py` again to make sure it is happy.

   5. Compile this file with `make contrib` or `make contrib/HoTTBookExercises.vo`.

   6. Do the git thing to submit your changes.

*)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 25
Time: 1.618s">
<div class="time" style="width: 100%"></div>
<pre>Require Import HoTT Coq.Init.Peano.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import UnivalenceImpliesFunext.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* END OF PREAMBLE *)
(* ================================================== ex:composition *)
(** Exercise 1.1 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_1_1 := (fun (A B C : Type) (f : A -&gt; B) (g : B -&gt; C) =&gt; g o f).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 33
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>

Theorem Book_1_1_refl : forall (A B C D : Type) (f : A -&gt; B) (g : B -&gt; C) (h : C -&gt; D),
                          h o (g o f) = (h o g) o f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:pr-to-rec *)
(** Exercise 1.2 *)

(** Recursor as equivalence. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_1_2_prod_lib := @HoTT.Types.Prod.equiv_uncurry.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Section Book_1_2_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable A B : Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Recursor with projection functions instead of pattern-matching. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Let prod_rec_proj C (g : A -&gt; B -&gt; C) (p : A * B) : C :=
    g (fst p) (snd p).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_1_2_prod := prod_rec_proj.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Proposition Book_1_2_prod_fst : fst = prod_rec_proj A (fun a b =&gt; a).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Proposition Book_1_2_prod_snd : snd = prod_rec_proj B (fun a b =&gt; b).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_2_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Recursor as (dependent) equivalence. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_1_2_sig_lib := @HoTT.Types.Sigma.equiv_sigT_ind.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Section Book_1_2_sig.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable A : Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable B : A -&gt; Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Non-dependent recursor with projection functions instead of pattern matching. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Let sig_rec_proj C (g : forall (x : A), B x -&gt; C) (p : exists (x : A), B x) : C :=
    g (pr1 p) (pr2 p).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_1_2_sig := @sig_rec_proj.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Proposition Book_1_2_sig_fst : @pr1 A B = sig_rec_proj A (fun a =&gt; fun b =&gt; a).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** NB: You cannot implement pr2 with only the recursor, so it is not possible
      to check its definitional equality as the exercise suggests. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>End Book_1_2_sig.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:pr-to-ind *)
(** Exercise 1.3 *)

(** The propositional uniqueness principles are named with an
    'eta' postfix in the HoTT library. *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_1_3_prod_lib := @HoTT.Types.Prod.prod_ind.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Section Book_1_3_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable A B : Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Let prod_ind_eta (C : A * B -&gt; Type) (g : forall (x : A) (y : B), C (x, y)) (x : A * B) : C x :=
    transport C (HoTT.Types.Prod.eta_prod x) (g (fst x) (snd x)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_1_3_prod := prod_ind_eta.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Proposition Book_1_3_prod_refl : forall C g a b, prod_ind_eta C g (a, b) = g a b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_3_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_1_3_sig_lib := @Coq.Init.Specif.sigT_ind.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Section Book_1_3_sig.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable A : Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable B : A -&gt; Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 104
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>

  Let sig_ind_eta (C : (exists (a : A), B a) -&gt; Type)
                          (g : forall (a : A) (b : B a), C (a; b))
                          (x : exists (a : A), B a) : C x :=
    transport C (HoTT.Types.Sigma.eta_sigma x) (g (pr1 x) (pr2 x)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_1_3_sig := sig_ind_eta.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Proposition Book_1_3_sig_refl : forall C g a b, sig_ind_eta C g (a; b) = g a b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_3_sig.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:iterator *)
(** Exercise 1.4 *)



(* ================================================== ex:sum-via-bool *)
(** Exercise 1.5 *)



(* ================================================== ex:prod-via-bool *)
(** Exercise 1.6 *)



(* ================================================== ex:pm-to-ml *)
(** Exercise 1.7 *)



(* ================================================== ex:nat-semiring *)
(** Exercise 1.8 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint rec_nat' (C : Type) c0 cs (n : nat) : C :=
  match n with
    0 =&gt; c0
  | S m =&gt; cs m (rec_nat' C c0 cs m)
  end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition add : nat -&gt; nat -&gt; nat :=
  rec_nat' (nat -&gt; nat) (fun m =&gt; m) (fun n g m =&gt; (S (g m))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition mult : nat -&gt; nat -&gt; nat  :=
  rec_nat' (nat -&gt; nat) (fun m =&gt; 0) (fun n g m =&gt; add m (g m)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* rec_nat' gives back a function with the wrong argument order, so we flip the
   order of the arguments p and q *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition exp : nat -&gt; nat -&gt; nat  :=
  fun p q =&gt; (rec_nat' (nat -&gt; nat) (fun m =&gt; (S 0)) (fun n g m =&gt; mult m (g m))) q p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Example add_example: add 32 17 = 49.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Example mult_example: mult 20 5 = 100.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 157
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre> Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 157
Time: 0.004s">
<div class="time" style="width: 0.24721878862794%"></div>
<pre>
Example exp_example: exp 2 10 = 1024.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 158
Time: 0.006s">
<div class="time" style="width: 0.3708281829419%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 158
Time: 0.011s">
<div class="time" style="width: 0.67985166872682%"></div>
<pre> Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* To do: proof that these form a semiring *)

(* ================================================== ex:fin *)
(** Exercise 1.9 *)



(* ================================================== ex:ackermann *)
(** Exercise 1.10 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint ack (n m : nat) : nat :=
  match n with
  | O =&gt; S m
  | S p =&gt; let fix ackn (m : nat) :=
               match m with
                 | O =&gt; ack p 1
                 | S q =&gt; ack p (ackn q)
               end
           in ackn m
  end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_1_10 := ack.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:neg-ldn *)
(** Exercise 1.11 *)



(* ================================================== ex:tautologies *)
(** Exercise 1.12 *)



(* ================================================== ex:not-not-lem *)
(** Exercise 1.13 *)



(* ================================================== ex:without-K *)
(** Exercise 1.14 *)



(* ================================================== ex:subtFromPathInd *)
(** Exercise 1.15 *)

(* concat_A1p? *)

(* ================================================== ex:add-nat-commutative *)
(** Exercise 1.16 *)



(* ================================================== ex:basics:concat *)
(** Exercise 2.1 *)

(* Book_2_1_concatenation1 is equivalent to the proof given in the text *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_1_concatenation1 :
    forall {A : Type} {x y z : A}, x = y -&gt; y = z -&gt; x = z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A x y z x_eq_y y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction x_eq_y.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_2_1_concatenation2 :
    forall {A : Type} {x y z : A}, x = y -&gt; y = z -&gt; x = z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 224
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A x y z x_eq_y y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction x_eq_y.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 226
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 228
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_2_1_concatenation3 :
    forall {A : Type} {x y z : A}, x = y -&gt; y = z -&gt; x = z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 231
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A x y z x_eq_y y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact x_eq_y.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 235
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Notation "p *1 q" := (Book_2_1_concatenation1 p q) (at level 10).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Notation "p *2 q" := (Book_2_1_concatenation2 p q) (at level 10).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Notation "p *3 q" := (Book_2_1_concatenation3 p q) (at level 10).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section Book_2_1_Proofs_Are_Equal.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 241
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {A : Type} {x y z : A}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable (p : x = y) (q : y = z).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_2_1_concatenation1_eq_Book_2_1_concatenation2 : p *1 q = p *2 q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 244
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    induction p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_1_concatenation2_eq_Book_2_1_concatenation3 : p *2 q =  p *3 q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 249
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    induction p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 251
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_1_concatenation1_eq_Book_2_1_concatenation3 : p *1 q = p *3 q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 254
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    induction p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 257
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_2_1_Proofs_Are_Equal.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 258
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:eq-proofs-commute *)
(** Exercise 2.2 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 262
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>Definition Book_2_2 :
  forall {A : Type} {x y z : A} (p : x = y) (q : y = z), 
    (Book_2_1_concatenation1_eq_Book_2_1_concatenation2 p q) *1
    (Book_2_1_concatenation2_eq_Book_2_1_concatenation3 p q) =
    (Book_2_1_concatenation1_eq_Book_2_1_concatenation3 p q).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 266
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  induction p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 268
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:fourth-concat *)
(** Exercise 2.3 *)

(* Since we have x_eq_y : x = y we can transport y_eq_z : y = z along
   x_eq_y⁻¹ : y = x in the type family λw.(w = z) to obtain a term
   of type x = z. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 276
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_1_concatenation4 
    {A : Type} {x y z : A} : x = y -&gt; y = z -&gt; x = z :=
  fun x_eq_y y_eq_z =&gt; transport (fun w =&gt; w = z) (inverse x_eq_y) y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Notation "p *4 q" := (Book_2_1_concatenation4 p q) (at level 10).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Definition Book_2_1_concatenation1_eq_Book_2_1_concatenation4 :
    forall {A : Type} {x y z : A} (p : x = y) (q : y = z), (p *1 q = p *4 q).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:npaths *)
(** Exercise 2.4 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_4_npath : nat -&gt; Type -&gt; Type
  := nat_ind (fun (n : nat) =&gt; Type -&gt; Type)
             (* 0-dimensional paths are elements *)
             (fun A =&gt; A)
             (* (n+1)-dimensional paths are paths between n-dimimensional paths *)
             (fun n f A =&gt; (exists a1 a2 : (f A), a1 = a2)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 294
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* This is the intuition behind definition of nboundary:
   As we've defined them, every (n+1)-path is a path between two n-paths. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma npath_as_sig : forall {n : nat} {A : Type},
    (Book_2_4_npath (S n) A) = (exists (p1 p2 : Book_2_4_npath n A), p1 = p2).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* It can be helpful to take a look at what this definition does.
   Try uncommenting the following lines: *)
(*
Context {A : Type}.
Eval compute in (Book_2_4_npath 0 A). (* = A : Type *)
Eval compute in (Book_2_4_npath 1 A). (* = {a1 : A &amp; {a2 : A &amp; a1 = a2}} : Type *)
Eval compute in (Book_2_4_npath 2 A). (* and so on... *)
*)

(* Given an (n+1)-path, we simply project to a pair of n-paths. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 311
Time: 0.02s">
<div class="time" style="width: 1.2360939431397%"></div>
<pre>Definition Book_2_4_nboundary
  : forall {n : nat} {A : Type}, Book_2_4_npath (S n) A -&gt;
                          (Book_2_4_npath n A * Book_2_4_npath n A)
  := fun {n} {A} p =&gt; (pr1 p, pr1 (pr2 p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:ap-to-apd-equiv-apd-to-ap *)
(** Exercise 2.5 *)

(* Note that "@" is notation for concatentation and ^ is for inversion *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 320
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>Definition Book_eq_2_3_6 {A B : Type} {x y : A} (p : x = y) (f : A -&gt; B)
  : (f x = f y) -&gt; (transport (fun _ =&gt; B) p (f x) = f y) :=
  fun fx_eq_fy =&gt;
    (HoTT.Basics.PathGroupoids.transport_const p (f x)) @ fx_eq_fy.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 323
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>

Definition Book_eq_2_3_7 {A B : Type} {x y : A} (p : x = y) (f : A -&gt; B)
  : (transport (fun _ =&gt; B) p (f x) = f y) -&gt; f x = f y :=
  fun fx_eq_fy =&gt;
    (HoTT.Basics.PathGroupoids.transport_const p (f x))^ @ fx_eq_fy.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 328
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* By induction on p, it suffices to assume that x ≡ y and p ≡ refl, so
   the above equations concatenate identity paths, which are units under 
   concatenation.

   [isequiv_adjointify] is one way to prove two functions form an equivalence,
   specifically one proves that they are (category-theoretic) sections of one
   another, that is, each is a right inverse for the other. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Equivalence_Book_eq_2_3_6_and_Book_eq_2_3_6
           {A B : Type} {x y : A} (p : x = y) (f : A -&gt; B)
    : IsEquiv (Book_eq_2_3_6 p f).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 338
Time: 0.006s">
<div class="time" style="width: 0.3708281829419%"></div>
<pre>
  apply (isequiv_adjointify (Book_eq_2_3_6 p f) (Book_eq_2_3_7 p f));
    unfold Book_eq_2_3_6, Book_eq_2_3_7, transport_const, Sect;
    induction p;
    intros y;
    do 2 (rewrite concat_1p);
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 344
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 345
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:equiv-concat *)
(** Exercise 2.6 *)

(* This exercise is solved in the library as
   HoTT.Types.Paths.isequiv_concat_l
 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 353
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition concat_left {A : Type} {x y : A} (z : A) (p : x = y)
    : (y = z) -&gt; (x = z) :=
  fun q =&gt; p @ q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 355
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition concat_right {A : Type} {x y : A} (z : A) (p : x = y)
    : (x = z) -&gt; (y = z) :=
  fun q =&gt; (inverse p) @ q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 359
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Again, by induction on p, it suffices to assume that x ≡ y and p ≡ refl, so
   the above equations concatenate identity paths, which are units under 
   concatenation. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 363
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_6 {A : Type} {x y z : A} (p : x = y)
  : IsEquiv (concat_left z p).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 364
Time: 0.004s">
<div class="time" style="width: 0.24721878862794%"></div>
<pre>
  apply (isequiv_adjointify (concat_left z p) (concat_right z p));
    induction p;
    unfold Sect, concat_right, concat_left;
    intros y;
    do 2 (rewrite concat_1p);
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 370
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 371
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:ap-sigma *)
(** Exercise 2.7 *)



(* ================================================== ex:ap-coprod *)
(** Exercise 2.8 *)



(* ================================================== ex:coprod-ump *)
(** Exercise 2.9 *)

(* This exercise is solved in the library as
   HoTT.Types.Sum.equiv_sum_ind
 *)
(* To extract a function on either summand, compose with the injections *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 389
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>Definition coprod_ump1 {A B X} : (A + B -&gt; X) -&gt; (A -&gt; X) * (B -&gt; X) :=
  fun f =&gt; (f o inl, f o inr).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 390
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* To create a function on the direct sum from functions on the summands, work
   by cases *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Check prod_rect.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 393
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
Definition coprod_ump2 {A B X} : (A -&gt; X) * (B -&gt; X) -&gt; (A + B -&gt; X) :=
  prod_rect (fun _ =&gt; A + B -&gt; X) (fun f g =&gt; sum_rect (fun _ =&gt; X) f g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 395
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_2_9 {A B X} `{Funext} : (A -&gt; X) * (B -&gt; X) &lt;~&gt; (A + B -&gt; X).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 397
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (equiv_adjointify coprod_ump2 coprod_ump1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 398
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 399
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 399
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [a | b]; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 401
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [f g].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 403
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 404
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:sigma-assoc *)
(** Exercise 2.10 *)

(* This exercise is solved in the library as
   HoTT.Types.Sigma.equiv_sigma_assoc
 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 412
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section TwoTen.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 412
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{A : Type} {B : A -&gt; Type} {C : (exists a : A, B a) -&gt; Type}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 413
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>

  Local Definition f210 : (exists a : A, (exists b : B a, (C (a; b)))) -&gt;
                          (exists (p : exists a : A, B a), (C p)) :=
    fun pairpair =&gt;
      match pairpair with (a; pp) =&gt;
        match pp with (b; c) =&gt; ((a; b); c) end
      end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 420
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Definition g210 : (exists (p : exists a : A, B a), (C p)) -&gt;
                          (exists a : A, (exists b : B a, (C (a; b)))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 423
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros pairpair.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 424
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction pairpair as [pair c].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 425
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction pair as [a b].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 426
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (a; (b; c)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_10 : (exists a : A, (exists b : B a, (C (a; b)))) &lt;~&gt;
                         (exists (p : exists a : A, B a), (C p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 431
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (equiv_adjointify f210 g210); compute; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 432
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 433
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End TwoTen.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 434
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:pullback *)
(** Exercise 2.11 *)



(* ================================================== ex:pullback-pasting *)
(** Exercise 2.12 *)



(* ================================================== ex:eqvboolbool *)
(** Exercise 2.13 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 448
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_13 := @HoTT.Types.Bool.equiv_bool_aut_bool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 448
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:equality-reflection *)
(** Exercise 2.14 *)



(* ================================================== ex:strengthen-transport-is-ap *)
(** Exercise 2.15 *)



(* ================================================== ex:strong-from-weak-funext *)
(** Exercise 2.16 *)



(* ================================================== ex:equiv-functor-types *)
(** Exercise 2.17 *)



(* ================================================== ex:equiv-functor-set *)
(** Exercise 3.1 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 472
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_1_solution_1 {A B} (f : A &lt;~&gt; B) (H : IsHSet A)
  := @HoTT.Basics.Trunc.trunc_equiv' A B f 0 H.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 473
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Alternative solutions: [Book_3_1_solution_2] using UA, and [Book_3_1_solution_3] using two easy lemmas that may be of independent interest *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 476
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_1_solution_2 `{Univalence} {A B} : A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 476
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 477
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro e.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 478
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite (path_universe_uncurried e).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 479
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact idmap.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 480
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 481
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>

Lemma retr_f_g_path_in_B {A B} (f : A -&gt; B)  (g : B -&gt; A) (alpha : Sect g f) (x y : B) (p : x = y)
      :  p = (alpha x)^ @ (ap f (ap g p)) @ (alpha y).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 484
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 485
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 486
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 487
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite concat_p1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 488
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite concat_Vp.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 489
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 490
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 491
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma retr_f_g_isHSet_A_so_B {A B} (f : A -&gt; B)  (g : B -&gt; A)
      : Sect g f -&gt; IsHSet A -&gt; IsHSet B.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 494
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 495
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros retr_f_g isHSet_A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  serapply hset_axiomK.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 497
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold axiomK.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 497
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 498
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (ap g p = 1) as g_p_is_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 499
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 500
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply (axiomK_hset isHSet_A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 500
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 501
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assert (1 = (retr_f_g x) ^ @ (ap f (ap g p)) @ (retr_f_g x)) as rhs_is_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 501
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite g_p_is_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 502
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre> rewrite concat_p1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite concat_Vp.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite (rhs_is_1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (retr_f_g_path_in_B f g retr_f_g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 504
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 505
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma Book_3_1_solution_3 {A B} : A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 507
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 508
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros equivalent_A_B isHSet_A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 509
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  elim equivalent_A_B; intros f isequiv_f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 510
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  elim isequiv_f; intros g retr_f_g sect_f_g coh.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 511
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (retr_f_g_isHSet_A_so_B f g); assumption.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 512
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 513
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:isset-coprod *)
(** Exercise 3.2 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 517
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_2_solution_1 := @HoTT.Types.Sum.hset_sum.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 517
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Alternative solution for replaying *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 520
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_2_solution_2 (A B : Type) : IsHSet A -&gt; IsHSet B -&gt; IsHSet (A+B).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 520
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 521
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros isHSet_A isHSet_B.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 522
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  serapply hset_axiomK.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 523
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold axiomK.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 523
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 523
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 523
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 524
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre> rewrite (inverse (eisretr_path_sum p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 524
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    rewrite (axiomK_hset isHSet_A a (path_sum_inv p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 525
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl; exact idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 526
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 527
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre> rewrite (inverse (eisretr_path_sum p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 527
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    rewrite (axiomK_hset isHSet_B b (path_sum_inv p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 528
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl; exact idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 529
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 530
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:isset-sigma *)
(** Exercise 3.3 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 534
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_3_solution_1 (A : Type) (B : A -&gt; Type)
   := @HoTT.Types.Sigma.trunc_sigma A B 0.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 535
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** This exercise is hard because 2-paths over Sigma types are not treated in the first three chapters of the book. Consult theories/Types/Sigma.v *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 538
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_3_solution_2 (A : Type) (B : A -&gt; Type) :
  IsHSet A -&gt; (forall x:A, IsHSet (B x)) -&gt; IsHSet { x:A | B x}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 539
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 540
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros isHSet_A allBx_HSet.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 541
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  serapply hset_axiomK.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 542
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x xx.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 542
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (path_path_sigma B x x xx 1) as useful.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 543
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  apply (useful (axiomK_hset _ _ _) (hset_path2 _ _)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 544
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 545
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:prop-endocontr *)
(** Exercise 3.4 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 549
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_4_solution_1 `{Funext} (A : Type) : IsHProp A &lt;-&gt; Contr (A -&gt; A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 549
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 550
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  split.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 551
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 552
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro isHProp_A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 552
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists idmap.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 553
Time: 0.005s">
<div class="time" style="width: 0.30902348578492%"></div>
<pre>
    apply path_ishprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 554
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* automagically, from IsHProp A *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 555
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 555
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro contr_AA.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 555
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply hprop_allpath; intros a1 a2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 556
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (ap10 (path_contr (fun x:A =&gt; a1) (fun x:A =&gt; a2)) a1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 557
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 558
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:prop-inhabcontr *)
(** Exercise 3.5 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 562
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_5_solution_1 := @HoTT.HProp.equiv_hprop_inhabited_contr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 562
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:lem-mereprop *)
(** Exercise 3.6 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 566
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_6_solution_1 `{Funext} (A : Type) : IsHProp A -&gt; IsHProp (A + ~A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 566
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 567
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro isHProp_A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 568
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply hprop_allpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 569
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 569
Time: 0.018s">
<div class="time" style="width: 1.1124845488257%"></div>
<pre>
  destruct x as [a1|n1]; destruct y as [a2|n2]; apply path_sum; try apply path_ishprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 570
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (n2 a1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 572
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (n1 a2).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 572
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 573
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:disjoint-or *)
(** Exercise 3.7 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 577
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_7_solution_1 (A B: Type) :
  IsHProp A -&gt; IsHProp B -&gt; ~(A*B) -&gt; IsHProp (A+B).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 578
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 579
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros isHProp_A isProp_B nab.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 580
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply hprop_allpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 581
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 581
Time: 0.003s">
<div class="time" style="width: 0.18541409147095%"></div>
<pre>
  destruct x as [a1|b1]; destruct y as [a2|b2]; apply path_sum; try apply path_ishprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 582
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 583
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (nab (a1,b2)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 583
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 584
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (nab (a2,b1)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 584
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 585
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:brck-qinv *)
(** Exercise 3.8 *)



(* ================================================== ex:lem-impl-prop-equiv-bool *)
(** Exercise 3.9 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 594
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition LEM := forall (A : Type), IsHProp A -&gt; A + ~A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 594
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>

Definition LEM_hProp_Bool (lem : LEM) (hprop : hProp) : Bool
  := match (lem hprop _) with inl _ =&gt; true | inr _ =&gt; false end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 597
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma Book_3_9_solution_1 `{Univalence} : LEM -&gt; hProp &lt;~&gt; Bool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 599
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 600
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro lem.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 601
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (equiv_adjointify (LEM_hProp_Bool lem) is_true).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 602
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 603
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold Sect.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 603
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros []; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 603
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 604
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold LEM_hProp_Bool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 604
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim (lem Unit_hp _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 604
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 605
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun _ =&gt; 1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 605
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 606
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro nUnit.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 606
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim (nUnit tt).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 606
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 607
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold LEM_hProp_Bool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 607
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim (lem False_hp _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 607
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 608
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro fals.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 608
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim fals.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 608
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 609
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun _ =&gt; 1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 609
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 610
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold Sect.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 610
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro hprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 610
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold LEM_hProp_Bool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 611
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    elim (lem hprop _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 612
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 613
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 613
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_hprop; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 614
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* path_prop is silent *)
     </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 615
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>exact ((if_hprop_then_equiv_Unit hprop p)^-1)%equiv.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 615
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 616
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro np.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 616
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_hprop; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 617
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* path_prop is silent *)
     </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 618
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>exact ((if_not_hprop_then_equiv_Empty hprop np)^-1)%equiv.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 618
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 619
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:lem-impred *)
(** Exercise 3.10 *)



(* ================================================== ex:not-brck-A-impl-A *)
(** Exercise 3.11 *)

(** This theorem extracts the main idea leading to the contradiction constructed
    in the proof of Theorem 3.2.2, that univalence implies that all functions are
    natural with respect to equivalences.

    The terms are complicated, but it pretty much follows the proof in the book,
    step by step.
 *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 635
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma univalence_func_natural_equiv `{Univalence}
  : forall (C : Type -&gt; Type) (all_contr : forall A, Contr (C A -&gt; C A))
      (g : forall A, C A -&gt; A) {A : Type}  (e : A &lt;~&gt; A),
    e o (g A) = (g A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 638
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros C all_contr g A e.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 640
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 641
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  intros x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 643
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (p := path_universe_uncurried e).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 644
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (* The propositional computation rule for univalence of section 2.10 *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 647
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>refine (concat (happly (transport_idmap_path_universe_uncurried e)^ (g A x)) _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 647
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** To obtain the situation of 2.9.4, we rewrite x using

      &lt;&lt;&lt;
        x = transport (fun A : Type =&gt; C A) p^ x
      &gt;&gt;&gt;

      This equality holds because [(C A) -&gt; (C A)] is contractible, so

      &lt;&lt;&lt;
        transport (fun A : Type =&gt; C A) p^ = idmap
      &gt;&gt;&gt;

      In both Theorem 3.2.2 and the following result, the hypothesis
      [Contr ((C A) -&gt; (C A))] will follow from the contractibility of [(C A)].
   *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 664
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>refine (concat (ap _ (ap _ (happly (@path_contr _ (all_contr A)
                                                  idmap (transport _ p^)) x))) _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 665
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (* Equation 2.9.4 is called transport_arrow in the library. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 668
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>refine (concat (@transport_arrow _ (fun A =&gt; C A) idmap _ _ p (g A) x)^ _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 668
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  exact (happly (apD g p) x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 670
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 671
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** For this proof, we closely follow the proof of Theorem 3.2.2
    from the text, replacing ¬¬A → A by ∥A∥ → A. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 674
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_11 `{Univalence} : ~ (forall A, Trunc (-1) A -&gt; A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 674
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* The proof is by contradiction. We'll assume we have such a
     function, and obtain an element of 0. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 677
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>intros g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 677
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  assert (end_contr : forall A, Contr (Trunc (-1) A -&gt; Trunc (-1) A)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 679
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 680
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 681
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply Book_3_4_solution_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 682
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply Trunc_is_trunc.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 683
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  }</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 684
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** There are no fixpoints of the fix-point free autoequivalence of 2 (called
      negb). We will derive a contradiction by showing there must be such a fixpoint
      by naturality of g.

      We parametrize over b to emphasize that this proof depends only on the fact
      that Bool is inhabited, not on any specific value (we use "true" below).
   *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 693
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>pose
    (contr b :=
        (not_fixed_negb (g Bool b))
        (happly (univalence_func_natural_equiv _ end_contr g equiv_negb) b)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 696
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  contradiction (contr (tr true)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 698
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 699
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:lem-impl-simple-ac *)
(** Exercise 3.12 *)



(* ================================================== ex:naive-lem-impl-ac *)
(** Exercise 3.13 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 708
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_3_13.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 708
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition naive_LEM_impl_DN_elim (A : Type) (LEM : A + ~A)
  : ~~A -&gt; A
    := fun nna =&gt; match LEM with
                    | inl a =&gt; a
                    | inr na =&gt; match nna na with end
                  end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 714
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>

  Lemma naive_LEM_implies_AC
  : (forall A : Type, A + ~A)
    -&gt; forall X A P,
         (forall x : X, ~~{ a : A x | P x a })
         -&gt; { g : forall x, A x | forall x, P x (g x) }.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 720
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 721
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros LEM X A P H.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 722
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (fun x =&gt; @naive_LEM_impl_DN_elim _ (LEM _) (H x)) as H'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 723
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists (fun x =&gt; (H' x).1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 724
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (fun x =&gt; (H' x).2).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 725
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 726
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>

  Lemma Book_3_13 `{Funext}
  : (forall A : Type, A + ~A)
    -&gt; forall X A P,
         IsHSet X
         -&gt; (forall x : X, IsHSet (A x))
         -&gt; (forall x (a : A x), IsHProp (P x a))
         -&gt; (forall x, merely { a : A x &amp; P x a })
         -&gt; merely { g : forall x, A x &amp; forall x, P x (g x) }.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 735
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 736
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros LEM X A P HX HA HP H0.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 737
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 738
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (naive_LEM_implies_AC LEM).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 739
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 740
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    specialize (H0 x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 741
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    revert H0.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 742
Time: 0.012s">
<div class="time" style="width: 0.74165636588381%"></div>
<pre>
    apply Trunc_rec.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 743
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (fun x nx =&gt; nx x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 744
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 745
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_3_13.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 746
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:lem-brck *)
(** Exercise 3.14 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 750
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_3_14.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 750
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{Funext}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 751
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Hypothesis LEM : forall A : Type, IsHProp A -&gt; A + ~A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 752
Time: 0.012s">
<div class="time" style="width: 0.74165636588381%"></div>
<pre>

  Definition Book_3_14
  : forall A (P : ~~A -&gt; Type),
    (forall a, P (fun na =&gt; na a))
    -&gt; (forall x y (z : P x) (w : P y), transport P (path_ishprop x y) z = w)
    -&gt; forall x, P x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 758
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 759
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A P base p nna.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 760
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assert (forall x, IsHProp (P x)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 761
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 762
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 762
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply hprop_allpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 763
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x' y'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 764
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>
      etransitivity; [ symmetry; apply (p x x y' x') | ].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 765
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
     (* Without this it somehow proves [H'] using the wrong universe for hprop_Empty and fails when we do [Defined].
        See Coq #4862. *)
     </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 768
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>set (path := path_ishprop x x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 768
Time: 0.054s">
<div class="time" style="width: 3.3374536464771%"></div>
<pre>
      assert (H' : idpath = path) by apply path_ishprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 769
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      destruct H'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 770
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 771
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 772
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre> destruct (LEM (P nna) _) as [pnna|npnna]; trivial.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 772
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (match _ : Empty with end).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 773
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply nna.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 774
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 775
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply npnna.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 776
Time: 0.011s">
<div class="time" style="width: 0.67985166872682%"></div>
<pre>
      exact (transport P (path_ishprop _ _) (base a)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 777
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 778
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma Book_3_14_equiv A : merely A &lt;~&gt; ~~A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 780
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 781
Time: 0.011s">
<div class="time" style="width: 0.67985166872682%"></div>
<pre>
    apply equiv_iff_hprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 782
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 783
Time: 0.01s">
<div class="time" style="width: 0.61804697156984%"></div>
<pre> apply Trunc_rec.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 783
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (fun a na =&gt; na a).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 784
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 785
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro nna.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 785
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (@Book_3_14 A (fun _ =&gt; merely A)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 786
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 787
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 787
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 788
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y z w.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 788
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
        apply path_ishprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 789
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 790
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact nna.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 790
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 791
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
End Book_3_14.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 792
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:impred-brck *)
(** Exercise 3.15 *)



(* ================================================== ex:lem-impl-dn-commutes *)
(** Exercise 3.16 *)



(* ================================================== ex:prop-trunc-ind *)
(** Exercise 3.17 *)



(* ================================================== ex:lem-ldn *)
(** Exercise 3.18 *)



(* ================================================== ex:decidable-choice *)
(** Exercise 3.19 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 816
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_19 := @HoTT.BoundedSearch.minimal_n.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 816
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:omit-contr2 *)
(** Exercise 3.20 *)



(* ================================================== ex:isprop-equiv-equiv-bracket *)
(** Exercise 3.21 *)



(* ================================================== ex:finite-choice *)
(** Exercise 3.22 *)



(* ================================================== ex:decidable-choice-strong *)
(** Exercise 3.23 *)



(* ================================================== ex:two-sided-adjoint-equivalences *)
(** Exercise 4.1 *)



(* ================================================== ex:symmetric-equiv *)
(** Exercise 4.2 *)



(* ================================================== ex:qinv-autohtpy-no-univalence *)
(** Exercise 4.3 *)



(* ================================================== ex:unstable-octahedron *)
(** Exercise 4.4 *)



(* ================================================== ex:2-out-of-6 *)
(** Exercise 4.5 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 860
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_4_5.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 860
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Section parts.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 861
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Variables A B C D : Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 862
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Variable f : A -&gt; B.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 863
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Variable g : B -&gt; C.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 864
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Variable h : C -&gt; D.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 865
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    Context `{IsEquiv _ _ (g o f), IsEquiv _ _ (h o g)}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 866
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Local Instance Book_4_5_g : IsEquiv g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 868
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 869
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply isequiv_biinv.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 870
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      split.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 871
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 872
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre> exists ((h o g)^-1 o h);
        repeat intro; simpl;
        try apply (@eissect _ _ (h o g)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 874
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 875
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre> exists (f o (g o f)^-1);
        repeat intro; simpl;
        try apply (@eisretr _ _ (g o f)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 877
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 878
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Local Instance Book_4_5_f : IsEquiv f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 880
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 881
Time: 0.134s">
<div class="time" style="width: 8.2818294190358%"></div>
<pre>
      apply (isequiv_homotopic (g^-1 o (g o f))); try exact _.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 882
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro; apply (eissect g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 883
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 884
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Local Instance Book_4_5_h : IsEquiv h.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 886
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 887
Time: 0.053s">
<div class="time" style="width: 3.2756489493201%"></div>
<pre>
      apply (isequiv_homotopic ((h o g) o g^-1)); try exact _.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 888
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro; apply (ap h); apply (eisretr g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 889
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 890
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition Book_4_5_hgf : IsEquiv (h o g o f).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 892
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 893
Time: 0.013s">
<div class="time" style="width: 0.80346106304079%"></div>
<pre>
      typeclasses eauto.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 894
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 895
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  End parts.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 896
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (*Lemma Book_4_5 A B f `{IsEquiv A B f} (a a' : A) : IsEquiv (@ap _ _ f a a').
  Proof.
    pose (@ap _ _ (f^-1) (f a) (f a')) as f'.
    pose (fun p : f^-1 (f a) = _ =&gt; p @ (@eissect _ _ f _ a')) as g'.
    pose (fun p : _ = a' =&gt; (@eissect _ _ f _ a)^ @ p) as h'.
    pose (g' o f').
    pose (h' o g').
    admit.
  Qed.*)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 906
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>End Book_4_5.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 906
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:qinv-univalence *)
(** Exercise 4.6 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 910
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_4_6_i.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 910
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition is_qinv {A B : Type} (f : A -&gt; B) 
    := { g : B -&gt; A &amp; (Sect g f * Sect f g)%type }.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 913
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition qinv (A B : Type)
    := { f : A -&gt; B &amp; is_qinv f }.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 915
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  Definition qinv_id A : qinv A A
    := (fun x =&gt; x; (fun x =&gt; x ; (fun x =&gt; 1, fun x =&gt; 1))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 917
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition qinv_path A B : (A = B) -&gt; qinv A B
    := fun p =&gt; match p with 1 =&gt; qinv_id _ end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 919
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition QInv_Univalence_type := forall (A B : Type@{i}),
      is_qinv (qinv_path A B).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 921
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition isequiv_qinv {A B} {f : A -&gt; B} 
    : is_qinv f -&gt; IsEquiv f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 923
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 924
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [g [s r]].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 925
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (isequiv_adjointify f g s r).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 926
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 927
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  Definition equiv_qinv_path (qua: QInv_Univalence_type) (A B : Type)
    : (A = B) &lt;~&gt; qinv A B
    := Build_Equiv _ _ (qinv_path A B) (isequiv_qinv (qua A B)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 930
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>

  Definition qinv_isequiv {A B} (f : A -&gt; B) `{IsEquiv _ _ f}
    : qinv A B
    := (f ; (f^-1 ; (eisretr f , eissect f))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 934
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context `{qua : QInv_Univalence_type}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 936
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem qinv_univalence_isequiv_postcompose {A B : Type} {w : A -&gt; B}
          `{H0 : IsEquiv A B w} C : IsEquiv (fun (g:C-&gt;A) =&gt; w o g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 939
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 940
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold QInv_Univalence_type in *.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 941
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (w' := qinv_isequiv w).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 942
Time: 0.008s">
<div class="time" style="width: 0.49443757725587%"></div>
<pre>
    refine (isequiv_adjointify
              (fun (g:C-&gt;A) =&gt; w o g)
              (fun (g:C-&gt;B) =&gt; w^-1 o g)
              _
              _);
    intros g;
    first [ change ((fun x =&gt; w'.1 ( w'.2.1 (g x))) = g)
          | change ((fun x =&gt; w'.2.1 ( w'.1 (g x))) = g) ];
    clearbody w'; clear H0 w;
    rewrite &lt;- (@eisretr _ _ (@qinv_path A B) (isequiv_qinv (qua A B)) w');
    generalize ((@equiv_inv _ _ (qinv_path A B) (isequiv_qinv (qua A B))) w');
    intro p; clear w'; destruct p; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 954
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 955
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Now the rest is basically copied from UnivalenceImpliesFunext, with name changes so as to use the current assumption of qinv-univalence rather than a global assumption of ordinary univalence. *)

 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 959
Time: 0.003s">
<div class="time" style="width: 0.18541409147095%"></div>
<pre>Local Instance isequiv_src_compose A B
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (fun g =&gt; (fst o pr1) o g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 962
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 963
Time: 0.089s">
<div class="time" style="width: 5.5006180469716%"></div>
<pre>
    rapply @qinv_univalence_isequiv_postcompose.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 964
Time: 0.006s">
<div class="time" style="width: 0.3708281829419%"></div>
<pre>
    refine (isequiv_adjointify
              (fst o pr1) (fun x =&gt; ((x, x); idpath))
              (fun _ =&gt; idpath)
              _);
      let p := fresh in
      intros [[? ?] p];
        simpl in p; destruct p;
        reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 972
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 973
Time: 0.003s">
<div class="time" style="width: 0.18541409147095%"></div>
<pre>

  Local Instance isequiv_tgt_compose A B
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (fun g =&gt; (snd o pr1) o g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 978
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 979
Time: 0.086s">
<div class="time" style="width: 5.3152039555006%"></div>
<pre>
    rapply @qinv_univalence_isequiv_postcompose.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 980
Time: 0.006s">
<div class="time" style="width: 0.3708281829419%"></div>
<pre>
    refine (isequiv_adjointify
              (snd o pr1) (fun x =&gt; ((x, x); idpath))
              (fun _ =&gt; idpath)
              _);
      let p := fresh in
      intros [[? ?] p];
        simpl in p; destruct p;
        reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 988
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 989
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem QInv_Univalence_implies_FunextNondep (A B : Type)
  : forall f g : A -&gt; B, f == g -&gt; f = g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 992
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 993
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros f g p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 994
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (d := fun x : A =&gt; existT (fun xy =&gt; fst xy = snd xy) (f x, f x) (idpath (f x))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 995
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (e := fun x : A =&gt; existT (fun xy =&gt; fst xy = snd xy) (f x, g x) (p x)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 996
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    change f with ((snd o pr1) o d).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 997
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    change g with ((snd o pr1) o e).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 998
Time: 0.009s">
<div class="time" style="width: 0.55624227441286%"></div>
<pre>
    erapply (ap (fun g =&gt; snd o pr1 o g)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 999
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>
    pose (fun A B x y=&gt; @equiv_inv _ _ _ (@isequiv_ap _ _ _ (@isequiv_src_compose A B) x y)) as H'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1000
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply H'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1001
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1002
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1003
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition QInv_Univalence_implies_Funext_type : Funext_type
    := NaiveNondepFunext_implies_Funext QInv_Univalence_implies_FunextNondep.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1006
Time: 0.004s">
<div class="time" style="width: 0.24721878862794%"></div>
<pre>

End Book_4_6_i.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1008
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section EquivFunctorFunextType.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1010
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* We need a version of [equiv_functor_forall_id] that takes a [Funext_type] rather than a global axiom [Funext].  *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1012
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Context (fa : Funext_type).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1012
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition ft_path_forall {A : Type} {P : A -&gt; Type} (f g : forall x : A, P x) :
  f == g -&gt; f = g
  :=
  @equiv_inv _ _ (@apD10 A P f g) (fa _ _ _ _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1017
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Instance ft_isequiv_functor_forall 
        {A B:Type} `{P : A -&gt; Type} `{Q : B -&gt; Type}
          {f : B -&gt; A} {g : forall b:B, P (f b) -&gt; Q b}
        `{IsEquiv B A f} `{forall b, @IsEquiv (P (f b)) (Q b) (g b)}
    : IsEquiv (functor_forall f g) | 1000.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1023
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1024
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>
    simple refine (isequiv_adjointify
                     (functor_forall f g)
                     (functor_forall
                        (f^-1)
                        (fun (x:A) (y:Q (f^-1 x)) =&gt; eisretr f x # (g (f^-1 x))^-1 y
                     )) _ _);
      intros h.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1031
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1032
Time: 0.011s">
<div class="time" style="width: 0.67985166872682%"></div>
<pre> abstract (
          apply ft_path_forall; intros b; unfold functor_forall;
          rewrite eisadj;
          rewrite &lt;- transport_compose;
          rewrite ap_transport;
          rewrite eisretr;
          apply apD
        ).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1039
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1040
Time: 0.004s">
<div class="time" style="width: 0.24721878862794%"></div>
<pre> abstract (
          apply ft_path_forall; intros a; unfold functor_forall;
          rewrite eissect;
          apply apD
        ).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1044
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1045
Time: 0.01s">
<div class="time" style="width: 0.61804697156984%"></div>
<pre>

  Definition ft_equiv_functor_forall
        {A B:Type} `{P : A -&gt; Type} `{Q : B -&gt; Type}
        (f : B -&gt; A) `{IsEquiv B A f}
        (g : forall b:B, P (f b) -&gt; Q b)
        `{forall b, @IsEquiv (P (f b)) (Q b) (g b)}
  : (forall a, P a) &lt;~&gt; (forall b, Q b)
    := Build_Equiv _ _ (functor_forall f g) _.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1053
Time: 0.009s">
<div class="time" style="width: 0.55624227441286%"></div>
<pre>

  Definition ft_equiv_functor_forall_id 
        {A:Type} `{P : A -&gt; Type} `{Q : A -&gt; Type}
        (g : forall a, P a &lt;~&gt; Q a)
  : (forall a, P a) &lt;~&gt; (forall a, Q a)
    := ft_equiv_functor_forall (equiv_idmap A) g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1059
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>

End EquivFunctorFunextType.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1061
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Using the Kraus-Sattler space of loops rather than the version in the book, since it is simpler and avoids use of propositional truncation. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1063
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_4_6_ii
           (qua1 qua2 : QInv_Univalence_type)
  : ~ IsHProp (forall A : { X : Type &amp; X = X }, A = A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1065
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1066
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (fa := @QInv_Univalence_implies_Funext_type qua2).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1067
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros H.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1068
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (K := forall (X:Type) (p:X=X), { q : X=X &amp; p @ q = q @ p }).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1069
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (e : K &lt;~&gt; forall A : { X : Type &amp; X = X }, A = A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1070
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1071
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold K.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1071
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (equiv_sigT_ind _ oE _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1072
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ft_equiv_functor_forall_id fa _); intros X.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1073
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ft_equiv_functor_forall_id fa _); intros p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1074
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (equiv_path_sigma _ _ _ oE _); cbn.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1075
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (equiv_functor_sigma_id _); intros q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1076
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine ((equiv_concat_l (transport_paths_lr q p)^ p)^-1 oE _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1077
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    refine ((equiv_concat_l (concat_p_pp _ _ _) _)^-1 oE _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1078
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply equiv_moveR_Vp.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1079
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1079
Time: 0.007s">
<div class="time" style="width: 0.43263288009889%"></div>
<pre>
  assert (HK := trunc_equiv _ e^-1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1080
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (u : forall (X:Type) (p:X=X), p @ 1 = 1 @ p).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1081
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1082
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre> intros X p; rewrite concat_p1, concat_1p; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1082
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1082
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (alpha := (fun X p =&gt; (idpath X ; u X p)) : K).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1083
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (beta := (fun X p =&gt; (p ; 1)) : K).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1084
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (isequiv_qinv (qua1 Bool Bool)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1085
Time: 0.005s">
<div class="time" style="width: 0.30902348578492%"></div>
<pre>
  assert (r := pr1_path (apD10 (apD10 (path_ishprop alpha beta) Bool)
                     ((qinv_path Bool Bool)^-1 (qinv_isequiv equiv_negb)))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1087
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold alpha, beta in r; clear alpha beta.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1088
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (ap (qinv_path Bool Bool)) in r.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1089
Time: 0.026s">
<div class="time" style="width: 1.6069221260816%"></div>
<pre>
  rewrite eisretr in r.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1090
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply pr1_path in r; cbn in r.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1091
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (true_ne_false (ap10 r true)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1092
Time: 0.008s">
<div class="time" style="width: 0.49443757725587%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1093
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>

Definition allqinv_coherent (qua : QInv_Univalence_type)
           (A B : Type) (f : qinv A B)
  : (fun x =&gt; ap f.2.1 (fst f.2.2 x)) = (fun x =&gt; snd f.2.2 (f.2.1 x)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1097
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1098
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1099
Time: 0.007s">
<div class="time" style="width: 0.43263288009889%"></div>
<pre> 
  equiv_intro (equiv_qinv_path qua A B) p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1100
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  destruct p; cbn; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1101
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_4_6_iii (qua1 qua2 : QInv_Univalence_type) : Empty.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (Book_4_6_ii qua1 qua2).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1106
Time: 0.003s">
<div class="time" style="width: 0.18541409147095%"></div>
<pre>
  refine (trunc_succ).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exists (fun A =&gt; 1); intros u.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (B := {X : Type &amp; X = X}) in *.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1109
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  exact (allqinv_coherent qua2 B B (idmap ; (idmap ; (fun A:B =&gt; 1 , u)))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(* ================================================== ex:embedding-cancellable *)
(** Exercise 4.7 *)



(* ================================================== ex:cancellable-from-bool *)
(** Exercise 4.8 *)



(* ================================================== ex:ind-lst *)
(** Exercise 5.1 *)



(* ================================================== ex:same-recurrence-not-defeq *)
(** Exercise 5.2 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_5_2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Here is one example of functions which are propositionally equal but not judgmentally equal.  They satisfy the same reucrrence propositionally. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Let ez : Bool := true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let es : nat -&gt; Bool -&gt; Bool := fun _ =&gt; idmap.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1134
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2_i : nat -&gt; Bool := nat_ind (fun _ =&gt; Bool) ez es.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2_ii : nat -&gt; Bool := fun _ =&gt; true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Fail Definition Book_5_2_not_defn_eq : Book_5_2_i = Book_5_2_ii := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Lemma Book_5_2_i_prop_eq : forall n, Book_5_2_i n = Book_5_2_ii n.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction n; simpl; trivial.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_5_2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section Book_5_2'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Here's another example where two functions are not (currently) definitionally equal, but satisfy the same reucrrence judgmentally.  This example is a bit less robust; it fails in CoqMT. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Let ez : nat := 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let es : nat -&gt; nat -&gt; nat := fun _ =&gt; S.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_i : nat -&gt; nat := fun n =&gt; n + 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_ii : nat -&gt; nat := fun n =&gt; 1 + n.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Fail Definition Book_5_2'_not_defn_eq : Book_5_2'_i = Book_5_2'_ii := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_i_eq_ez : Book_5_2'_i 0 = ez := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_ii_eq_ez : Book_5_2'_ii 0 = ez := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_i_eq_es n : Book_5_2'_i (S n) = es n (Book_5_2'_i n) := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_ii_eq_es n : Book_5_2'_ii (S n) = es n (Book_5_2'_ii n) := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_5_2'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:one-function-two-recurrences *)
(** Exercise 5.3 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_5_3.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let ez : Bool := true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let es : nat -&gt; Bool -&gt; Bool := fun _ =&gt; idmap.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let ez' : Bool := true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let es' : nat -&gt; Bool -&gt; Bool := fun _ _ =&gt; true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3 : nat -&gt; Bool := fun _ =&gt; true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3_satisfies_ez : Book_5_3 0 = ez := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3_satisfies_ez' : Book_5_3 0 = ez' := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3_satisfies_es n : Book_5_3 (S n) = es n (Book_5_3 n) := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3_satisfies_es' n : Book_5_3 (S n) = es' n (Book_5_3 n) := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3_es_ne_es' : ~(es = es')
    := fun H =&gt; false_ne_true (ap10 (ap10 H 0) false).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_5_3.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:bool *)
(** Exercise 5.4 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1175
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_5_4 := @HoTT.Types.Bool.equiv_bool_forall_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1175
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:ind-nat-not-equiv *)
(** Exercise 5.5 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_5_5.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let ind_nat (P : nat -&gt; Type) := fun x =&gt; @nat_ind P (fst x) (snd x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma Book_5_5 `{fs : Funext} : ~forall P : nat -&gt; Type,
                                     IsEquiv (@ind_nat P).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro H.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    specialize (H (fun _ =&gt; Bool)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1186
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose proof (eissect (@ind_nat (fun _ =&gt; Bool)) (true, (fun _ _ =&gt; true))) as H1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose proof (eissect (@ind_nat (fun _ =&gt; Bool)) (true, (fun _ =&gt; idmap))) as H2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    cut (ind_nat (fun _ : nat =&gt; Bool) (true, fun (_ : nat) (_ : Bool) =&gt; true)
         = (ind_nat (fun _ : nat =&gt; Bool) (true, fun _ : nat =&gt; idmap))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro H'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply true_ne_false.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1192
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
      exact (ap10 (apD10 (ap snd (H1^ @ ap _ H' @ H2)) 0) false).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro n; induction n; trivial.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold ind_nat in *; simpl in *.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite &lt;- IHn.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      destruct n; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1198
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1199
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>
End Book_5_5.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:no-dep-uniqueness-failure *)
(** Exercise 5.6 *)



(* ================================================== ex:loop *)
(** Exercise 5.7 *)



(* ================================================== ex:loop2 *)
(** Exercise 5.8 *)



(* ================================================== ex:inductive-lawvere *)
(** Exercise 5.9 *)



(* ================================================== ex:ilunit *)
(** Exercise 5.10 *)



(* ================================================== ex:empty-inductive-type *)
(** Exercise 5.11 *)



(* ================================================== ex:Wprop *)
(** Exercise 5.12 *)



(* ================================================== ex:Wbounds *)
(** Exercise 5.13 *)



(* ================================================== ex:Wdec *)
(** Exercise 5.14 *)



(* ================================================== ex:Wbounds-loose *)
(** Exercise 5.15 *)



(* ================================================== ex:Wimpred *)
(** Exercise 5.16 *)



(* ================================================== ex:no-nullary-constructor *)
(** Exercise 5.17 *)



(* ================================================== ex:torus *)
(** Exercise 6.1 *)



(* ================================================== ex:suspS1 *)
(** Exercise 6.2 *)



(* ================================================== ex:torus-s1-times-s1 *)
(** Exercise 6.3 *)



(* ================================================== ex:nspheres *)
(** Exercise 6.4 *)



(* ================================================== ex:susp-spheres-equiv *)
(** Exercise 6.5 *)



(* ================================================== ex:spheres-make-U-not-2-type *)
(** Exercise 6.6 *)



(* ================================================== ex:monoid-eq-prop *)
(** Exercise 6.7 *)



(* ================================================== ex:free-monoid *)
(** Exercise 6.8 *)



(* ================================================== ex:unnatural-endomorphisms *)
(** Exercise 6.9 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_6_9.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Hypothesis LEM : forall A, IsHProp A -&gt; A + ~A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_6_9 {ua : Univalence} : forall X, X -&gt; X.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1307
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1308
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro X.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1309
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    pose proof (@LEM (Contr { f : X &lt;~&gt; X &amp; ~(forall x, f x = x) }) _) as contrXEquiv.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1310
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    destruct contrXEquiv as [[f H]|H].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (** In the case where we have exactly one autoequivalence which is not the identity, use it. *)
     </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>exact (f.1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (** In the other case, just use the identity. *)
     </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>exact idmap.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma bool_map_equiv_not_idmap (f : { f : Bool &lt;~&gt; Bool &amp; ~(forall x, f x = x) })
  : forall b, ~(f.1 b = b).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1319
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro H''.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1322
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply f.2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1323
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro b'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1324
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>
    pose proof (eval_bool_isequiv f.1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1325
Time: 0.013s">
<div class="time" style="width: 0.80346106304079%"></div>
<pre>
    destruct b', b, (f.1 true), (f.1 false);
      simpl in *;
      match goal with
        | _ =&gt; assumption
        | _ =&gt; reflexivity
        | [ H : true = false |- _ ] =&gt; exact (match true_ne_false H with end)
        | [ H : false = true |- _ ] =&gt; exact (match false_ne_true H with end)
      end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1333
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma Book_6_9_not_id {ua : Univalence} `{fs : Funext} : Book_6_9 Bool = negb.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_forall; intro b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold Book_6_9.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1339
Time: 0.004s">
<div class="time" style="width: 0.24721878862794%"></div>
<pre>
    destruct (@LEM (Contr { f : Bool &lt;~&gt; Bool &amp; ~(forall x, f x = x) }) _) as [[f H']|H'].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> pose proof (bool_map_equiv_not_idmap f b).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1341
Time: 0.004s">
<div class="time" style="width: 0.24721878862794%"></div>
<pre>
      destruct (f.1 b), b;
      match goal with
        | _ =&gt; assumption
        | _ =&gt; reflexivity
        | [ H : ~(_ = _) |- _ ] =&gt; exact (match H idpath with end)
        | [ H : true = false |- _ ] =&gt; exact (match true_ne_false H with end)
        | [ H : false = true |- _ ] =&gt; exact (match false_ne_true H with end)
      end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1349
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1350
Time: 0.034s">
<div class="time" style="width: 2.1013597033375%"></div>
<pre> refine (match H' _ with end).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1350
Time: 0.004s">
<div class="time" style="width: 0.24721878862794%"></div>
<pre>
      eexists (existT (fun f : Bool &lt;~&gt; Bool =&gt;
                         ~(forall x, f x = x))
                      (Build_Equiv _ _ negb _)
                      (fun H =&gt; false_ne_true (H true)));
        simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1355
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1356
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_sigma_uncurried; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1357
Time: 0.013s">
<div class="time" style="width: 0.80346106304079%"></div>
<pre>
      refine ((fun H'' =&gt;
                 (equiv_path_equiv _ _ H'';
                  path_ishprop _ _))
                _);
        simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1362
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_forall; intro b'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1363
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose proof (bool_map_equiv_not_idmap f b').</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1364
Time: 0.004s">
<div class="time" style="width: 0.24721878862794%"></div>
<pre>
      destruct (f.1 b'), b';
      match goal with
        | _ =&gt; assumption
        | _ =&gt; reflexivity
        | [ H : ~(_ = _) |- _ ] =&gt; exact (match H idpath with end)
        | [ H : true = false |- _ ] =&gt; exact (match true_ne_false H with end)
        | [ H : false = true |- _ ] =&gt; exact (match false_ne_true H with end)
      end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1372
Time: 0.004s">
<div class="time" style="width: 0.24721878862794%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1373
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Simpler solution not using univalence **)

 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1377
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition AllExistsOther(X : Type) := forall x:X, { y:X | y &lt;&gt; x }.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1377
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition centerAllExOthBool : AllExistsOther Bool := 
    fun (b:Bool) =&gt; (negb b ; not_fixed_negb b).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma centralAllExOthBool `{Funext} (f: AllExistsOther Bool) : centerAllExOthBool = f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1382
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1383
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1383
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1383
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> pose proof (inverse (negb_ne (f b).2)) as fst.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1383
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold centerAllExOthBool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1384
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (@path_sigma _ _ (negb b; not_fixed_negb b) (f b) fst); simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1385
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply equiv_hprop_allpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1386
Time: 0.005s">
<div class="time" style="width: 0.30902348578492%"></div>
<pre> apply trunc_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1386
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1387
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition contrAllExOthBool `{Funext} : Contr (AllExistsOther Bool) :=
  (Build_Contr _ centerAllExOthBool centralAllExOthBool).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1390
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition solution_6_9 `{Funext} : forall X, X -&gt; X.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1392
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro X.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1394
Time: 0.001s">
<div class="time" style="width: 0.061804697156984%"></div>
<pre>
    elim (@LEM (Contr (AllExistsOther X)) _); intro.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1395
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1396
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun x:X =&gt; (center (AllExistsOther X) x).1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1396
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1397
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun x:X =&gt; x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1397
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1398
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma not_id_on_Bool `{Funext} : solution_6_9 Bool &lt;&gt; idmap.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1401
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro Bad.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> pose proof ((happly Bad) true) as Ugly.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assert ((solution_6_9 Bool true) = false) as Good.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1403
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1404
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold solution_6_9.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1404
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>
      destruct (LEM (Contr (AllExistsOther Bool)) _) as [[f C]|C];simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1405
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1406
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim (centralAllExOthBool f).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1406
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1406
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1407
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim (C contrAllExOthBool).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1407
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply false_ne_true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite (inverse Good).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assumption.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1409
Time: 0.002s">
<div class="time" style="width: 0.12360939431397%"></div>
<pre>

End Book_6_9.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1411
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:funext-from-interval *)
(** Exercise 6.10 *)



(* ================================================== ex:susp-lump *)
(** Exercise 6.11 *)



(* ================================================== ex:alt-integers *)
(** Exercise 6.12 *)



(* ================================================== ex:trunc-bool-interval *)
(** Exercise 6.13 *)



(* ================================================== ex:all-types-sets *)
(** Exercise 7.1 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1435
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_7_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1435
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Lemma Book_7_1_part_i (H : forall A, merely A -&gt; A) A : IsHSet A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1436
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1437
Time: 0.007s">
<div class="time" style="width: 0.43263288009889%"></div>
<pre>
    apply (@HoTT.HSet.ishset_hrel_subpaths
             A (fun x y =&gt; merely (x = y)));
    try typeclasses eauto.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros ?.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1442
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1443
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1444
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1444
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply H.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1445
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      assumption.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1446
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1447
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma Book_7_1_part_ii (H : forall A B (f : A -&gt; B),
                                (forall b, merely (hfiber f b))
                                -&gt; forall b, hfiber f b)
  : forall A, IsHSet A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1452
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply Book_7_1_part_i.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1454
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1455
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (fun H' =&gt; (@H A (merely A) tr H' a).1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1456
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    clear a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1457
Time: 0.003s">
<div class="time" style="width: 0.18541409147095%"></div>
<pre>
    apply Trunc_ind; try exact _.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1458
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro x; compute; apply tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1459
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists x; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1460
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1461
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_7_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1462
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:s2-colim-unit *)
(** Exercise 7.2 *)



(* ================================================== ex:ntypes-closed-under-wtypes *)
(** Exercise 7.3 *)



(* ================================================== ex:connected-pointed-all-section-retraction *)
(** Exercise 7.4 *)



(* ================================================== ex:ntype-from-nconn-const *)
(** Exercise 7.5 *)



(* ================================================== ex:connectivity-inductively *)
(** Exercise 7.6 *)



(* ================================================== ex:lemnm *)
(** Exercise 7.7 *)



(* ================================================== ex:acnm *)
(** Exercise 7.8 *)



(* ================================================== ex:acnm-surjset *)
(** Exercise 7.9 *)



(* ================================================== ex:acconn *)
(** Exercise 7.10 *)



(* ================================================== ex:n-truncation-not-left-exact *)
(** Exercise 7.11 *)



(* ================================================== ex:double-negation-modality *)
(** Exercise 7.12 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1516
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_7_12 := HoTT.Modalities.Notnot.Notnot.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1516
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:prop-modalities *)
(** Exercise 7.13 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1520
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_7_13_part_i := @HoTT.Modalities.Open.Op.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1520
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Definition Book_7_13_part_ii := @HoTT.Modalities.Closed.Cl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1522
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:f-local-type *)
(** Exercise 7.14 *)



(* ================================================== ex:trunc-spokes-no-hub *)
(** Exercise 7.15 *)



(* ================================================== ex:s2-colim-unit-2 *)
(** Exercise 7.16 *)



(* ================================================== ex:homotopy-groups-resp-prod *)
(** Exercise 8.1 *)



(* ================================================== ex:decidable-equality-susp *)
(** Exercise 8.2 *)



(* ================================================== ex:contr-infinity-sphere-colim *)
(** Exercise 8.3 *)



(* ================================================== ex:contr-infinity-sphere-susp *)
(** Exercise 8.4 *)



(* ================================================== ex:unique-fiber *)
(** Exercise 8.5 *)



(* ================================================== ex:ap-path-inversion *)
(** Exercise 8.6 *)



(* ================================================== ex:pointed-equivalences *)
(** Exercise 8.7 *)



(* ================================================== ex:HopfJr *)
(** Exercise 8.8 *)



(* ================================================== ex:SuperHopf *)
(** Exercise 8.9 *)



(* ================================================== ex:vksusppt *)
(** Exercise 8.10 *)



(* ================================================== ex:vksuspnopt *)
(** Exercise 8.11 *)



(* ================================================== ex:slice-precategory *)
(** Exercise 9.1 *)



(* ================================================== ex:set-slice-over-equiv-functor-category *)
(** Exercise 9.2 *)



(* ================================================== ex:functor-equiv-right-adjoint *)
(** Exercise 9.3 *)



(* ================================================== ct:pre2cat *)
(** Exercise 9.4 *)



(* ================================================== ct:2cat *)
(** Exercise 9.5 *)



(* ================================================== ct:groupoids *)
(** Exercise 9.6 *)



(* ================================================== ex:2strict-cat *)
(** Exercise 9.7 *)



(* ================================================== ex:pre2dagger-cat *)
(** Exercise 9.8 *)



(* ================================================== ct:ex:hocat *)
(** Exercise 9.9 *)



(* ================================================== ex:dagger-rezk *)
(** Exercise 9.10 *)



(* ================================================== ex:rezk-vankampen *)
(** Exercise 9.11 *)



(* ================================================== ex:stack *)
(** Exercise 9.12 *)



(* ================================================== ex:utype-ct *)
(** Exercise 10.1 *)



(* ================================================== ex:surjections-have-sections-impl-ac *)
(** Exercise 10.2 *)



(* ================================================== ex:well-pointed *)
(** Exercise 10.3 *)



(* ================================================== ex:add-ordinals *)
(** Exercise 10.4 *)



(* ================================================== ex:multiply-ordinals *)
(** Exercise 10.5 *)



(* ================================================== ex:algebraic-ordinals *)
(** Exercise 10.6 *)



(* ================================================== ex:prop-ord *)
(** Exercise 10.7 *)



(* ================================================== ex:ninf-ord *)
(** Exercise 10.8 *)



(* ================================================== ex:well-founded-extensional-simulation *)
(** Exercise 10.9 *)



(* ================================================== ex:choice-function *)
(** Exercise 10.10 *)



(* ================================================== ex:cumhierhit *)
(** Exercise 10.11 *)



(* ================================================== ex:strong-collection *)
(** Exercise 10.12 *)



(* ================================================== ex:choice-cumulative-hierarchy-choice *)
(** Exercise 10.13 *)



(* ================================================== ex:plump-ordinals *)
(** Exercise 10.14 *)



(* ================================================== ex:not-plump *)
(** Exercise 10.15 *)



(* ================================================== ex:plump-successor *)
(** Exercise 10.16 *)



(* ================================================== ex:ZF-algebras *)
(** Exercise 10.17 *)



(* ================================================== ex:alt-dedekind-reals *)
(** Exercise 11.1 *)



(* ================================================== ex:RD-extended-reals *)
(** Exercise 11.2 *)



(* ================================================== ex:RD-lower-cuts *)
(** Exercise 11.3 *)



(* ================================================== ex:RD-interval-arithmetic *)
(** Exercise 11.4 *)



(* ================================================== ex:RD-lt-vs-le *)
(** Exercise 11.5 *)



(* ================================================== ex:reals-non-constant-into-Z *)
(** Exercise 11.6 *)



(* ================================================== ex:traditional-archimedean *)
(** Exercise 11.7 *)



(* ================================================== RC-Lipschitz-on-interval *)
(** Exercise 11.8 *)



(* ================================================== ex:metric-completion *)
(** Exercise 11.9 *)



(* ================================================== ex:reals-apart-neq-MP *)
(** Exercise 11.10 *)



(* ================================================== ex:reals-apart-zero-divisors *)
(** Exercise 11.11 *)



(* ================================================== ex:finite-cover-lebesgue-number *)
(** Exercise 11.12 *)



(* ================================================== ex:mean-value-theorem *)
(** Exercise 11.13 *)



(* ================================================== ex:knuth-surreal-check *)
(** Exercise 11.14 *)



(* ================================================== ex:reals-into-surreals *)
(** Exercise 11.15 *)



(* ================================================== ex:ord-into-surreals *)
(** Exercise 11.16 *)



(* ================================================== ex:hiit-plump *)
(** Exercise 11.17 *)



(* ================================================== ex:pseudo-ordinals *)
(** Exercise 11.18 *)

</pre>
</div>
</body>
</html>

