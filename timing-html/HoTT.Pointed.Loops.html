<html>
<head>
<title>Loops.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Loops.v</h1>

<div class="code" title="File: Loops.v
Line: 1
Time: 0.02s">
<div class="time" style="width: 1.4858841010401%"></div>
<pre>Require Import Basics.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 1
Time: 0.023s">
<div class="time" style="width: 1.7087667161961%"></div>
<pre>
Require Import Types.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 2
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Require Import HSet.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 3
Time: 0.005s">
<div class="time" style="width: 0.37147102526003%"></div>
<pre>
Require Import Fibrations.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 4
Time: 0.005s">
<div class="time" style="width: 0.37147102526003%"></div>
<pre>
Require Import Factorization.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 5
Time: 0.167s">
<div class="time" style="width: 12.407132243685%"></div>
<pre>
Require Import HIT.Truncations.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 6
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Require Import HIT.Connectedness.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 7
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Require Import Pointed.Core.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Pointed.pMap.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 9
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Require Import Pointed.pEquiv.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Pointed.pHomotopy.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 11
Time: 0.004s">
<div class="time" style="width: 0.29717682020802%"></div>
<pre>

Import TrM.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope pointed_scope.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 16
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Loop spaces *)

(** The type [x = x] is pointed. *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance ispointed_loops A (a : A) : IsPointed (a = a) := 1.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 20
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>

Definition loops (A : pType) : pType
  := Build_pType (point A = point A) _.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Fixpoint iterated_loops (n : nat) (A : pType) : pType
  := match n with
       | O =&gt; A
       | S p =&gt; loops (iterated_loops p A)
     end.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Inner unfolding for iterated loops *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma unfold_iterated_loops (n : nat) (X : pType)
  : iterated_loops n.+1 X = iterated_loops n (loops X).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: reflexivity.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  change (iterated_loops n.+2 X)
    with (loops (iterated_loops n.+1 X)).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  by refine (ap loops IHn @ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 38
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The loop space decreases the truncation level by one.  We don't bother making this an instance because it is automatically found by typeclass search, but we record it here in case anyone is looking for it. *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 41
Time: 0.005s">
<div class="time" style="width: 0.37147102526003%"></div>
<pre>Definition istrunc_loops {n} (A : pType) `{IsTrunc n.+1 A}
  : IsTrunc n (loops A) := _.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Similarly for connectedness. *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 44
Time: 0.249s">
<div class="time" style="width: 18.499257057949%"></div>
<pre>Definition isconnected_loops `{Univalence} {n} (A : pType)
  `{IsConnected n.+1 A} : IsConnected n (loops A) := _.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Functoriality of loop spaces *)

</pre>
</div>
<div class="code" title="File: Loops.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition loops_functor {A B : pType} (f : A -&gt;* B)
: (loops A) -&gt;* (loops B).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 50
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  refine (Build_pMap (loops A) (loops B)
            (fun p =&gt; (point_eq f)^ @ (ap f p @ point_eq f)) _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply moveR_Vp; simpl.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (concat_1p _ @ (concat_p1 _)^).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 54
Time: 0.002s">
<div class="time" style="width: 0.14858841010401%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Fixpoint iterated_loops_functor {A B : pType} (n : nat) 
  : (A -&gt;* B) -&gt; (iterated_loops n A) -&gt;* (iterated_loops n B).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct n.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: exact idmap.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (loops_functor o _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply iterated_loops_functor.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 63
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Loops functor respects composition *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 66
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>Definition loops_functor_compose {A B C : pType} (g : B -&gt;* C) (f : A -&gt;* B)
  : (loops_functor (pmap_compose g f))
  ==* (pmap_compose (loops_functor g) (loops_functor f)).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  serapply Build_pHomotopy.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Loops.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros p.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 71
Time: 0.038s">
<div class="time" style="width: 2.8231797919762%"></div>
<pre>
    pointed_reduce.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ap_compose.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Loops.v
Line: 73
Time: 0.147s">
<div class="time" style="width: 10.921248142645%"></div>
<pre>
  by pointed_reduce.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 74
Time: 0.081s">
<div class="time" style="width: 6.0178306092125%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Iterated loops functor respects composition *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 77
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>Lemma iterated_loops_functor_compose `{Univalence} n A B C (f : B -&gt;* C)
  (g : A -&gt;* B) : iterated_loops_functor n (f o* g)
  ==* (iterated_loops_functor n f) o* (iterated_loops_functor n g).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 80
Time: 0.004s">
<div class="time" style="width: 0.29717682020802%"></div>
<pre>
  induction n; cbn.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: reflexivity.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 82
Time: 0.007s">
<div class="time" style="width: 0.52005943536404%"></div>
<pre>
  destruct (path_pmap IHn)^.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply loops_functor_compose.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 84
Time: 0.003s">
<div class="time" style="width: 0.22288261515602%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Loops functor respects identity *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition loops_functor_idmap (A : pType)
  : loops_functor (@pmap_idmap A) ==* pmap_idmap.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  serapply Build_pHomotopy.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Loops.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro p.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 91
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
    refine (concat_1p _ @ concat_p1 _ @ ap_idmap _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Loops.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 93
Time: 0.002s">
<div class="time" style="width: 0.14858841010401%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Loops functor distributes over concatenation *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 96
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>Lemma loops_functor_pp {X Y : pType} (f : pMap X Y) (x y : loops X)
  : loops_functor f (x @ y) = loops_functor f x @ loops_functor f y.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 98
Time: 0.029s">
<div class="time" style="width: 2.1545319465082%"></div>
<pre>
  pointed_reduce.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply ap_pp.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 100
Time: 0.009s">
<div class="time" style="width: 0.66864784546805%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition loops_2functor {A B : pType} {f g : A -&gt;* B} (p : f ==* g)
  : (loops_functor f) ==* (loops_functor g).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 105
Time: 0.01s">
<div class="time" style="width: 0.74294205052006%"></div>
<pre>
  pointed_reduce.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 106
Time: 0.002s">
<div class="time" style="width: 0.14858841010401%"></div>
<pre>
  serapply Build_pHomotopy; cbn.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Loops.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro q.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 108
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
    refine (_ @ (concat_p1 _)^ @ (concat_1p _)^).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 109
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
    apply moveR_Vp, concat_Ap.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Loops.v
Line: 110
Time: 0.259s">
<div class="time" style="width: 19.24219910847%"></div>
<pre>
  hott_simpl.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 111
Time: 0.02s">
<div class="time" style="width: 1.4858841010401%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The loop space functor decreases the truncation level by one.  *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 114
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>Global Instance istrunc_loops_functor {n} (A B : pType) (f : A -&gt;* B)
  `{IsTruncMap n.+1 _ _ f} : IsTruncMap n (loops_functor f).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro p.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 117
Time: 0.289s">
<div class="time" style="width: 21.47102526003%"></div>
<pre>
  refine (trunc_equiv' _ (equiv_functor_sigma' 1
    (fun q =&gt; equiv_moveR_Vp _ _ _))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 119
Time: 0.012s">
<div class="time" style="width: 0.89153046062407%"></div>
<pre>
  refine (trunc_equiv' _ (equiv_functor_sigma' 1
    (fun q =&gt; equiv_moveR_pM _ _ _))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 121
Time: 0.005s">
<div class="time" style="width: 0.37147102526003%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 122
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** And likewise the connectedness.  *)
(* Note: We give the definition explicitly since it was slow before. *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 125
Time: 0.029s">
<div class="time" style="width: 2.1545319465082%"></div>
<pre>Global Instance isconnected_loops_functor `{Univalence} {n : trunc_index}
  (A B : pType) (f : A -&gt;* B) `{IsConnMap n.+1 _ _ f}
  : IsConnMap n (loops_functor f)
  := fun (p : loops B) =&gt;
    isconnected_equiv' n _
      (equiv_functor_sigma' 1 (fun q =&gt; equiv_moveR_Vp _ p _))
      (isconnected_equiv' n _
        (equiv_functor_sigma' 1 (fun q =&gt; equiv_moveR_pM _ _ _))
        (isconnected_equiv' n _ (hfiber_ap _)^-1 (isconnected_paths _ _))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** It follows that loop spaces "commute with images". *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 135
Time: 0.002s">
<div class="time" style="width: 0.14858841010401%"></div>
<pre>Definition equiv_loops_image `{Univalence} n {A B : pType} (f : A -&gt;* B)
  : loops (Build_pType (image n.+1 f) (factor1 (image n.+1 f) (point A)))
  &lt;~&gt; image n (loops_functor f).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 138
Time: 0.002s">
<div class="time" style="width: 0.14858841010401%"></div>
<pre>
  set (C := (Build_pType (image n.+1 f) (factor1 (image n.+1 f) (point A)))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (g := Build_pMap A C (factor1 (image n.+1 f)) 1).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 140
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  pose (h := Build_pMap C B (factor2 (image n.+1 f)) (point_eq f)).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  transparent assert (I : (Factorization
    (@IsConnMap n) (@MapIn n) (loops_functor f))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Loops.v
Line: 144
Time: 1.346s">
<div class="time" style="width: 100%"></div>
<pre> refine (@Build_Factorization (@IsConnMap n) (@MapIn n)
      (loops A) (loops B) (loops_functor f) (loops C)
      (loops_functor g) (loops_functor h) _ _ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 146
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
    intros x; symmetry.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 147
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
    refine (_ @ pointed_htpy (loops_functor_compose h g) x).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 148
Time: 0.002s">
<div class="time" style="width: 0.14858841010401%"></div>
<pre>
    simpl.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 149
Time: 0.01s">
<div class="time" style="width: 0.74294205052006%"></div>
<pre>
    abstract (rewrite !concat_1p; reflexivity).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Loops.v
Line: 150
Time: 0.015s">
<div class="time" style="width: 1.1144130757801%"></div>
<pre>
  exact (path_intermediate (path_factor (O_factsys n) (loops_functor f) I
    (image n (loops_functor f)))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 152
Time: 0.005s">
<div class="time" style="width: 0.37147102526003%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Loop inversion is a pointed equivalence *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition loops_inv (A : pType) : loops A &lt;~&gt;* loops A.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 156
Time: 0.772s">
<div class="time" style="width: 57.355126300149%"></div>
<pre>
  serapply Build_pEquiv.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: exact (Build_pMap (loops A) (loops A) inverse 1).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply isequiv_path_inverse.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Loops functor preserves equivalences *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition pequiv_loops_functor `{Funext} {A B : pType}
  : A &lt;~&gt;* B -&gt; loops A &lt;~&gt;* loops B.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro f.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  serapply pequiv_adjointify.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: apply loops_functor, f.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: apply loops_functor, (pequiv_inverse f).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 168
Time: 0.002s">
<div class="time" style="width: 0.14858841010401%"></div>
<pre>
  1,2: refine ((loops_functor_compose _ _)^* @* _ @* loops_functor_idmap _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 169
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  1,2: apply phomotopy_ap.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: apply peisretr.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply peissect.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 172
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma pequiv_iterated_loops_functor `{Funext} {A B n} : A &lt;~&gt;* B
  -&gt; iterated_loops n A &lt;~&gt;* iterated_loops n B.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros f.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: apply f.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  by apply pequiv_loops_functor.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Loops preserves products *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 184
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>Lemma loops_prod (X Y : pType) : loops (X * Y) &lt;~&gt;* loops X * loops Y.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 185
Time: 0.03s">
<div class="time" style="width: 2.2288261515602%"></div>
<pre>
  srefine (Build_pEquiv _ _ (Build_pMap _ _ (_ : Equiv _ _) _) _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 186
Time: 0.003s">
<div class="time" style="width: 0.22288261515602%"></div>
<pre>
  1: symmetry; refine (equiv_path_prod (point _) (point (X * Y))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 188
Time: 0.003s">
<div class="time" style="width: 0.22288261515602%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Iterated loops products preserve products *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 191
Time: 0.003s">
<div class="time" style="width: 0.22288261515602%"></div>
<pre>Lemma iterated_loops_prod `{Univalence} (X Y : pType) {n}
  : iterated_loops n (X * Y) &lt;~&gt;* (iterated_loops n X) * (iterated_loops n Y).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: reflexivity.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (pequiv_compose _ (loops_prod _ _)).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 196
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  by apply pequiv_loops_functor.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 197
Time: 0.003s">
<div class="time" style="width: 0.22288261515602%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* A dependent form of loops *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 200
Time: 0.002s">
<div class="time" style="width: 0.14858841010401%"></div>
<pre>Definition loopsD A : pFam A -&gt; pFam (loops A)
  := fun Pp =&gt; (fun q =&gt; transport Pp.1 q Pp.2 = Pp.2; 1).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Loops for pointed type families *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 203
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>Definition pfam_loops : {A : pType &amp; pFam A} -&gt; {A : pType &amp; pFam A}
  := functor_sigma loops loopsD.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* psigma and loops 'commute' *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 206
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>Lemma loops_psigma_commute `{Univalence}
  : loops o psigma == psigma o pfam_loops.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_ptype.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 210
Time: 0.032s">
<div class="time" style="width: 2.3774145616642%"></div>
<pre>
  srefine (Build_pEquiv _ _ (Build_pMap _ _ (_ : Equiv _ _) _) _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: exact (equiv_path_sigma _ _ _)^-1%equiv.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 212
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 213
Time: 0.003s">
<div class="time" style="width: 0.22288261515602%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* pforall and loops 'commute' *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 216
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>Lemma loops_pforall_commute `{Univalence} (A : Type) (F : A -&gt; pType)
  : loops (pforall (A; F)) = pforall (A; loops o F).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_ptype.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 219
Time: 0.03s">
<div class="time" style="width: 2.2288261515602%"></div>
<pre>
  srefine (Build_pEquiv _ _ (Build_pMap _ _ (_ : Equiv _ _) _) _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: apply equiv_apD10.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 222
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 223
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* pforall and iterated loops commute *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 225
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>Lemma iterated_loops_pforall_commute `{Univalence} (A : Type) (F : A -&gt; pType) (n : nat)
  : iterated_loops n (pforall (A; F)) = pforall (A; iterated_loops n o F).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 226
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n; cbn.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 228
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: reflexivity.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (ap loops IHn @ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply loops_pforall_commute.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 231
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Loops neutralise sigmas when truncated *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma loops_psigma_trunc `{Univalence} (n : nat) : forall (Aa : pType)
  (Pp : pFam Aa) (istrunc_Pp : IsTrunc_pFam (nat_to_trunc_index_2 n) Pp),
  iterated_loops n (psigma (Aa; Pp))
  = iterated_loops n Aa.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Loops.v
Line: 240
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros A P p.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 240
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    serapply path_ptype.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 241
Time: 0.035s">
<div class="time" style="width: 2.6002971768202%"></div>
<pre>
    srefine (Build_pEquiv _ _ (Build_pMap _ _ (_ : Equiv _ _) _) _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: refine (@equiv_sigma_contr _ _ p).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Loops.v
Line: 244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A P p.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (unfold_iterated_loops _ _ @ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (ap _ (loops_psigma_commute _) @ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (IHn _ _ _ @ (unfold_iterated_loops _ _)^).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 248
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro; refine (@istrunc_paths _ _ (p (point A)) _ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 249
Time: 0.004s">
<div class="time" style="width: 0.29717682020802%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* We declare this local notation to make it easier to write pointed types *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Notation "( X , x )" := (Build_pType X x).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Here are some path lemmas we will need *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Lemma path_ptype_path_equiv `{Univalence} (A : Type)
  : (A = A, 1) = (A &lt;~&gt; A, 1%equiv).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_ptype.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 257
Time: 0.182s">
<div class="time" style="width: 13.521545319465%"></div>
<pre>
  refine (Build_pEquiv _ _ (Build_pMap (A = A, 1)
    (A &lt;~&gt; A, 1%equiv) (equiv_path A A) 1) _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 259
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (isequiv_equiv_path A A).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 260
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 261
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>

Local Lemma path_ptype_issig_equiv `{Univalence} (A : Type)
  : (A &lt;~&gt; A, 1%equiv) = Build_pType
    {f : A -&gt; A &amp; IsEquiv f} (idmap; isequiv_idmap A).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  symmetry.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_ptype.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 268
Time: 0.027s">
<div class="time" style="width: 2.0059435364042%"></div>
<pre>
  refine (Build_pEquiv _ _ (Build_pMap
    ({f : A -&gt; A &amp; IsEquiv f}, (idmap; isequiv_idmap A))
    (A &lt;~&gt; A, 1%equiv) (issig_equiv _ _) 1) _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 271
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* We can convert between families of loops in a type and
   loops in Type at that type *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 275
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>Lemma local_global_looping `{Univalence} (A : Type) (n : nat)
  : iterated_loops n.+2 (Type, A)
  = pforall (A; fun a =&gt; iterated_loops n.+1 (A, a)).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 277
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (unfold_iterated_loops _ _ @ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 279
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  change (loops (Type, A)) with (A = A, 1).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (ap _ (path_ptype_path_equiv A) @ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (ap _ (path_ptype_issig_equiv A) @ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 282
Time: 0.009s">
<div class="time" style="width: 0.66864784546805%"></div>
<pre>
  change ({f : A -&gt; A &amp; IsEquiv f}, (idmap; isequiv_idmap A)) with
    (psigma ((A -&gt; A, idmap); (IsEquiv; isequiv_idmap A))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 284
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  refine (loops_psigma_trunc n.+1 (A -&gt; A, idmap)
    (IsEquiv; isequiv_idmap A) _ @ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Loops.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction n.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 288
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: apply hprop_isequiv.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply trunc_succ.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 290
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Loops.v
Line: 290
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  change (A -&gt; A, idmap) with (pforall (A; fun a =&gt; (A, a))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (iterated_loops_pforall_commute _ _ n.+1).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 292
Time: 0.003s">
<div class="time" style="width: 0.22288261515602%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* 7.2.7 *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 295
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem equiv_istrunc_istrunc_loops `{Univalence} n X
  : IsTrunc n.+2 X &lt;~&gt; forall x, IsTrunc n.+1 (loops (X, x)).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 296
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 297
Time: 0.123s">
<div class="time" style="width: 9.1381872213967%"></div>
<pre>
  serapply equiv_iff_hprop.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro tr_loops.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x y p.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct p.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply tr_loops.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 302
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 303
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* This is slightly different to 7.2.9 in that we ommit n = -1, which is
   inhabited hsets are contractible. *)</pre>
</div>
<div class="code" title="File: Loops.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem equiv_istrunc_contr_iterated_loops `{Univalence} (n : nat)
  : forall A, IsTrunc n A &lt;~&gt; forall a : A,
    Contr (iterated_loops n.+1 (A, a)).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 308
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 309
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Loops.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro A.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (equiv_composeR' equiv_hset_axiomK _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 312
Time: 0.014s">
<div class="time" style="width: 1.0401188707281%"></div>
<pre>
    refine (equiv_iff_hprop (fun K a =&gt; BuildContr _ 1 (fun x =&gt; (K a x)^)) _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros ? ? ?; apply path_contr.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Loops.v
Line: 314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro A.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 315
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  transitivity (forall x, IsTrunc n (loops (A, x))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 316
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  1: destruct n; apply equiv_istrunc_istrunc_loops.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 317
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  serapply equiv_functor_forall_id.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 318
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro a.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 319
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (equiv_composeR' (IHn (loops (A, a)))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 320
Time: 0.729s">
<div class="time" style="width: 54.160475482912%"></div>
<pre>
  cbn; refine (equiv_iff_hprop _ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 321
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  1: change ((forall p : a = a, Contr ((iterated_loops n.+1 (loops (A, a), p))))
      -&gt; Contr (iterated_loops n.+2 (A, a))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 323
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  1: refine (fun X =&gt; (ap _ (unfold_iterated_loops n.+1 _))^ # X 1).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 324
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  change (Contr (iterated_loops n.+2 (A, a))
    -&gt; (forall p : a = a, Contr ((iterated_loops n.+1 (loops (A, a), p))))).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros X p.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 327
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (@contr_equiv' _ _ _ X).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 328
Time: 0.002s">
<div class="time" style="width: 0.14858841010401%"></div>
<pre>
  rewrite !unfold_iterated_loops.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply pointed_equiv_equiv.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply pequiv_iterated_loops_functor.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  symmetry.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 332
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
  transitivity (p @ p^ = p @ p^, 1).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Loops.v
Line: 334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> srefine (Build_pEquiv' _ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 334
Time: 0.022s">
<div class="time" style="width: 1.6344725111441%"></div>
<pre>
    1: exact (equiv_ap (equiv_concat_r _ _) _ _).</pre>
</div>
<div class="code" title="File: Loops.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Loops.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  serapply Build_pEquiv'.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Loops.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply equiv_concat_lr.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 338
Time: 0.001s">
<div class="time" style="width: 0.074294205052006%"></div>
<pre>
    1: symmetry; apply concat_pV.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 339
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply concat_pV.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Loops.v
Line: 340
Time: 0.004s">
<div class="time" style="width: 0.29717682020802%"></div>
<pre>
  cbn; by rewrite concat_p1, concat_Vp.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 341
Time: 0.012s">
<div class="time" style="width: 0.89153046062407%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Loops.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

