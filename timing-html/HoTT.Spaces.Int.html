<html>
<head>
<title>Int.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Int.v</h1>

<div class="code" title="File: Int.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)

(** * The Integers. *)

</pre>
</div>
<div class="code" title="File: Int.v
Line: 4
Time: 0.035s">
<div class="time" style="width: 100%"></div>
<pre>Require Import HoTT.Basics HoTT.Types.Universe.</pre>
</div>
<div class="code" title="File: Int.v
Line: 4
Time: 0.007s">
<div class="time" style="width: 20%"></div>
<pre>
Require Import HSet.</pre>
</div>
<div class="code" title="File: Int.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Int.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ** Positive Numbers *)

</pre>
</div>
<div class="code" title="File: Int.v
Line: 10
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>Inductive Pos : Type0 :=
| one : Pos
| succ_pos : Pos -&gt; Pos.</pre>
</div>
<div class="code" title="File: Int.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition one_neq_succ_pos (z : Pos) : ~ (one = succ_pos z)
  := fun p =&gt; transport (fun s =&gt; match s with one =&gt; Unit | succ_pos t =&gt; Empty end) p tt.</pre>
</div>
<div class="code" title="File: Int.v
Line: 15
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>

Definition succ_pos_injective {z w : Pos} (p : succ_pos z = succ_pos w) : z = w
  := transport (fun s =&gt; z = (match s with one =&gt; w | succ_pos a =&gt; a end)) p (idpath z).</pre>
</div>
<div class="code" title="File: Int.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Definition of the Integers *)

</pre>
</div>
<div class="code" title="File: Int.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Inductive Int : Type0 :=
| neg : Pos -&gt; Int
| zero : Int
| pos : Pos -&gt; Int.</pre>
</div>
<div class="code" title="File: Int.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance ispointed_Int : IsPointed Int := zero.</pre>
</div>
<div class="code" title="File: Int.v
Line: 26
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>

Definition neg_injective {z w : Pos} (p : neg z = neg w) : z = w
  := transport (fun s =&gt; z = (match s with neg a =&gt; a | zero =&gt; w | pos a =&gt; w end)) p (idpath z).</pre>
</div>
<div class="code" title="File: Int.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition pos_injective {z w : Pos} (p : pos z = pos w) : z = w
  := transport (fun s =&gt; z = (match s with neg a =&gt; w | zero =&gt; w | pos a =&gt; a end)) p (idpath z).</pre>
</div>
<div class="code" title="File: Int.v
Line: 32
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>

Definition neg_neq_zero {z : Pos} : ~ (neg z = zero)
  := fun p =&gt; transport (fun s =&gt; match s with neg a =&gt; z = a | zero =&gt; Empty | pos _ =&gt; Empty end) p (idpath z).</pre>
</div>
<div class="code" title="File: Int.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition pos_neq_zero {z : Pos} : ~ (pos z = zero)
  := fun p =&gt; transport (fun s =&gt; match s with pos a =&gt; z = a | zero =&gt; Empty | neg _ =&gt; Empty end) p (idpath z).</pre>
</div>
<div class="code" title="File: Int.v
Line: 38
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>

Definition neg_neq_pos {z w : Pos} : ~ (neg z = pos w)
  := fun p =&gt; transport (fun s =&gt; match s with neg a =&gt; z = a | zero =&gt; Empty | pos _ =&gt; Empty end) p (idpath z).</pre>
</div>
<div class="code" title="File: Int.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ** Decidable paths and truncation. *)

</pre>
</div>
<div class="code" title="File: Int.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance decpaths_int : DecidablePaths Int.</pre>
</div>
<div class="code" title="File: Int.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Int.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros [n | | n] [m | | m].</pre>
</div>
<div class="code" title="File: Int.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 47
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> revert m; induction n as [|n IHn]; intros m; induction m as [|m IHm].</pre>
</div>
<div class="code" title="File: Int.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Int.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inl 1).</pre>
</div>
<div class="code" title="File: Int.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Int.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr (fun p =&gt; one_neq_succ_pos _ (neg_injective p))).</pre>
</div>
<div class="code" title="File: Int.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Int.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr (fun p =&gt; one_neq_succ_pos _ (symmetry _ _ (neg_injective p)))).</pre>
</div>
<div class="code" title="File: Int.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Int.v
Line: 51
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> destruct (IHn m) as [p | np].</pre>
</div>
<div class="code" title="File: Int.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: Int.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inl (ap neg (ap succ_pos (neg_injective p)))).</pre>
</div>
<div class="code" title="File: Int.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: Int.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr (fun p =&gt; np (ap neg (succ_pos_injective (neg_injective p))))).</pre>
</div>
<div class="code" title="File: Int.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr neg_neq_zero).</pre>
</div>
<div class="code" title="File: Int.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr neg_neq_pos).</pre>
</div>
<div class="code" title="File: Int.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 56
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> exact (inr (neg_neq_zero o symmetry _ _)).</pre>
</div>
<div class="code" title="File: Int.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inl 1).</pre>
</div>
<div class="code" title="File: Int.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 58
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> exact (inr (pos_neq_zero o symmetry _ _)).</pre>
</div>
<div class="code" title="File: Int.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 59
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> exact (inr (neg_neq_pos o symmetry _ _)).</pre>
</div>
<div class="code" title="File: Int.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr pos_neq_zero).</pre>
</div>
<div class="code" title="File: Int.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 61
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> revert m; induction n as [|n IHn]; intros m; induction m as [|m IHm].</pre>
</div>
<div class="code" title="File: Int.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Int.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inl 1).</pre>
</div>
<div class="code" title="File: Int.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Int.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr (fun p =&gt; one_neq_succ_pos _ (pos_injective p))).</pre>
</div>
<div class="code" title="File: Int.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Int.v
Line: 64
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> exact (inr (fun p =&gt; one_neq_succ_pos _ (symmetry _ _ (pos_injective p)))).</pre>
</div>
<div class="code" title="File: Int.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Int.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct (IHn m) as [p | np].</pre>
</div>
<div class="code" title="File: Int.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: Int.v
Line: 66
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> exact (inl (ap pos (ap succ_pos (pos_injective p)))).</pre>
</div>
<div class="code" title="File: Int.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: Int.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr (fun p =&gt; np (ap pos (succ_pos_injective (pos_injective p))))).</pre>
</div>
<div class="code" title="File: Int.v
Line: 67
Time: 0.006s">
<div class="time" style="width: 17.142857142857%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Int.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance hset_int : IsHSet Int | 0.</pre>
</div>
<div class="code" title="File: Int.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Int.v
Line: 71
Time: 0.003s">
<div class="time" style="width: 8.5714285714286%"></div>
<pre>
  exact _.</pre>
</div>
<div class="code" title="File: Int.v
Line: 72
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Int.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ** The successor autoequivalence. *)

</pre>
</div>
<div class="code" title="File: Int.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition succ_int (z : Int) : Int
  := match z with
       | neg (succ_pos n) =&gt; neg n
       | neg one =&gt; zero
       | zero =&gt; pos one
       | pos n =&gt; pos (succ_pos n)
     end.</pre>
</div>
<div class="code" title="File: Int.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition pred_int (z : Int) : Int
  := match z with
       | neg n =&gt; neg (succ_pos n)
       | zero =&gt; neg one
       | pos one =&gt; zero
       | pos (succ_pos n) =&gt; pos n
     end.</pre>
</div>
<div class="code" title="File: Int.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance isequiv_succ_int : IsEquiv succ_int | 0.</pre>
</div>
<div class="code" title="File: Int.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Int.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (isequiv_adjointify succ_int pred_int _ _).</pre>
</div>
<div class="code" title="File: Int.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 95
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> intros [[|n] | | [|n]]; reflexivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 96
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> intros [[|n] | | [|n]]; reflexivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 96
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Int.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Iteration of equivalences *)

(** *** Iteration by positive numbers *)

</pre>
</div>
<div class="code" title="File: Int.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section IterPos.</pre>
</div>
<div class="code" title="File: Int.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {A} (f : A -&gt; A).</pre>
</div>
<div class="code" title="File: Int.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Fixpoint iter_pos (n : Pos) : A -&gt; A
    := match n with
         | one =&gt; f
         (** Should this be (iter_pos f n (f a))? *)
         | succ_pos n =&gt; f o iter_pos n
       end.</pre>
</div>
<div class="code" title="File: Int.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iter_pos_succ_l (n : Pos) (a : A)
  : iter_pos (succ_pos n) a = f (iter_pos n a)
    := 1.</pre>
</div>
<div class="code" title="File: Int.v
Line: 114
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>

  Fixpoint iter_pos_succ_r (n : Pos) (a : A)
  : iter_pos (succ_pos n) a = iter_pos n (f a)
    := match n with
         | one =&gt; 1
         | succ_pos n =&gt; ap f (iter_pos_succ_r n a)
       end.</pre>
</div>
<div class="code" title="File: Int.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End IterPos.</pre>
</div>
<div class="code" title="File: Int.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** *** Iteration by arbitrary integers *)

</pre>
</div>
<div class="code" title="File: Int.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Iteration.</pre>
</div>
<div class="code" title="File: Int.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Iteration by arbitrary integers requires the endofunction to be an equivalence, so that we can define a negative iteration by using its inverse. *)
 </pre>
</div>
<div class="code" title="File: Int.v
Line: 129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Context {A} (f : A -&gt; A) `{IsEquiv _ _ f}.</pre>
</div>
<div class="code" title="File: Int.v
Line: 129
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>

  Definition iter_int (n : Int) : A -&gt; A
  := match n with
       | neg n =&gt; iter_pos (f^-1) n
       | zero =&gt; idmap
       | pos n =&gt; iter_pos f n
     end.</pre>
</div>
<div class="code" title="File: Int.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iter_int_succ_l (n : Int) (a : A)
  : iter_int (succ_int n) a = f (iter_int n a).</pre>
</div>
<div class="code" title="File: Int.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Int.v
Line: 140
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>
    destruct n as [[|n]| |n]; cbn.</pre>
</div>
<div class="code" title="File: Int.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Int.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry; apply eisretr.</pre>
</div>
<div class="code" title="File: Int.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (** -1 *)
   </pre>
</div>
<div class="code" title="File: Int.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Int.v
Line: 143
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> symmetry; apply eisretr.</pre>
</div>
<div class="code" title="File: Int.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (** -n *)
   </pre>
</div>
<div class="code" title="File: Int.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Int.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>              (** 0 *)
   </pre>
</div>
<div class="code" title="File: Int.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Int.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>              (** n *)
 </pre>
</div>
<div class="code" title="File: Int.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Defined.</pre>
</div>
<div class="code" title="File: Int.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iter_int_succ_r (n : Int) (a : A)
  : iter_int (succ_int n) a = iter_int n (f a).</pre>
</div>
<div class="code" title="File: Int.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Int.v
Line: 150
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>
    destruct n as [[|n]| |n]; cbn.</pre>
</div>
<div class="code" title="File: Int.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Int.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry; apply eissect.</pre>
</div>
<div class="code" title="File: Int.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (** -1 *)
   </pre>
</div>
<div class="code" title="File: Int.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Int.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (_ @ iter_pos_succ_l f^-1 n (f a)).</pre>
</div>
<div class="code" title="File: Int.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ @ (iter_pos_succ_r f^-1 n (f a))^).</pre>
</div>
<div class="code" title="File: Int.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ap.</pre>
</div>
<div class="code" title="File: Int.v
Line: 155
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>
      symmetry; apply eissect.</pre>
</div>
<div class="code" title="File: Int.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (** -n *)
   </pre>
</div>
<div class="code" title="File: Int.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Int.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>              (** 0 *)
   </pre>
</div>
<div class="code" title="File: Int.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Int.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> etransitivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (** n *)
     </pre>
</div>
<div class="code" title="File: Int.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>+</pre>
</div>
<div class="code" title="File: Int.v
Line: 159
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> symmetry; apply iter_pos_succ_l.</pre>
</div>
<div class="code" title="File: Int.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Int.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply iter_pos_succ_r.</pre>
</div>
<div class="code" title="File: Int.v
Line: 160
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Int.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iter_int_pred_l (n : Int) (a : A)
  : iter_int (pred_int n) a = f^-1 (iter_int n a).</pre>
</div>
<div class="code" title="File: Int.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Int.v
Line: 165
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>
    destruct n as [n| |[|n]]; cbn.</pre>
</div>
<div class="code" title="File: Int.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Int.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>              (** -n *)
   </pre>
</div>
<div class="code" title="File: Int.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Int.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>              (** 0 *)
   </pre>
</div>
<div class="code" title="File: Int.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Int.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry; apply eissect.</pre>
</div>
<div class="code" title="File: Int.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (** 1 *)
   </pre>
</div>
<div class="code" title="File: Int.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Int.v
Line: 170
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> symmetry; apply eissect.</pre>
</div>
<div class="code" title="File: Int.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (** n *)
 </pre>
</div>
<div class="code" title="File: Int.v
Line: 171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Defined.</pre>
</div>
<div class="code" title="File: Int.v
Line: 171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iter_int_pred_r (n : Int) (a : A)
  : iter_int (pred_int n) a = iter_int n (f^-1 a).</pre>
</div>
<div class="code" title="File: Int.v
Line: 174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Int.v
Line: 175
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>
    destruct n as [n| |[|n]]; cbn.</pre>
</div>
<div class="code" title="File: Int.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Int.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> etransitivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (** -n *)
     </pre>
</div>
<div class="code" title="File: Int.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>+</pre>
</div>
<div class="code" title="File: Int.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry; apply iter_pos_succ_l.</pre>
</div>
<div class="code" title="File: Int.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Int.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply iter_pos_succ_r.</pre>
</div>
<div class="code" title="File: Int.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Int.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>              (** 0 *)
   </pre>
</div>
<div class="code" title="File: Int.v
Line: 181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Int.v
Line: 181
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre> symmetry; apply eisretr.</pre>
</div>
<div class="code" title="File: Int.v
Line: 181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (** 1 *)
   </pre>
</div>
<div class="code" title="File: Int.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: Int.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (_ @ iter_pos_succ_l f n (f^-1 a)).</pre>
</div>
<div class="code" title="File: Int.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ @ (iter_pos_succ_r f n (f^-1 a))^).</pre>
</div>
<div class="code" title="File: Int.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ap.</pre>
</div>
<div class="code" title="File: Int.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      symmetry; apply eisretr.</pre>
</div>
<div class="code" title="File: Int.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (** n *)
 </pre>
</div>
<div class="code" title="File: Int.v
Line: 186
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>Defined.</pre>
</div>
<div class="code" title="File: Int.v
Line: 186
Time: 0.003s">
<div class="time" style="width: 8.5714285714286%"></div>
<pre>

End Iteration.</pre>
</div>
<div class="code" title="File: Int.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Exponentiation of loops *)

</pre>
</div>
<div class="code" title="File: Int.v
Line: 191
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>Fixpoint loopexp_pos {A : Type} {x : A} (p : x = x) (n : Pos) : (x = x)
  := match n with
       | one =&gt; p
       | succ_pos n =&gt; loopexp_pos p n @ p
     end.</pre>
</div>
<div class="code" title="File: Int.v
Line: 195
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>

Definition loopexp {A : Type} {x : A} (p : x = x) (z : Int) : (x = x)
  := match z with
       | neg n =&gt; loopexp_pos p^ n
       | zero =&gt; 1
       | pos n =&gt; loopexp_pos p n
     end.</pre>
</div>
<div class="code" title="File: Int.v
Line: 202
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition ap_loopexp {A B} (f : A -&gt; B) {x : A} (p : x = x) (z : Int)
: ap f (loopexp p z) = loopexp (ap f p) z.</pre>
</div>
<div class="code" title="File: Int.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Int.v
Line: 206
Time: 0.003s">
<div class="time" style="width: 8.5714285714286%"></div>
<pre>
  destruct z as [n| |n]; try reflexivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> induction n as [|n IH]; simpl.</pre>
</div>
<div class="code" title="File: Int.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    *</pre>
</div>
<div class="code" title="File: Int.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap_V.</pre>
</div>
<div class="code" title="File: Int.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    *</pre>
</div>
<div class="code" title="File: Int.v
Line: 210
Time: 0.003s">
<div class="time" style="width: 8.5714285714286%"></div>
<pre> rewrite ap_pp, IH.</pre>
</div>
<div class="code" title="File: Int.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply whiskerL, ap_V.</pre>
</div>
<div class="code" title="File: Int.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Int.v
Line: 212
Time: 0.002s">
<div class="time" style="width: 5.7142857142857%"></div>
<pre> induction n as [|n IH]; try reflexivity; simpl.</pre>
</div>
<div class="code" title="File: Int.v
Line: 212
Time: 0.003s">
<div class="time" style="width: 8.5714285714286%"></div>
<pre>
    rewrite ap_pp, IH; reflexivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 213
Time: 0.003s">
<div class="time" style="width: 8.5714285714286%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Int.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Under univalence, exponentiation of loops corresponds to iteration of autoequivalences. *)

</pre>
</div>
<div class="code" title="File: Int.v
Line: 217
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>Definition equiv_path_loopexp `{Univalence}
           {A : Type} (p : A = A) (z : Int) (a : A)
  : equiv_path A A (loopexp p z) a = iter_int (equiv_path A A p) z a.</pre>
</div>
<div class="code" title="File: Int.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Int.v
Line: 220
Time: 0.002s">
<div class="time" style="width: 5.7142857142857%"></div>
<pre>
  destruct z as [n| |n]; try reflexivity.</pre>
</div>
<div class="code" title="File: Int.v
Line: 221
Time: 0.004s">
<div class="time" style="width: 11.428571428571%"></div>
<pre>
  all:induction n as [|n IH]; try reflexivity; cbn in *.</pre>
</div>
<div class="code" title="File: Int.v
Line: 222
Time: 0.002s">
<div class="time" style="width: 5.7142857142857%"></div>
<pre>
  all:refine (transport_pp _ _ _ _ @ _); apply ap, IH.</pre>
</div>
<div class="code" title="File: Int.v
Line: 223
Time: 0.004s">
<div class="time" style="width: 11.428571428571%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Int.v
Line: 224
Time: 0.003s">
<div class="time" style="width: 8.5714285714286%"></div>
<pre>

Definition loopexp_path_universe `{Univalence}
           {A : Type} (f : A &lt;~&gt; A) (z : Int) (a : A)
: transport idmap (loopexp (path_universe f) z) a
  = iter_int f z a.</pre>
</div>
<div class="code" title="File: Int.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Int.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert f.</pre>
</div>
<div class="code" title="File: Int.v
Line: 231
Time: 0.002s">
<div class="time" style="width: 5.7142857142857%"></div>
<pre> equiv_intro (equiv_path A A) p.</pre>
</div>
<div class="code" title="File: Int.v
Line: 231
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (_ @ equiv_path_loopexp p z a).</pre>
</div>
<div class="code" title="File: Int.v
Line: 232
Time: 0.001s">
<div class="time" style="width: 2.8571428571429%"></div>
<pre>
  refine (ap (fun q =&gt; equiv_path A A (loopexp q z) a) _).</pre>
</div>
<div class="code" title="File: Int.v
Line: 233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply eissect.</pre>
</div>
<div class="code" title="File: Int.v
Line: 234
Time: 0.002s">
<div class="time" style="width: 5.7142857142857%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Int.v
Line: 236
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

