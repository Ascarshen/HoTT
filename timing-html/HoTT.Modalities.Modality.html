<html>
<head>
<title>Modality.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Modality.v</h1>

<div class="code" title="File: Modality.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 1
Time: 0.036s">
<div class="time" style="width: 16.143497757848%"></div>
<pre>Require Import HoTT.Basics HoTT.Types.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 1
Time: 0.022s">
<div class="time" style="width: 9.8654708520179%"></div>
<pre>
Require Import Fibrations EquivalenceVarieties Extensions Factorization NullHomotopy HProp Pullback.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 2
Time: 0.009s">
<div class="time" style="width: 4.0358744394619%"></div>
<pre>
Require Export ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* [Export] because many of the lemmas and facts about reflective subuniverses are equally important for modalities. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 3
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>Require Import HoTT.Tactics.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * Modalities *)

</pre>
</div>
<div class="code" title="File: Modality.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Type Modalities.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter Modality@{u a} : Type2@{u a}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** These are the same as for a reflective subuniverse. *)

 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter O_reflector@{u a i} : forall (O : Modality@{u a}),
                            Type2le@{i a} -&gt; Type2le@{i a}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter In@{u a i} : forall (O : Modality@{u a}),
                            Type2le@{i a} -&gt; Type2le@{i a}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter O_inO@{u a i} : forall (O : Modality@{u a}) (T : Type@{i}),
                               In@{u a i} O (O_reflector@{u a i} O T).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter to@{u a i} : forall (O : Modality@{u a}) (T : Type@{i}),
                   T -&gt; O_reflector@{u a i} O T.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter inO_equiv_inO@{u a i j k} :
      forall (O : Modality@{u a}) (T : Type@{i}) (U : Type@{j})
             (T_inO : In@{u a i} O T) (f : T -&gt; U) (feq : IsEquiv f),
        (** We add an extra universe parameter that's bigger than both [i] and [j].  This seems to be necessary for the proof of repleteness in some examples, such as easy modalities. *)
        let gei := ((fun x =&gt; x) : Type@{i} -&gt; Type@{k}) in
        let gej := ((fun x =&gt; x) : Type@{j} -&gt; Type@{k}) in
        In@{u a j} O U.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter hprop_inO@{u a i}
  : Funext -&gt; forall (O : Modality@{u a}) (T : Type@{i}),
                IsHProp (In@{u a i} O T).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter IsSepFor@{u a} : forall (O' O : Modality@{u a}), Type@{u}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter inO_paths_from_inSepO@{u a i iplus}
    : forall (O' O : Modality@{u a}) (sep : IsSepFor O' O)
             (A : Type@{i}) (A_inO : In@{u a i} O' A) (x y : A),
      let gt := (Type1@{i} : Type@{iplus}) in
      In@{u a i} O (x = y).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter inSepO_from_inO_paths@{u a i iplus}
    : forall (O' O : Modality@{u a}) (sep : IsSepFor O' O)
             (A : Type@{i}),
      let gt := (Type1@{i} : Type@{iplus}) in
      (forall (x y : A), In@{u a i} O (x = y)) -&gt; In@{u a i} O' A.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Now instead of [extendable_to_O], we have an ordinary induction principle. *)

  (** Unfortunately, we have to define these parameters as [_internal] versions and redefine them later.  This is because eventually we want the [In] fields of [O_ind] and [O_ind_beta] to refer to the [In] typeclass defined for [ReflectiveSubuniverse]s, but in order to prove that modalities *are* reflective subuniverses we need to already have [O_ind] and [O_ind_beta]. *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 55
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>Parameter O_ind_internal@{u a i j k}
  : forall (O : Modality@{u a})
           (A : Type2le@{i a})
           (B : O_reflector@{u a i} O A -&gt; Type2le@{j a})
           (B_inO : forall oa, In@{u a j} O (B oa)),
      (** We add an extra unused universe parameter [k] that's [&gt;= max(i,j)].  This seems to be necessary for some examples, such as [Nullification], which are constructed by way of an operation that requires such a universe.  *)
      let gei := ((fun x =&gt; x) : Type@{i} -&gt; Type@{k}) in
      let gej := ((fun x =&gt; x) : Type@{j} -&gt; Type@{k}) in
      (forall a, B (to O A a)) -&gt; forall a, B a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 63
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

  Parameter O_ind_beta_internal@{u a i j k}
  : forall (O : Modality@{u a})
           (A : Type@{i}) (B : O_reflector O A -&gt; Type@{j})
           (B_inO : forall oa, In@{u a j} O (B oa))
           (f : forall a : A, B (to O A a)) (a:A),
      O_ind_internal@{u a i j k} O A B B_inO f (to O A a) = f a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter minO_paths@{u a i}
  : forall (O : Modality@{u a})
           (A : Type2le@{i a}) (A_inO : In@{u a i} O A) (z z' : A),
      In@{u a i} O (z = z').</pre>
</div>
<div class="code" title="File: Modality.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End Modalities.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Modalities are reflective subuniverses *)

(** We show that modalities have underlying reflective subuniverses.  It is important in some applications, such as [Trunc], that this construction uses the general [O_ind] given as part of the modality data.  For instance, this ensures that [O_functor] reduces to simply an application of [O_ind].

  Note also that our choice of how to define reflective subuniverses differently from the book, using [ooExtendableAlong] enables us to prove this without using funext. *)

</pre>
</div>
<div class="code" title="File: Modality.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Modalities_to_ReflectiveSubuniverses
       (Os : Modalities) &lt;: ReflectiveSubuniverses.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Import Os.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 87
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

  Fixpoint O_extendable@{u a i j k} (O : Modality@{u a})
           (A : Type@{i}) (B : O_reflector O A -&gt; Type@{j})
           (B_inO : forall a, In@{u a j} O (B a)) (n : nat)
  : ExtendableAlong@{i i j k} n (to O A) B.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct n as [|n].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact tt.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> split.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros g.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 97
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
        exists (O_ind_internal@{u a i j k} O A B B_inO g); intros x.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply O_ind_beta_internal.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros h k.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply O_extendable; intros x.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply minO_paths; trivial.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 102
Time: 0.002s">
<div class="time" style="width: 0.89686098654709%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition ReflectiveSubuniverse := Modality.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_reflector@{u a i} := O_reflector@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Work around https://coq.inria.fr/bugs/show_bug.cgi?id=3807 *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition In@{u a i} : forall (O : ReflectiveSubuniverse@{u a}),
                   Type2le@{i a} -&gt; Type2le@{i a}
    := In@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition O_inO@{u a i} : forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}),
                               In@{u a i} O (O_reflector@{u a i} O T)
    := O_inO@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition to@{u a i} := to@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inO_equiv_inO@{u a i j k} :
      forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}) (U : Type@{j})
             (T_inO : In@{u a i} O T) (f : T -&gt; U) (feq : IsEquiv f),
        In@{u a j} O U
    := inO_equiv_inO@{u a i j k}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition hprop_inO@{u a i}
  : Funext -&gt; forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}),
                IsHProp (In@{u a i} O T)
    := hprop_inO@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition IsSepFor@{u a} := IsSepFor@{u a}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inO_paths_from_inSepO@{u a i iplus} := inO_paths_from_inSepO@{u a i iplus}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inSepO_from_inO_paths@{u a i iplus} := inSepO_from_inO_paths@{u a i iplus}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Corollary 7.7.8, part 1 *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition extendable_to_O@{u a i j k} (O : ReflectiveSubuniverse@{u a})
             {P : Type2le@{i a}} {Q : Type2le@{j a}} {Q_inO : In@{u a j} O Q}
  : ooExtendableAlong@{i i j k} (to O P) (fun _ =&gt; Q)
    := fun n =&gt; O_extendable O P (fun _ =&gt; Q) (fun _ =&gt; Q_inO) n.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 133
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

End Modalities_to_ReflectiveSubuniverses.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** Conversely, if a reflective subuniverse is closed under sigmas, it is a modality.  This is a bit annoying to state using modules, but it is not really a problem in practice: in most or all examples, constructing [O_ind] directly is just as easy, and preferable because it sometimes gives a judgmental computation rule. *)

</pre>
</div>
<div class="code" title="File: Modality.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Type SigmaClosed (Os : ReflectiveSubuniverses).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Import Os.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter inO_sigma@{u a i j k}
  : forall (O : ReflectiveSubuniverse@{u a})
           (A:Type@{i}) (B:A -&gt; Type@{j})
           (A_inO : In@{u a i} O A)
           (B_inO : forall a, In@{u a j} O (B a)),
      In@{u a k} O {x:A &amp; B x}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End SigmaClosed.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 150
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

Module ReflectiveSubuniverses_to_Modalities
       (Os : ReflectiveSubuniverses) (OsSigma : SigmaClosed Os)
  &lt;: Modalities.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Import Os OsSigma.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 156
Time: 0.223s">
<div class="time" style="width: 100%"></div>
<pre>
  Module Import Os_Theory := ReflectiveSubuniverses_Theory Os.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Modality := ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_reflector@{u a i} := O_reflector@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Work around https://coq.inria.fr/bugs/show_bug.cgi?id=3807 *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition In@{u a i} := In@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition O_inO@{u a i} := @O_inO@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition to@{u a i} := to@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inO_equiv_inO@{u a i j k} := @inO_equiv_inO@{u a i j k}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition hprop_inO@{u a i} := hprop_inO@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition IsSepFor@{u a} := IsSepFor@{u a}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inO_paths_from_inSepO@{u a i iplus} := inO_paths_from_inSepO@{u a i iplus}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inSepO_from_inO_paths@{u a i iplus} := inSepO_from_inO_paths@{u a i iplus}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 170
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

  Definition O_ind_internal@{u a i j k} (O : Modality@{u a})
             (A : Type@{i}) (B : O_reflector@{u a i} O A -&gt; Type@{j})
             (B_inO : forall oa, In@{u a j} O (B oa))
  : (forall a, B (to O A a)) -&gt; forall a, B a
  := fun g =&gt; pr1 ((O_ind_from_inO_sigma@{u a i j k} O (inO_sigma O))
                     A B B_inO g).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 177
Time: 0.002s">
<div class="time" style="width: 0.89686098654709%"></div>
<pre>

  Definition O_ind_beta_internal@{u a i j k} (O : Modality@{u a})
             (A : Type@{i}) (B : O_reflector@{u a i} O A -&gt; Type@{j})
             (B_inO : forall oa, In@{u a j} O (B oa))
             (f : forall a : A, B (to O A a)) (a:A)
  : O_ind_internal O A B B_inO f (to O A a) = f a
  := pr2 ((O_ind_from_inO_sigma@{u a i j k} O (inO_sigma O))
                     A B B_inO f) a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition minO_paths@{u a i} (O : Modality@{u a})
             (A : Type@{i}) (A_inO : In@{u a i} O A) (z z' : A)
  : In O (z = z')
  := @inO_paths@{u a i i} O A A_inO z z'.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 190
Time: 0.002s">
<div class="time" style="width: 0.89686098654709%"></div>
<pre>

End ReflectiveSubuniverses_to_Modalities.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** ** Easy modalities *)

(** Our definition of modality is slightly different from the one in the book, which requires an induction principle only into families of the form [fun oa =&gt; O (B oa)], and similarly only that path-spaces of types [O A] are modal, where "modal" means that the unit is an equivalence.  This is equivalent, roughly since every modal type [A] (in this sense) is equivalent to [O A].

However, our definition is more convenient in formalized applications because in some examples (such as [Trunc] and closed modalities), there is a naturally occurring [O_ind] into all modal types that is not judgmentally equal to the one that can be constructed by passing through [O] and back again.  Thus, when we apply general theorems about modalities to a particular modality such as [Trunc], the proofs will reduce definitionally to "the way we would have proved them directly" if we didn't know about general modalities.

On the other hand, in other examples (such as [~~] and open modalities) it is easier to construct the latter weaker induction principle.  Thus, we now show how to get from that to our definition of modality. *)

</pre>
</div>
<div class="code" title="File: Modality.v
Line: 202
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Type EasyModalities.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 202
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter Modality@{u a} : Type2@{u a}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter O_reflector@{u a i} : forall (O : Modality@{u a}),
                            Type2le@{i a} -&gt; Type2le@{i a}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter to@{u a i} : forall (O : Modality@{u a}) (T : Type@{i}),
                   T -&gt; O_reflector@{u a i} O T.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter O_indO@{u a i j}
  : forall (O : Modality@{u a}) (A : Type@{i})
           (B : O_reflector@{u a i} O A -&gt; Type@{j}),
      (forall a, O_reflector@{u a j} O (B (to O A a)))
      -&gt; forall z, O_reflector@{u a j} O (B z).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 216
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

  Parameter O_indO_beta@{u a i j}
  : forall (O : Modality@{u a}) (A : Type@{i})
           (B : O_reflector@{u a i} O A -&gt; Type@{j})
           (f : forall a, O_reflector@{u a j} O (B (to O A a))) a,
      O_indO O A B f (to O A a) = f a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 222
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter minO_pathsO@{u a i}
  : forall (O : Modality@{u a}) (A : Type@{i})
           (z z' : O_reflector@{u a i} O A),
      IsEquiv (to@{u a i} O (z = z')).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End EasyModalities.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Module EasyModalities_to_Modalities (Os : EasyModalities)
&lt;: Modalities.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Import Os.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Modality := Modality.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 236
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Work around https://coq.inria.fr/bugs/show_bug.cgi?id=3807 *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_reflector@{u a i} := O_reflector@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition to@{u a i} := to@{u a i}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition In@{u a i}
  : forall (O : Modality@{u a}), Type@{i} -&gt; Type@{i}
  := fun O A =&gt; IsEquiv@{i i} (to O A).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition hprop_inO@{u a i} `{Funext} (O : Modality@{u a})
             (T : Type@{i})
  : IsHProp (In@{u a i} O T).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 248
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold In.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 249
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (hprop_isequiv (to O T)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 251
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_ind_internal@{u a i j k} (O : Modality@{u a})
             (A : Type@{i}) (B : O_reflector@{u a i} O A -&gt; Type@{j})
             (B_inO : forall oa, In@{u a j} O (B oa))
  : let gei := ((fun x =&gt; x) : Type@{i} -&gt; Type@{k}) in
    let gej := ((fun x =&gt; x) : Type@{j} -&gt; Type@{k}) in
    (forall a, B (to O A a)) -&gt; forall oa, B oa.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 258
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 259
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl; intros f oa.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 260
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (H := B_inO oa); unfold In in H.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ((to O (B oa))^-1).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 262
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply O_indO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 263
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a; apply to, f.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_ind_beta_internal@{u a i j k} (O : Modality@{u a})
             (A : Type@{i}) (B : O_reflector@{u a i} O A -&gt; Type@{j})
             (B_inO : forall oa, In@{u a j} O (B oa))
             (f : forall a : A, B (to O A a)) (a:A)
  : O_ind_internal@{u a i j k} O A B B_inO f (to O A a) = f a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 271
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold O_ind_internal.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 273
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply moveR_equiv_V.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 274
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply @O_indO_beta with (f := fun x =&gt; to O _ (f x)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 275
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 276
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_inO@{u a i} (O : Modality@{u a}) (A : Type@{i})
  : In@{u a i} O (O_reflector@{u a i} O A).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 279
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (isequiv_adjointify (to O (O_reflector O A))
             (O_indO O (O_reflector O A) (fun _ =&gt; A) idmap) _ _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x; pattern x; apply O_ind_internal.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros oa; apply minO_pathsO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a; apply ap.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (O_indO_beta O (O_reflector O A) (fun _ =&gt; A) idmap a).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (O_indO_beta O (O_reflector O A) (fun _ =&gt; A) idmap a).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 288
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** It seems to be surprisingly hard to show repleteness (without univalence).  We basically have to manually develop enough functoriality of [O] and naturality of [to O]. *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 292
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition inO_equiv_inO@{u a i j k} (O : Modality@{u a}) (A : Type@{i}) (B : Type@{j})
    (A_inO : In@{u a i} O A) (f : A -&gt; B) (feq : IsEquiv f)
  : In@{u a j} O B.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 294
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 295
Time: 0.016s">
<div class="time" style="width: 7.1748878923767%"></div>
<pre>
    simple refine (isequiv_commsq (to O A) (to O B) f
             (O_ind_internal O A (fun _ =&gt; O_reflector O B) _ (fun a =&gt; to O B (f a))) _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros; apply O_inO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a; refine (O_ind_beta_internal@{u a i j k} O A (fun _ =&gt; O_reflector O B) _ _ a).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply A_inO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 301
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre> simple refine (isequiv_adjointify _
               (O_ind_internal O B (fun _ =&gt; O_reflector O A) _ (fun b =&gt; to O A (f^-1 b))) _ _);
        intros x.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 303
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_inO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 305
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre> pattern x; refine (O_ind_internal O B _ _ _ x); intros.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: Modality.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply minO_pathsO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: Modality.v
Line: 307
Time: 0.009s">
<div class="time" style="width: 4.0358744394619%"></div>
<pre> simpl; abstract (repeat rewrite O_ind_beta_internal; apply ap, eisretr).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 307
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 308
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre> pattern x; refine (O_ind_internal O A _ _ _ x); intros.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 308
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: Modality.v
Line: 309
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply minO_pathsO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 309
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: Modality.v
Line: 310
Time: 0.005s">
<div class="time" style="width: 2.2421524663677%"></div>
<pre> simpl; abstract (repeat rewrite O_ind_beta_internal; apply ap, eissect).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 310
Time: 0.005s">
<div class="time" style="width: 2.2421524663677%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition minO_paths@{u a i} (O : Modality@{u a})
             (A : Type@{i}) (A_inO : In@{u a i} O A) (a a' : A)
  : In@{u a i} O (a = a').</pre>
</div>
<div class="code" title="File: Modality.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 316
Time: 0.015s">
<div class="time" style="width: 6.7264573991031%"></div>
<pre>
    simple refine (inO_equiv_inO O (to O A a = to O A a') _ _
                          (@ap _ _ (to O A) a a')^-1 _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 318
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 319
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply minO_pathsO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 319
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (@isequiv_ap _ _ _ A_inO _ _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply isequiv_inverse.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 322
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We don't bother including separatedness for modalities constructed in this way.  (We could.)  *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition IsSepFor@{u a} (O' O : Modality@{u a}) : Type@{u}
    := Empty.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition inO_paths_from_inSepO@{u a i iplus}
            (O' O : Modality@{u a}) (sep : IsSepFor O' O)
            (A : Type@{i}) (A_inO : In@{u a i} O' A) (x y : A)
    : In@{u a i} O (x = y)
    := Empty_rec sep.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 332
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition inSepO_from_inO_paths@{u a i iplus}
             (O' O : Modality@{u a}) (sep : IsSepFor O' O)
             (A : Type@{i}) (op : forall (x y : A), In@{u a i} O (x = y))
    : In@{u a i} O' A
    := Empty_rec sep.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End EasyModalities_to_Modalities.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We now move on to the general theory of modalities. *)

</pre>
</div>
<div class="code" title="File: Modality.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Modalities_Theory (Os : Modalities).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Export Os.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 345
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
Module Export Os_ReflectiveSubuniverses
  := Modalities_to_ReflectiveSubuniverses Os.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 347
Time: 0.163s">
<div class="time" style="width: 73.094170403587%"></div>
<pre>
Module Export RSU
  := ReflectiveSubuniverses_Theory Os_ReflectiveSubuniverses.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 349
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** As with reflective subuniverses, we put this in a module so it can be exported separately (and it should be). *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Export Coercions.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Coercion modality_to_reflective_subuniverse
    := idmap : Modality -&gt; ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 353
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Coercions.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 354
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** As promised, we redefine [O_ind] and [O_ind_beta] so that their [In] hypotheses refer to the typeclass [RSU.In]. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 356
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>Definition O_ind@{u a i j e0 e1 e2} {O : Modality@{u a}}
           {A : Type@{i}} (B : O A -&gt; Type@{j})
           {B_inO : forall oa, In O (B oa)}
           (f : forall a, B (to O A a)) (oa : O A)
: B oa
:= O_ind_internal@{u a e0 e1 e2} O A B B_inO f oa.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 361
Time: 0.002s">
<div class="time" style="width: 0.89686098654709%"></div>
<pre>

Definition O_ind_beta {O : Modality@{u a}}
           {A : Type@{i}} (B : O A -&gt; Type@{j})
           {B_inO : forall oa, In O (B oa)}
           (f : forall a : A, B (to O A a)) (a : A)
: @O_ind O A B B_inO f (to O A a) = f a
:= O_ind_beta_internal O A B B_inO f a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 368
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** The induction principle [O_ind], like most induction principles, is an equivalence. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 370
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section OIndEquiv.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 370
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {fs : Funext} (O : Modality).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 371
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section OIndEquivData.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 373
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Context {A : Type} (B : O A -&gt; Type) `{forall a, In O (B a)}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 375
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance isequiv_O_ind : IsEquiv (O_ind B).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 377
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 378
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply isequiv_adjointify with (g := fun h =&gt; h oD to O A).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 379
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros h.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_forall.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 380
Time: 0.004s">
<div class="time" style="width: 1.7937219730942%"></div>
<pre>
        refine (O_ind (fun oa =&gt; O_ind B (h oD to O A) oa = h oa) _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 381
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (O_ind_beta B (h oD to O A)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 382
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 383
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 383
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_forall.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 383
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (O_ind_beta B f).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 384
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 385
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

    Definition equiv_O_ind
    : (forall a, B (to O A a)) &lt;~&gt; (forall oa, B oa)
    := Build_Equiv _ _ (O_ind B) _.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 389
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Theorem 7.7.7 *)
   </pre>
</div>
<div class="code" title="File: Modality.v
Line: 392
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>Definition isequiv_oD_to_O
    : IsEquiv (fun (h : forall oa, B oa) =&gt; h oD to O A)
    := equiv_isequiv equiv_O_ind^-1.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 394
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  End OIndEquivData.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 396
Time: 0.004s">
<div class="time" style="width: 1.7937219730942%"></div>
<pre>

  Local Definition isequiv_o_to_O (A B : Type) (B_inO : In O B)
  : IsEquiv (fun (h : O A -&gt; B) =&gt; h o to O A)
    := isequiv_oD_to_O (fun _ =&gt; B).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 400
Time: 0.002s">
<div class="time" style="width: 0.89686098654709%"></div>
<pre>

End OIndEquiv.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Two modalities are the same if they have the same modal types. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 404
Time: 0.002s">
<div class="time" style="width: 0.89686098654709%"></div>
<pre>Class OeqO (O1 O2 : Modality)
  := inO_OeqO : forall A, In O1 A &lt;-&gt; In O2 A.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 405
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance reflexive_OeqO : Reflexive OeqO | 10.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 407
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros O A; reflexivity.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 409
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 410
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance symmetric_OeqO : Symmetric OeqO | 10.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 412
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 413
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros O1 O2 O12 A.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 414
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  specialize (O12 A).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 415
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  symmetry; assumption.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 416
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 417
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance transitive_OeqO : Transitive OeqO | 10.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 419
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 420
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros O1 O2 O3 O12 O23 A; split.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 421
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 422
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros A1.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 422
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (@inO_OeqO O2 O3 O23).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 423
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (@inO_OeqO O1 O2 O12).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 424
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact A1.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 425
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 426
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros A3.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 426
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (@inO_OeqO O1 O2 O12).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (@inO_OeqO O2 O3 O23).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact A3.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 429
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 430
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Two equivalent modalities have the same connected types. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 432
Time: 0.009s">
<div class="time" style="width: 4.0358744394619%"></div>
<pre>Global Instance isconnected_OeqO {O1 O2 : Modality} `{OeqO O1 O2}
       (A : Type) `{IsConnected O1 A}
  : IsConnected O2 A.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 434
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 435
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply isconnected_from_elim.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 436
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros C C2 f.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 437
Time: 0.002s">
<div class="time" style="width: 0.89686098654709%"></div>
<pre>
  apply (isconnected_elim O1); apply inO_OeqO; exact _.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 438
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 439
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We prove some useful consequences of [O_ind] that enhance the behavior of reflective subuniverses. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Enhancements.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {O : Modality}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 442
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Corollary 7.5.8: The unit maps [to O A] are connected. *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 445
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance conn_map_to_O (A : Type) : IsConnMap O (to O A).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 445
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 446
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply conn_map_from_extension_elim; intros P ? d.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 447
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists (O_ind P d); intros a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 448
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply O_ind_beta.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 449
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Corollary 7.7.8, part 2 *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_sigma (A:Type) (B:A -&gt; Type)
         `{In O A} `{forall a, In O (B a)}
  : In O {x:A &amp; B x}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 455
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 456
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    generalize dependent A.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 457
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (inO_sigma_from_O_ind _ _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 458
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A B ? g.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 459
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists (O_ind B g).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 460
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply O_ind_beta.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 461
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 462
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** This implies that the composite of modal maps is modal. *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 465
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>Global Instance mapinO_compose {A B C : Type} (f : A -&gt; B) (g : B -&gt; C)
         `{MapIn O _ _ f} `{MapIn O _ _ g}
  : MapIn O (g o f).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 467
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 468
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros c.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 469
Time: 0.18s">
<div class="time" style="width: 80.717488789238%"></div>
<pre>
    refine (inO_equiv_inO _ (hfiber_compose f g c)^-1).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 470
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 471
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Corollary 7.3.10.  (Theorem 7.3.9 is true for any reflective subuniverse.) *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 474
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Corollary equiv_sigma_inO_O {A} `{In O A} (P : A -&gt; Type)
  : {x:A &amp; O (P x)} &lt;~&gt; O {x:A &amp; P x}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 475
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 476
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
    transitivity (O {x:A &amp; O (P x)}).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 477
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 478
Time: 0.006s">
<div class="time" style="width: 2.6905829596413%"></div>
<pre> apply equiv_to_O; exact _.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 478
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 479
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply equiv_O_sigma_O.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 479
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 480
Time: 0.002s">
<div class="time" style="width: 0.89686098654709%"></div>
<pre>

End Enhancements.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 482
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** An enhancement of Corollary 2.29 of CORS: when O (hence also O') is a modality, the map between fibers is not just an O-equivalence but is O-connected. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 484
Time: 0.002s">
<div class="time" style="width: 0.89686098654709%"></div>
<pre>Global Instance conn_map_functor_hfiber `{Univalence} {O O' : Modality} `{IsSepFor O' O}
       {Y X : Type} (f : Y -&gt; X) (x : X)
  : IsConnMap O (functor_hfiber (fun y =&gt; (to_O_natural O' f y)^) x).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 486
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 487
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
  intros [oy p].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 488
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
  rewrite &lt;- (inv_V p).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 489
Time: 0.002s">
<div class="time" style="width: 0.89686098654709%"></div>
<pre>
  ntc_refine (isconnected_equiv' O _
               (hfiber_functor_hfiber (to_O_natural O' f) oy x p^) _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 491
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
  ntc_refine (isconnected_hfiber_conn_map
                (f := (functor_hfiber (to_O_natural O' f) oy)) (x;p^)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 493
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply conn_map_SepO_inverts.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 494
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* Actually typeclasss search can do the rest by itself, but to help the human reader we show what's going on.  (As a byproduct this makes it marginally faster too). *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>apply O_inverts_isconnected.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
  -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 497
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply conn_map_to_O.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 497
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 498
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply conn_map_to_O.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 498
Time: 0.005s">
<div class="time" style="width: 2.2421524663677%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 499
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** The modal factorization system *)

</pre>
</div>
<div class="code" title="File: Modality.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section ModalFact.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{fs : Funext} (O : Modality).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Lemma 7.6.4 *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 506
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition image {A B : Type} (f : A -&gt; B)
  : Factorization (@IsConnMap O) (@MapIn O) f.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 507
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 508
Time: 0.011s">
<div class="time" style="width: 4.932735426009%"></div>
<pre>
    refine (Build_Factorization {b : B &amp; O (hfiber f b)}
                                (fun a =&gt; (f a ; to O _ (a;1)))
                                pr1
                                (fun a =&gt; 1)
                                _ _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 513
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 514
Time: 0.084s">
<div class="time" style="width: 37.668161434978%"></div>
<pre> exact (conn_map_compose O
              (equiv_fibration_replacement f)
              (functor_sigma idmap (fun b =&gt; to O (hfiber f b)))).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 516
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 517
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

  Global Instance conn_map_factor1_image {A B : Type} (f : A -&gt; B)
  : IsConnMap O (factor1 (image f))
    := inclass1 (image f).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 521
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

  Global Instance inO_map_factor1_image {A B : Type} (f : A -&gt; B)
  : MapIn O (factor2 (image f))
    := inclass2 (image f).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 525
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** This is the composite of the three displayed equivalences at the beginning of the proof of Lemma 7.6.5.  Note that it involves only a single factorization of [f]. *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 528
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>Lemma O_hfiber_O_fact {A B : Type} {f : A -&gt; B}
        (fact : Factorization (@IsConnMap O) (@MapIn O) f) (b : B)
  : O (hfiber (factor2 fact o factor1 fact) b)
      &lt;~&gt; hfiber (factor2 fact) b.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 531
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 532
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
    refine (_ oE
             (equiv_O_functor O
               (hfiber_compose (factor1 fact) (factor2 fact) b))).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 535
Time: 0.082s">
<div class="time" style="width: 36.77130044843%"></div>
<pre>
    refine (equiv_sigma_contr (fun w =&gt; O (hfiber (factor1 fact) w.1)) oE _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 536
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 537
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros w; exact (inclass1 fact w.1).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 537
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 538
Time: 0.037s">
<div class="time" style="width: 16.591928251121%"></div>
<pre> refine ((equiv_sigma_inO_O (fun w =&gt; hfiber (factor1 fact) w.1))^-1)%equiv.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 538
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (inclass2 fact b).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 539
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 540
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** This is the corresponding first three of the displayed "mapsto"s in proof of Lemma 7.6.5, and also the last three in reverse order, generalized to an arbitrary path [p].  Note that it is much harder to prove than in the book, because we are working in the extra generality of a modality where [O_ind_beta] is only propositional. *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 543
Time: 0.1s">
<div class="time" style="width: 44.843049327354%"></div>
<pre>Lemma O_hfiber_O_fact_inverse_beta {A B : Type} {f : A -&gt; B}
        (fact : Factorization (@IsConnMap O) (@MapIn O) f)
        (a : A) (b : B) (p : factor2 fact (factor1 fact a) = b)
  : (O_hfiber_O_fact fact b)^-1
      (factor1 fact a ; p) = to O _ (a ; p).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 547
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 548
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
    set (g := factor1 fact); set (h := factor2 fact).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 549
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply moveR_equiv_V.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 550
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold O_hfiber_O_fact.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 551
Time: 0.054s">
<div class="time" style="width: 24.215246636771%"></div>
<pre>
    ev_equiv.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 552
Time: 0.004s">
<div class="time" style="width: 1.7937219730942%"></div>
<pre>
    apply moveL_equiv_M.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 553
Time: 0.009s">
<div class="time" style="width: 4.0358744394619%"></div>
<pre>
    transitivity (existT (fun (w : hfiber h b) =&gt; O (hfiber g w.1))
                         (g a; p) (to O (hfiber g (g a)) (a ; 1))).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 555
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 556
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre> apply moveR_equiv_V; reflexivity.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 556
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 557
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre> apply moveL_equiv_V.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 557
Time: 0.003s">
<div class="time" style="width: 1.3452914798206%"></div>
<pre>
      transitivity (to O _ (existT (fun (w : hfiber h b) =&gt; (hfiber g w.1))
                         (g a; p) (a ; 1))).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 559
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 560
Time: 0.049s">
<div class="time" style="width: 21.973094170404%"></div>
<pre> simpl; repeat rewrite O_rec_beta; reflexivity.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 560
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 561
Time: 0.003s">
<div class="time" style="width: 1.3452914798206%"></div>
<pre> symmetry; apply to_O_natural.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 561
Time: 0.02s">
<div class="time" style="width: 8.9686098654709%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 562
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section TwoFactorizations.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 564
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
    Context {A B : Type} (f : A -&gt; B)
            (fact fact' : Factorization (@IsConnMap O) (@MapIn O) f).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 566
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Let H := fun x =&gt; fact_factors fact x @ (fact_factors fact' x)^.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 568
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Lemma 7.6.5, part 1. *)
   </pre>
</div>
<div class="code" title="File: Modality.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition equiv_O_factor_hfibers (b:B)
    : hfiber (factor2 fact) b &lt;~&gt; hfiber (factor2 fact') b.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 572
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 573
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (O_hfiber_O_fact fact' b oE _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 574
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ oE (O_hfiber_O_fact fact b)^-1).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 575
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_O_functor.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 576
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_hfiber_homotopic.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 577
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact H.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 578
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 579
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Lemma 7.6.5, part 2. *)
   </pre>
</div>
<div class="code" title="File: Modality.v
Line: 582
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>Definition equiv_O_factor_hfibers_beta (a : A)
    : equiv_O_factor_hfibers (factor2 fact (factor1 fact a))
                             (factor1 fact a ; 1)
      = (factor1 fact' a ; (H a)^).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 585
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 586
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold equiv_O_factor_hfibers.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 587
Time: 0.087s">
<div class="time" style="width: 39.013452914798%"></div>
<pre>
      ev_equiv.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 588
Time: 0.16s">
<div class="time" style="width: 71.748878923767%"></div>
<pre>
      apply moveR_equiv_M.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 589
Time: 0.007s">
<div class="time" style="width: 3.1390134529148%"></div>
<pre>
      do 2 rewrite O_hfiber_O_fact_inverse_beta.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 590
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold equiv_fun, equiv_O_functor.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 591
Time: 0.006s">
<div class="time" style="width: 2.6905829596413%"></div>
<pre>
      transitivity (to O _
                       (equiv_hfiber_homotopic
                          (factor2 fact o factor1 fact)
                          (factor2 fact' o factor1 fact') H
                          (factor2 fact (factor1 fact a)) (a;1))).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 596
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 597
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (to_O_natural O _ _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 597
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 598
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 598
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        simpl.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 599
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
        apply ap; auto with path_hints.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 600
Time: 0.008s">
<div class="time" style="width: 3.5874439461883%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 601
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  End TwoFactorizations.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 603
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Theorem 7.6.6.  Recall that a lot of hard work was done in [Factorization.path_factorization]. *)
 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 606
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_factsys : FactorizationSystem.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 606
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 607
Time: 0.049s">
<div class="time" style="width: 21.973094170404%"></div>
<pre>
    refine (Build_FactorizationSystem
              (@IsConnMap O) _ _ _
              (@MapIn O) _ _ _
              (@image) _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 611
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A B f fact fact'.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 612
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simple refine (Build_PathFactorization fact fact' _ _ _ _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 613
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 614
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (_ oE equiv_fibration_replacement (factor2 fact)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 614
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine ((equiv_fibration_replacement (factor2 fact'))^-1 oE _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 615
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_functor_sigma_id; intros b; simpl.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 616
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_O_factor_hfibers.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 617
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 618
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre> intros a; exact (pr1_path (equiv_O_factor_hfibers_beta f fact fact' a)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 618
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 619
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 619
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
      exact ((equiv_O_factor_hfibers f fact fact' (factor2 fact x) (x ; 1)).2 ^).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 620
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 621
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 621
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
      apply moveR_pM.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 622
Time: 0.002s">
<div class="time" style="width: 0.89686098654709%"></div>
<pre>
      refine ((inv_V _)^ @ _ @ inv_V _); apply inverse2.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 623
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
      refine (_ @ pr2_path (equiv_O_factor_hfibers_beta f fact fact' a)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 624
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
      refine (_ @ (transport_paths_Fl _ _)^).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 625
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** Apparently Coq needs a little help to see that these paths are the same. *)
     </pre>
</div>
<div class="code" title="File: Modality.v
Line: 627
Time: 0.005s">
<div class="time" style="width: 2.2421524663677%"></div>
<pre>match goal with
          |- ((?p)^ @ ?q)^ = _ @ _ =&gt; change ((p^ @ q)^ = q^ @ p)
      end.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 629
Time: 0.003s">
<div class="time" style="width: 1.3452914798206%"></div>
<pre>
      refine (inv_pp _ _ @ (1 @@ inv_V _)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 630
Time: 0.045s">
<div class="time" style="width: 20.179372197309%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 631
Time: 0.023s">
<div class="time" style="width: 10.313901345291%"></div>
<pre>

End ModalFact.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 633
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End Modalities_Theory.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 635
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Restriction of a family of modalities *)

(** This is just like restriction of reflective subuniverses. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Type Modalities_Restriction_Data (Os : Modalities).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter New_Modality : Type2@{u a}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 641
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter Modalities_restriction
  : New_Modality -&gt; Os.Modality.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 644
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End Modalities_Restriction_Data.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 646
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

Module Modalities_Restriction
       (Os : Modalities)
       (Res : Modalities_Restriction_Data Os)
&lt;: Modalities.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 651
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Modality := Res.New_Modality.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 653
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_reflector (O : Modality@{u a})
    := Os.O_reflector@{u a i} (Res.Modalities_restriction O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 656
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition In (O : Modality@{u a})
    := Os.In@{u a i} (Res.Modalities_restriction O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 658
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition O_inO (O : Modality@{u a})
    := Os.O_inO@{u a i} (Res.Modalities_restriction O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 660
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition to (O : Modality@{u a})
    := Os.to@{u a i} (Res.Modalities_restriction O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 662
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inO_equiv_inO (O : Modality@{u a})
    := Os.inO_equiv_inO@{u a i j k} (Res.Modalities_restriction O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 664
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition hprop_inO (H : Funext) (O : Modality@{u a})
    := Os.hprop_inO@{u a i} H (Res.Modalities_restriction O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 666
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition O_ind_internal (O : Modality@{u a})
    := Os.O_ind_internal@{u a i j k} (Res.Modalities_restriction O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 668
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition O_ind_beta_internal (O : Modality@{u a})
    := Os.O_ind_beta_internal@{u a i j k} (Res.Modalities_restriction O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 670
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition minO_paths (O : Modality@{u a})
    := Os.minO_paths@{u a i} (Res.Modalities_restriction O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 672
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition IsSepFor@{u a} (O' O : Modality@{u a})
    := @Os.IsSepFor@{u a} (Res.Modalities_restriction@{u a} O') (Res.Modalities_restriction@{u a} O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 674
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inO_paths_from_inSepO@{u a i iplus} (O' O : Modality@{u a})
    := @Os.inO_paths_from_inSepO@{u a i iplus} (Res.Modalities_restriction@{u a} O') (Res.Modalities_restriction@{u a} O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 676
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inSepO_from_inO_paths@{u a i iplus} (O' O : Modality@{u a})
    := @Os.inSepO_from_inO_paths@{u a i iplus} (Res.Modalities_restriction@{u a} O') (Res.Modalities_restriction@{u a} O).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 678
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

End Modalities_Restriction.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 680
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Union of families of modalities *)

</pre>
</div>
<div class="code" title="File: Modality.v
Line: 683
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Modalities_FamUnion (Os1 Os2 : Modalities)
       &lt;: Modalities.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 684
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Modality : Type2@{u a}
    := Os1.Modality@{u a} + Os2.Modality@{u a}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 687
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Coercion Mod_inl := inl : Os1.Modality -&gt; Modality.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 689
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Coercion Mod_inr := inr : Os2.Modality -&gt; Modality.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 690
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_reflector : forall (O : Modality@{u a}),
                            Type2le@{i a} -&gt; Type2le@{i a}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 693
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 694
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.O_reflector@{u a i} O)
                  | exact (Os2.O_reflector@{u a i} O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 696
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 697
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition In : forall (O : Modality@{u a}),
                            Type2le@{i a} -&gt; Type2le@{i a}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 700
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 701
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.In@{u a i} O)
                  | exact (Os2.In@{u a i} O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 703
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 704
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_inO : forall (O : Modality@{u a}) (T : Type@{i}),
                               In@{u a i} O (O_reflector@{u a i} O T).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 707
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 708
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.O_inO@{u a i} O)
                  | exact (Os2.O_inO@{u a i} O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 710
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 711
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition to : forall (O : Modality@{u a}) (T : Type@{i}),
                   T -&gt; O_reflector@{u a i} O T.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 714
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 715
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.to@{u a i} O)
                  | exact (Os2.to@{u a i} O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 717
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 718
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition inO_equiv_inO :
      forall (O : Modality@{u a}) (T : Type@{i}) (U : Type@{j})
             (T_inO : In@{u a i} O T) (f : T -&gt; U) (feq : IsEquiv f),
        In@{u a j} O U.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 723
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 724
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.inO_equiv_inO@{u a i j k} O)
                  | exact (Os2.inO_equiv_inO@{u a i j k} O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 726
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 727
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition hprop_inO
  : Funext -&gt; forall (O : Modality@{u a}) (T : Type@{i}),
                IsHProp (In@{u a i} O T).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 731
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 732
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros ? [O|O]; [ exact (Os1.hprop_inO@{u a i} _ O)
                    | exact (Os2.hprop_inO@{u a i} _ O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 734
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 735
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_ind_internal
  : forall (O : Modality@{u a})
           (A : Type2le@{i a}) (B : O_reflector O A -&gt; Type2le@{j a})
           (B_inO : forall oa, In@{u a j} O (B oa)),
      (forall a, B (to O A a)) -&gt; forall a, B a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 741
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 742
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.O_ind_internal@{u a i j k} O)
                  | exact (Os2.O_ind_internal@{u a i j k} O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 744
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 745
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_ind_beta_internal
  : forall (O : Modality@{u a})
           (A : Type@{i}) (B : O_reflector O A -&gt; Type@{j})
           (B_inO : forall oa, In@{u a j} O (B oa))
           (f : forall a : A, B (to O A a)) (a:A),
      O_ind_internal@{u a i j k} O A B B_inO f (to O A a) = f a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 752
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 753
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.O_ind_beta_internal@{u a i j k} O)
                  | exact (Os2.O_ind_beta_internal@{u a i j k} O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 755
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 756
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition minO_paths
  : forall (O : Modality@{u a})
           (A : Type2le@{i a}) (A_inO : In@{u a i} O A) (z z' : A),
      In@{u a i} O (z = z').</pre>
</div>
<div class="code" title="File: Modality.v
Line: 761
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 762
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.minO_paths@{u a i} O)
                  | exact (Os2.minO_paths@{u a i} O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 764
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 765
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition IsSepFor@{u a}
    : forall (O' O : Modality@{u a}), Type@{u}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 768
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 769
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O'|O'] [O|O];
      [ exact (@Os1.IsSepFor@{u a} O' O)
      | exact Empty
      | exact Empty
      | exact (@Os2.IsSepFor@{u a} O' O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 774
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 775
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition inO_paths_from_inSepO@{u a i iplus}
    : forall (O' O : Modality@{u a}) (sep : IsSepFor O' O)
             (A : Type@{i}) (A_inO : In@{u a i} O' A) (x y : A),
      In@{u a i} O (x = y).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 780
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 781
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
    intros [O'|O'] [O|O];
      [ exact (@Os1.inO_paths_from_inSepO@{u a i iplus} O' O)
      | contradiction
      | contradiction
      | exact (@Os2.inO_paths_from_inSepO@{u a i iplus} O' O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 786
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 787
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition inSepO_from_inO_paths@{u a i iplus}
    : forall (O' O : Modality@{u a}) (sep : IsSepFor O' O)
             (A : Type@{i}),
      (forall (x y : A), In@{u a i} O (x = y)) -&gt; In@{u a i} O' A.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 792
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 793
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
    intros [O'|O'] [O|O];
      [ exact (@Os1.inSepO_from_inO_paths@{u a i iplus} O' O)
      | contradiction
      | contradiction
      | exact (@Os2.inSepO_from_inO_paths@{u a i iplus} O' O) ].</pre>
</div>
<div class="code" title="File: Modality.v
Line: 798
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 799
Time: 0.001s">
<div class="time" style="width: 0.44843049327354%"></div>
<pre>

End Modalities_FamUnion.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 802
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** For examples of modalities, see the files Notnot, Identity, Nullification, PropositionalFracture, and Localization. *)

</pre>
</div>
</body>
</html>

