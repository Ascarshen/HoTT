<html>
<head>
<title>ReflectiveSubuniverse.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for ReflectiveSubuniverse.v</h1>

<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0.033s">
<div class="time" style="width: 1.3048635824437%"></div>
<pre>Require Import HoTT.Basics HoTT.Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0.016s">
<div class="time" style="width: 0.63266113088177%"></div>
<pre>
Require Import UnivalenceImpliesFunext EquivalenceVarieties Extensions HProp Fibrations NullHomotopy Pullback.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
Require Import HoTT.Tactics PathAny.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 3
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
Require Import HIT.Coeq Colimits.Pushout.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Tactics.RewriteModuloAssociativity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** * Reflective Subuniverses *)

(** ** References  *)

(** Reflective subuniverses (and modalities) are studied in the following papers, which we will refer to below by their abbreviations:

- The Book: The Homotopy Type Theory Book, chapter 7.  Bare references to "Theorem 7.x.x" are always to the Book.
- RSS: Rijke, Spitters, and Shulman, "Modalities in homotopy type theory", https://arxiv.org/abs/1706.07526.
- CORS: Christensen, Opie, Rijke, and Scoccola, "Localization in Homotopy Type Theory", https://arxiv.org/abs/1807.04155.
*)

(** ** Overview *)

(** We will define reflective subuniverses using modules.  Since modules are one of the more difficult parts of Coq to understand, and the documentation in the reference manual is a bit sparse, we include here a brief introduction to modules.

For our purposes here, it is appropriate to think of a [Module Type] as analogous to a [Record] type, and a [Module] having that module type (called an "implementation" of it) as analogous to an element of that record type.  For instance, instead of

&lt;&lt;
Record foo :=
  { bar : Type ;
    baz : bar -&gt; Type
  }.
&gt;&gt;

we could write

&lt;&lt;
Module Type foo.
  Parameter bar : Type.
  Parameter baz : bar -&gt; Type
End foo.
&gt;&gt;

and then instead of

&lt;&lt;
Definition qux : foo
  := Build_foo Bool (fun b =&gt; if b then Unit else Empty).
&gt;&gt;

we could write

&lt;&lt;
Module qux &lt;: foo.
  Definition bar : Type
    := Bool.
  Definition baz : bar -&gt; Type
    := fun b =&gt; if b then Unit else Empty.
End qux.
&gt;&gt;

Given these definitions, where we refer to [bar qux] and [baz qux] in the record case, in the module case we would write [qux.bar] and [qux.baz].  However, there are a few essential differences (apart from these syntactic ones).

Firstly, while elements of records are (like everything else in Coq's type theory) strongly typed, modules are duck-typed.  In other words, [qux] is a module of type [foo] simply by virtue of containing fields [bar] and [baz] that have the same types as those declared for the parameters of [foo]; the type declaration [&lt;: foo] only serves to document and enforce this fact.

Secondly, modules do not have to be declared to have any type, or they can have more than one type.  A module is free to contain as many definitions (and other things such as notations, coercions, instances, etc.) as you like, and to "implement" as many module types as you like.  In particular, [qux] could contain additional definitions and it would still be of type [foo].

Thirdly, and more importantly, modules are *second-class*: you cannot pass them around as arguments to functions.  Nor can you construct them "on the fly"; they can only be defined at top level.  However, you can pass a module as an argument to *another module*.  For instance, here is a module which takes a module of type [foo] as an argument.

&lt;&lt;
Module htns (f : foo).
  Definition qjkx : Type
    := { x : f.bar &amp; f.baz x }.
End htns.
&gt;&gt;

Now if we have a [foo], such as [qux], we can pass it as an argument to [htns] and get a new module (again, only at top level):

&lt;&lt;
Module gcrl := htns qux.
&gt;&gt;

After this, we can refer to [gcrl.qjkx] and get [{ x : qux.bar &amp; qux.baz x }].  Together with the fact that modules don't need to have a type, this sort of gives us a way to pass a module as an argument to a collection of functions; we can define a module like [htns] which takes a [foo] as an argument and in which we define many functions depending on [foo]; then whenever we want to apply these functions to a [foo] (such as [qux]) we do the application at top-level, as above with [gcrl].

Unfortunately, Coq does not allow modules to take elements of ordinary types as arguments either; if you want to pass a [nat], say, as an argument to a module, you have to first wrap the [nat] in another module.  You can think of types and module-types as "parallel universes" of types; never the twain shall meet.

Given these annoying limitations, why would anyone ever use modules instead of records?  One reason is that modules are good at (indeed, are more or less designed for) *namespacing*.  In particular, it is possible to [Import] a module, so that all of its fields can be accessed without a dot-prefix.  In fact, every file in Coq is implicitly its own module, and when you say [Require Import Filename.] you are actually [Import]ing a module.  Similarly, modules are used for access control in the private-inductive-types hack that we use to define HITs that compute.

Another reason to use modules, which is the primary reason we choose to use them here, is that the fields of a module are *individually* universe polymorphic.  In other words, in order to define a module of type [foo], as above, you need to give a *polymorphic* definition of [bar] and a *polymorphic* definition of [baz], and the resulting module remembers the polymorphism of each of those fields.  By contrast, a definition of an element of a record type may be itself polymorphic, but an individual *instance* of that definition will pertain only to a fixed collection of universes.

Note that the possibility of individually polymorphic fields practically mandates that modules *must* be second-class.  For a polymorphic field involves an implicit quantification over all universes; hence if the record itself were a first-class object, what universe would it live in?  A mathematician can think of modules as analogous to the proper classes in NBG set theory: they can be "large" without impacting the consistency strength, *because* we are limited in what we can do with them.

In the case in point, if a reflective subuniverse were a record, then "a reflective subuniverse" would be a reflective subuniverse of only *one* universe.  A polymorphic definition of a particular reflective subuniverse would result in defining related reflective subuniverses of every universe, but the relation *between* these subuniverses would not be specified.  In particular, if we have types [X : Type@{i}] and [Y : Type@{j}] in different universes and a map [f : X -&gt; Y], while [Y] is in the subuniverse of [Type@{j}], we could not apply the universal property to extend [f] to a map [O X -&gt; Y], since the universal property asserted for [O@{i} X] would only refer to maps with target also in [Type@{i}].  This is at best annoying; for instance, it means that we couldn't define, say, [Trunc_functor] by using [O_functor] and then proceed to apply it to maps between types in different universes (which turns out to be necessary sometimes).  At worst, such as when trying to prove that the universe of modal types for a lex modalities is itself modal, this approach seems more or less unworkable.

Therefore, we choose to make a reflective subuniverse a module.  This means that in order to define "a reflective subuniverse", you have to give a *polymorphic* definition of the reflector, the universal property, etc.  In particular, the universal property must be polymorphic enough to allow the situation with [X : Type@{i}] and [Y : Type@{j}] considered above.

There are some issues involving this choice that must be addressed.  One of them is that when implementing a polymorphic module types, Coq is *very* strict about matching up the polymorphism.  Specifically, each [Definition] in the implementing module must have *exactly* the same number of universe parameters as the corresponding [Parameter] in the module type, and all the constraints in the former must be implied by those in the latter.  This ensures that the implementation is "at least as polymorphic" as the specification.

Now normally, a polymorphic definition will end up with many more universes than it needs, and we have little control over how many those are.  Therefore, in order to have a chance of ensuring that our implementations of module types match up in polymorphism, we almost always need to add explicit universe annotations in order to control how many universe parameters they end up with.  This is slightly annoying, but fortunately it only needs to be dealt with when *defining* a particular reflective subuniverse; to users the polymorphism should be invisible and automatic.

This also means it is important that we know exactly how many universe parameters each field of our module types is *expected* to take.  It would be nice if Coq had a feature for declaring (and verifying) the universe parameters of a definition in the same way that we declare the type parameters.  In the absence of this (requested at https://coq.inria.fr/bugs/show_bug.cgi?id=3818), we write [Check foo@{a b c}.] after the definition of [foo] to declare that [foo] takes three universe parameters.  Note that this will fail with an [Error] unless [foo] does in fact take exactly three universe parameters.

Another issue that must be dealt with is the fact, mentioned above, that a module cannot be parametrized over an ordinary type.  However, it frequently happens that we do want to define a family of reflective subuniverses, e.g. the n-truncation modalities for all [n : trunc_index], or the open and closed modalities for all [U : hProp].  The solution we choose is for our basic [Module Type] to represent not a *single* reflective subuniverse, but an entire *family* of them, parametrized by some type.  This can be regarded as analogous to how when doing mathematics relative to a base topos, the correct notion of "large category" is an *indexed category* (a.k.a. fibration), which comes with a basic notion of "[I]-indexed family of objects" for all [I] in the base topos.
*)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Type ReflectiveSubuniverses.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** As mentioned above, an implementation of this module type is a *family* of reflective subuniverses, indexed by the below type [ReflectiveSubuniverse].  If we just wrote [ReflectiveSubuniverse : Type], then it would end up parametrized by one universe, but in many examples the natural definition of the parametrizing type involves also a smaller universe, which would cause problems with Coq's strict polymorphism enforcement for module type implementations.  Thus, we use [Type2] instead, which takes two universe parameters. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter ReflectiveSubuniverse@{u a} : Type2@{u a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The universe parameters occurring in the definitions here play one of the following roles, which we indicate consistently by the same letters.

  - [u] is the size of the parametrizing type [ReflectiveSubuniverse] (and, later, also [Modality]).
  - [a] is the size of smaller type-data occurring in that type, such as the family of generators for a localization.  This generally must be strictly smaller than [u].
  - [i] is the size of a type that we are reflecting or testing to be in the subuniverse.  This is generally at least as big as [a].
  - [j] is the size of a type that we are eliminating into (out of a type in [i]) with a universal property.  Also generally at least as big as [a].
  - [k] is a universe at least as large as both [i] and [j], in which statements about types in both of them can live.
  - [iplus] is a universe that is strictly larger than [i]. *)

 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter O_reflector@{u a i} : forall (O : ReflectiveSubuniverse@{u a}),
                            Type2le@{i a} -&gt; Type2le@{i a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** For reflective subuniverses (and hence also modalities), it will turn out that [In O T] is equivalent to [IsEquiv (O_unit T)].  We could define the former as the latter, and it would simplify some of the general theory.  However, in many examples there is a "more basic" definition of [In O] which is equivalent, but not definitionally identical, to [IsEquiv (O_unit T)].  Thus, including [In O] as data makes more things turn out to be judgmentally what we would expect. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter In@{u a i} : forall (O : ReflectiveSubuniverse@{u a}),
                   Type2le@{i a} -&gt; Type2le@{i a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter O_inO@{u a i} : forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}),
                               In@{u a i} O (O_reflector@{u a i} O T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter to@{u a i} : forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}),
                   T -&gt; O_reflector@{u a i} O T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter inO_equiv_inO@{u a i j k} :
      forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}) (U : Type@{j})
             (T_inO : In@{u a i} O T) (f : T -&gt; U) (feq : IsEquiv f),
        (** We add an extra universe parameter that's at least as large as both [i] and [j].  This seems to be necessary for the proof of repleteness in some examples, such as easy modalities. *)
        let gei := ((fun x =&gt; x) : Type@{i} -&gt; Type@{k}) in
        let gej := ((fun x =&gt; x) : Type@{j} -&gt; Type@{k}) in
        In@{u a j} O U.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** In most examples, [Funext] is necessary to prove that the predicate of being in the subuniverse is an hprop.  To avoid needing to assume [Funext] as a global hypothesis when constructing such examples, and since [Funext] is often not needed for any of the rest of the theory, we add it as a hypothesis to this specific field. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter hprop_inO@{u a i}
  : Funext -&gt; forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}),
                IsHProp (In@{u a i} O T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We express the universal property using the representation [ooExtendableAlong] of precomposition equivalences.  This has the advantage that it avoids the funext redexes that otherwise infect the theory, thereby simplifying the proofs and proof terms.  We never have to worry about whether we have a path between functions or a homotopy; we use only homotopies, with no need for [ap10] or [path_arrow] to mediate.  Furthermore, the data in [ooExtendableAlong] are all special cases of the induction principle of a modality.  Thus, all the theorems we prove about reflective subuniverses will, when interpreted for a modality (coerced as above to a reflective subuniverse), reduce definitionally to "the way we would have proved them directly for a modality".  *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter extendable_to_O@{u a i j k}
  : forall (O : ReflectiveSubuniverse@{u a}) {P : Type2le@{i a}} {Q : Type2le@{j a}} {Q_inO : In@{u a j} O Q},
      ooExtendableAlong@{i i j k} (to O P) (fun _ =&gt; Q).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** As defined in CORS, for a reflective subuniverse [O], the [O]-separated types are those whose identity types are in [O].  These form another reflective subuniverse [O'], but in general it might not be in the same family.  Thus, instead of considering [O] -&gt; [O'] as an operation on reflective subuniverses, we consider it a relation between them; [IsSepFor O' O] says that [O'] is the [O]-separated subuniverse.  In addition, we can't just *define* this relation to say that the types in [O'] are the [O]-separated ones, because we want that to be true universe-polymorphically.  Thus, we assert the relation [IsSepFor] as part of the data of a family of reflective subuniverses, along with two more parameters saying that the types in [O'] are the [O]-separated ones at all universe levels.  *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter IsSepFor@{u a} : forall (O' O : ReflectiveSubuniverse@{u a}), Type@{u}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** These two have an extra universe parameter [iplus] that's strictly bigger than [i], because our current proofs of them in the case of localization seem to produce such a universe.  (It's unclear how necessary that is.) *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter inO_paths_from_inSepO@{u a i iplus}
    : forall (O' O : ReflectiveSubuniverse@{u a}) (sep : IsSepFor O' O)
             (A : Type@{i}) (A_inO : In@{u a i} O' A) (x y : A),
      let gt := (Type1@{i} : Type@{iplus}) in
      In@{u a i} O (x = y).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter inSepO_from_inO_paths@{u a i iplus}
    : forall (O' O : ReflectiveSubuniverse@{u a}) (sep : IsSepFor O' O)
             (A : Type@{i}),
      let gt := (Type1@{i} : Type@{iplus}) in
      (forall (x y : A), In@{u a i} O (x = y)) -&gt; In@{u a i} O' A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End ReflectiveSubuniverses.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** We now begin a parametrized module to incorporate most of the theory of reflective subuniverses.  Thus, after defining a particular family of reflective subuniverses, you can apply this module and [Import] it to get all of the theory.  (Some suggested naming conventions for these modules can be found in Modality.v.)  *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module ReflectiveSubuniverses_Theory (Os : ReflectiveSubuniverses).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Export Os.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Membership in the subuniverse is a typeclass. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Existing Class In.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The type of types in the subuniverse *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Type_@{u a j i} (O : ReflectiveSubuniverse@{u a}) : Type@{j}
  := @sig@{j i} Type@{i} (fun (T : Type@{i}) =&gt; In@{u a i} O T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 175
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Before going on, we declare some coercions in a module, so that they can be imported separately.  In fact, this submodule should be exported by any file that defines a reflective subuniverse.  *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Export Coercions.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We allow the name of a subuniverse or modality to be used as the name of its reflector.  This means that when defining a particular example, you should generally put the parametrizing family in a wrapper, so that you can notate the subuniverse as parametrized by, rather than identical to, its parameter.  See Modality.v, Truncations.v, and Localization.v for examples. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Coercion O_reflector : ReflectiveSubuniverse &gt;-&gt; Funclass.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Obviously, every element of [Type_ O] is a type. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Coercion TypeO_pr1 O (T : Type_ O) := @pr1 Type (In O) T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End Coercions.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We assumed repleteness of the subuniverse in the definition.  Of course, with univalence this would be automatic, but we include it as a hypothesis since most of the theory of reflective subuniverses and modalities doesn't need univalence, and most or all examples can be shown to be replete without using univalence. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Arguments inO_equiv_inO {O} T {U} {_} f {_}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Being in the subuniverse is a mere predicate (by hypothesis) *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Existing Instance hprop_inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** [O T] is always in the subuniverse (by hypothesis).  This needs a universe annotation to become sufficiently polymorphic. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Arguments O_inO {O} T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Global Existing Instance O_inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Existing Class IsSepFor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Global Existing Instance inO_paths_from_inSepO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The second component of [TypeO] is unique.  Without a universe annotation, for some reason this collapses [j=u] and [i=a]. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 197
Time: 0.005s">
<div class="time" style="width: 0.19770660340055%"></div>
<pre>Definition path_TypeO@{u a j i} {fs : Funext} O (T T' : Type_@{u a j i} O) (p : T.1 = T'.1)
  : T = T'
  := path_sigma_hprop T T' p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 199
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>

Definition equiv_path_TypeO@{u a j i} {fs : Funext} O (T T' : Type_@{u a j i} O)
: (paths@{j} T.1 T'.1) &lt;~&gt; (T = T')
:= equiv_path_sigma_hprop@{j i j j} T T'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Types in [TypeO] are always in [O]. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_TypeO {O : ReflectiveSubuniverse} (A : Type_ O)
: In O A
:= A.2.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 207
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

Definition extendable_to_O (O : ReflectiveSubuniverse)
           {P Q : Type} {Q_inO : In O Q}
: ooExtendableAlong (to O P) (fun _ =&gt; Q)
  := @extendable_to_O O P Q Q_inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We now extract the recursion principle and the restricted induction principles for paths. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section ORecursion.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {O : ReflectiveSubuniverse}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 215
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

  Definition O_rec {P Q : Type} {Q_inO : In O Q}
             (f : P -&gt; Q)
  : O P -&gt; Q
  := (fst (extendable_to_O O 1%nat) f).1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 220
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>

  Definition O_rec_beta {P Q : Type} {Q_inO : In O Q}
             (f : P -&gt; Q) (x : P)
  : O_rec f (to O P x) = f x
  := (fst (extendable_to_O O 1%nat) f).2 x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 225
Time: 0.005s">
<div class="time" style="width: 0.19770660340055%"></div>
<pre>

  Definition O_indpaths {P Q : Type} {Q_inO : In O Q}
             (g h : O P -&gt; Q) (p : g o to O P == h o to O P)
  : g == h
  := (fst (snd (extendable_to_O O 2) g h) p).1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 230
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>

  Definition O_indpaths_beta {P Q : Type} {Q_inO : In O Q}
             (g h : O P -&gt; Q) (p : g o (to O P) == h o (to O P)) (x : P)
  : O_indpaths g h p (to O P x) = p x
  := (fst (snd (extendable_to_O O 2) g h) p).2 x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 235
Time: 0.008s">
<div class="time" style="width: 0.31633056544089%"></div>
<pre>

  Definition O_ind2paths {P Q : Type} {Q_inO : In O Q}
             {g h : O P -&gt; Q} (p q : g == h)
             (r : p oD (to O P) == q oD (to O P))
  : p == q
  := (fst (snd (snd (extendable_to_O O 3) g h) p q) r).1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 241
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>

  Definition O_ind2paths_beta {P Q : Type} {Q_inO : In O Q}
             {g h : O P -&gt; Q} (p q : g == h)
             (r : p oD (to O P) == q oD (to O P)) (x : P)
  : O_ind2paths p q r (to O P x) = r x
  := (fst (snd (snd (extendable_to_O O 3) g h) p q) r).2 x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Clearly we can continue indefinitely as needed. *)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 250
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>End ORecursion.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* We never want to see [extendable_to_O]. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Arguments O_rec : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments O_rec_beta : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 253
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments O_indpaths : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments O_indpaths_beta : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments O_ind2paths : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments O_ind2paths_beta : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 257
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Given [Funext], we prove the definition of reflective subuniverse in the book. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 259
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>Global Instance isequiv_o_to_O `{Funext}
       (O : ReflectiveSubuniverse) (P Q : Type) `{In O Q}
: IsEquiv (fun g : O P -&gt; Q =&gt; g o to O P)
:= isequiv_ooextendable _ _ (extendable_to_O O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 262
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>

Definition equiv_o_to_O `{Funext}
           (O : ReflectiveSubuniverse) (P Q : Type) `{In O Q}
: (O P -&gt; Q) &lt;~&gt; (P -&gt; Q)
:= Build_Equiv _ _ (fun g : O P -&gt; Q =&gt; g o to O P) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Properties of Reflective Subuniverses *)

(** We now prove a bunch of things about an arbitrary reflective subuniverse. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 271
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Reflective_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 271
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Universes Ou Oa.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context (O : ReflectiveSubuniverse@{Ou Oa}).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 273
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Functoriality of [O_rec] homotopies *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 276
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition O_rec_homotopy {P Q : Type} `{In O Q} (f g : P -&gt; Q) (pi : f == g)
  : O_rec f == O_rec g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 277
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 278
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    apply O_indpaths; intro x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 279
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    etransitivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 282
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> etransitivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (pi _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 284
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> symmetry; apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 284
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** If [T] is in the subuniverse, then [to O T] is an equivalence. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 288
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition isequiv_to_O_inO@{u a i} (T : Type@{i}) `{In@{u a i} O T} : IsEquiv@{i i} (to O T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 288
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** Using universe annotations to reduce superfluous universes *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>pose (g := O_rec@{u a i i i i i} idmap).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (isequiv_adjointify (to O T) g _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 292
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 293
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> refine (O_indpaths@{u a i i i i i} (to O T o g) idmap _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 294
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 295
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 296
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 298
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Global Existing Instance isequiv_to_O_inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 300
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

  Definition equiv_to_O (T : Type) `{In O T} : T &lt;~&gt; O T
    := Build_Equiv T (O T) (to O T) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 303
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** In this section, we see that [O] is a functor. *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 309
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition O_functor {A B : Type} (f : A -&gt; B) : O A -&gt; O B
      := O_rec (to O B o f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Naturality of [to O] *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 313
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>Definition to_O_natural {A B : Type} (f : A -&gt; B)
    : (O_functor f) o (to O A) == (to O B) o f
    := (O_rec_beta _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality on composition *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 318
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>Definition O_functor_compose {A B C : Type} (f : A -&gt; B) (g : B -&gt; C)
    : (O_functor (g o f)) == (O_functor g) o (O_functor f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 319
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 320
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      apply O_indpaths; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 321
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      refine (to_O_natural (g o f) x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 322
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      transitivity (O_functor g (to O B (f x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 323
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 324
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 324
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (to_O_natural g (f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 324
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap; symmetry.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (to_O_natural f x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 326
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 327
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality on homotopies (2-functoriality) *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_functor_homotopy {A B : Type} (f g : A -&gt; B) (pi : f == g)
    : O_functor f == O_functor g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 332
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (O_indpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (to_O_natural f x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ @ (to_O_natural g x)^).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ap, pi.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 336
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality for inverses of homotopies *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 340
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition O_functor_homotopy_V
               {A B : Type} (f g : A -&gt; B) (pi : f == g)
    : O_functor_homotopy g f (fun x =&gt; (pi x)^)
      == fun x =&gt; (O_functor_homotopy f g pi x)^.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 344
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      refine (O_ind2paths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 345
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold composeD, O_functor_homotopy.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 346
Time: 0.035s">
<div class="time" style="width: 1.3839462238039%"></div>
<pre>
      rewrite !O_indpaths_beta, !ap_V, !inv_pp, inv_V, !concat_p_pp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 347
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 348
Time: 0.017s">
<div class="time" style="width: 0.67220245156188%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 349
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Hence functoriality on commutative squares *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 352
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>Definition O_functor_square {A B C X : Type} (pi1 : X -&gt; A) (pi2 : X -&gt; B)
               (f : A -&gt; C) (g : B -&gt; C) (comm : (f o pi1) == (g o pi2))
    : ( (O_functor f) o (O_functor pi1) )
      == ( (O_functor g) o (O_functor pi2) ).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 355
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 356
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 357
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      transitivity (O_functor (f o pi1) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 358
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 359
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre> symmetry; erapply O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 359
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 360
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> transitivity (O_functor (g o pi2) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 360
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 361
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_homotopy, comm.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 361
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 362
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> erapply O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 362
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 363
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality on identities *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_functor_idmap (A : Type)
    : @O_functor A A idmap == idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 367
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 368
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (O_indpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 369
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 370
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 371
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** 3-functoriality, as an example use of [O_ind2paths] *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 374
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition O_functor_2homotopy {A B : Type} {f g : A -&gt; B}
               (p q : f == g) (r : p == q)
    : O_functor_homotopy f g p == O_functor_homotopy f g q.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 377
Time: 0.02s">
<div class="time" style="width: 0.79082641360221%"></div>
<pre>
      refine (O_ind2paths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 378
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_functor_homotopy, composeD.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 379
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>
      do 2 rewrite O_indpaths_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 380
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      apply whiskerL, whiskerR, ap, r.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 381
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** Of course, if we wanted to prove 4-functoriality, we'd need to make this transparent. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 383
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 383
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** 2-naturality: Functoriality on homotopies is also natural *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 386
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>Definition O_functor_homotopy_beta
               {A B : Type} (f g : A -&gt; B) (pi : f == g) (x : A)
    : O_functor_homotopy f g pi (to O A x)
      = to_O_natural f x
      @ ap (to O B) (pi x)
      @ (to_O_natural g x)^.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 391
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 392
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_functor_homotopy, to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 393
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      refine (O_indpaths_beta _ _ _ x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 394
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (concat_p_pp _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 395
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 396
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The pointed endofunctor ([O],[to O]) is well-pointed *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 399
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_functor_wellpointed (A : Type)
    : O_functor (to O A) == to O (O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 401
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (O_indpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 403
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 404
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** "Functoriality of naturality": the pseudonaturality axiom for composition *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 407
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>Definition to_O_natural_compose {A B C : Type}
               (f : A -&gt; B) (g : B -&gt; C) (a : A)
    : ap (O_functor g) (to_O_natural f a)
      @ to_O_natural g (f a)
      = (O_functor_compose f g (to O A a))^
      @ to_O_natural (g o f) a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 412
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 413
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_functor_compose, to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 414
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
      rewrite O_indpaths_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 415
Time: 0.033s">
<div class="time" style="width: 1.3048635824437%"></div>
<pre>
      rewrite !inv_pp, ap_V, !inv_V, !concat_pp_p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 416
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>
      rewrite concat_Vp, concat_p1; reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 417
Time: 0.026s">
<div class="time" style="width: 1.0280743376829%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 418
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The pseudofunctoriality axiom *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 421
Time: 0.005s">
<div class="time" style="width: 0.19770660340055%"></div>
<pre>Definition O_functor_compose_compose
               {A B C D : Type} (f : A -&gt; B) (g : B -&gt; C) (h : C -&gt; D)
               (a : O A)
    : O_functor_compose f (h o g) a
      @ O_functor_compose g h (O_functor f a)
      = O_functor_compose (g o f) h a
        @ ap (O_functor h) (O_functor_compose f g a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 428
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      revert a; refine (O_ind2paths _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 429
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      intros a; unfold composeD, O_functor_compose; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 430
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Open Scope long_path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 431
Time: 0.153s">
<div class="time" style="width: 6.0498220640569%"></div>
<pre>
      rewrite !O_indpaths_beta, !ap_pp, !ap_V, !concat_p_pp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 432
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      refine (whiskerL _ (apD _ (to_O_natural f a)^)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 433
Time: 0.01s">
<div class="time" style="width: 0.39541320680111%"></div>
<pre>
      rewrite O_indpaths_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 434
Time: 0.061s">
<div class="time" style="width: 2.4120205614868%"></div>
<pre>
      rewrite transport_paths_FlFr, !concat_p_pp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 435
Time: 0.053s">
<div class="time" style="width: 2.0956899960459%"></div>
<pre>
      rewrite !ap_V, inv_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 436
Time: 0.04s">
<div class="time" style="width: 1.5816528272044%"></div>
<pre>
      rewrite !concat_pV_p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 437
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      apply whiskerL.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 438
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply inverse2.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 438
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ap_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 439
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Close Scope long_path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre></pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite !O_indpaths_beta, !ap_pp, !ap_V, !concat_p_pp.
      refine (whiskerL _ (apD _ (to_O_natural f a)^)^ @ _).
      rewrite O_indpaths_beta.
      rewrite transport_paths_FlFr, !concat_p_pp.
      rewrite !ap_V, inv_V.
      rewrite !concat_pV_p.
      apply whiskerL. apply inverse2.
      apply ap_compose.
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 449
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Close Scope long_path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 449
Time: 0.177s">
<div class="time" style="width: 6.9988137603796%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Preservation of equivalences *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isequiv_O_functor {A B : Type} (f : A -&gt; B) `{IsEquiv _ _ f}
    : IsEquiv (O_functor f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 454
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 455
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (isequiv_adjointify (O_functor f) (O_functor f^-1) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 456
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 457
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 457
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine ((O_functor_compose _ _ x)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 458
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine (O_functor_homotopy _ idmap _ x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 459
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 460
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros y; apply eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 460
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 461
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 461
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 462
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 462
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine ((O_functor_compose _ _ x)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 463
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine (O_functor_homotopy _ idmap _ x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 464
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 465
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros y; apply eissect.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 465
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 466
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 466
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 467
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>

    Definition equiv_O_functor {A B : Type} (f : A &lt;~&gt; B)
    : O A &lt;~&gt; O B
    := Build_Equiv _ _ (O_functor f) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 471
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** This is sometimes useful to have a separate name for, to facilitate rewriting along it. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 474
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>Definition to_O_equiv_natural {A B} (f : A &lt;~&gt; B)
    : (equiv_O_functor f) o (to O A) == (to O B) o f
    := to_O_natural f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 476
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** This corresponds to [ap O] on the universe. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 479
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition ap_O_path_universe' `{Univalence}
               {A B : Type} (f : A &lt;~&gt; B)
    : ap O (path_universe_uncurried f)
      = path_universe_uncurried (equiv_O_functor f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 482
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 483
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      revert f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 484
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      equiv_intro (equiv_path A B) p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 485
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap (ap O) (eta_path_universe p) @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 486
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      destruct p; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 487
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply moveL_equiv_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 488
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      apply path_equiv, path_arrow, O_indpaths; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 489
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      symmetry; apply to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 490
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 491
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>

    Definition ap_O_path_universe `{Univalence}
               {A B : Type} (f : A -&gt; B) `{IsEquiv _ _ f}
    : ap O (path_universe f) = path_universe (O_functor f)
    := ap_O_path_universe' (Build_Equiv _ _ f _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Postcomposition respects [O_rec] *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 499
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>Definition O_rec_postcompose {A B C : Type} `{In O B} {C_inO : In O C}
               (f : A -&gt; B) (g : B -&gt; C)
    : g o O_rec f == O_rec (g o f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 501
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (O_indpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      transitivity (g (f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 504
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 505
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 505
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 505
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 506
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 506
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_rec_beta (g o f) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 506
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 507
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

  End Functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 509
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Replete.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 511
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

    Definition inO_equiv_inO'@{i j k} (T : Type@{i}) {U : Type@{j}} `{In@{Ou Oa i} O T} (f : T &lt;~&gt; U)
    : In@{Ou Oa j} O U
      := inO_equiv_inO@{Ou Oa i j k} T f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 515
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** An equivalent formulation of repleteness is that a type lies in the subuniverse as soon as its unit map is an equivalence. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 518
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>Definition inO_isequiv_to_O (T:Type)
    : IsEquiv (to O T) -&gt; In O T
    := fun _ =&gt; inO_equiv_inO (O T) (to O T)^-1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 520
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (* We don't make this an ordinary instance, but we allow it to solve [In O] constraints if we already have [IsEquiv] as a hypothesis.  *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 523
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Hint Immediate inO_isequiv_to_O : typeclass_instances.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 523
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition inO_iff_isequiv_to_O (T:Type)
    : In O T &lt;-&gt; IsEquiv (to O T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 526
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 527
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
      split; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 528
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 529
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Thus, [T] is in a subuniverse as soon as [to O T] admits a retraction. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 532
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition inO_to_O_retract@{i | Oa &lt;= i} (T:Type@{i}) (mu : O T -&gt; T)
    : Sect (to O T) mu -&gt; In O T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 533
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 534
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold Sect; intros H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 535
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_isequiv_to_O.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 536
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply isequiv_adjointify with (g:=mu).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 537
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 538
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> refine (O_indpaths (to O T o mu) idmap _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 538
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        intros x; exact (ap (to O T) (H x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 539
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 540
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 540
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 541
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  End Replete.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 543
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section OInverts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 545
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The maps that are inverted by the reflector.  Note that this notation is NOT GLOBAL, it only exists in this section. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 548
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Notation O_inverts f := (IsEquiv (O_functor f)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 548
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance O_inverts_O_unit (A : Type)
    : O_inverts (to O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 551
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 552
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>
      refine (isequiv_homotopic (to O (O A)) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 553
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x; symmetry; apply O_functor_wellpointed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 554
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 555
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** A map between modal types that is inverted by [O] is already an equivalence.  This can't be an [Instance], probably because it causes an infinite regress applying more and more [O_functor]. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 558
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition isequiv_O_inverts {A B : Type} `{In O A} `{In O B}
      (f : A -&gt; B) `{O_inverts f}
    : IsEquiv f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 560
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 561
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
      refine (isequiv_commsq' f (O_functor f) (to O A) (to O B) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 562
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 563
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 564
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Strangely, even this seems to cause infinite loops *)
    (** [Hint Immediate isequiv_O_inverts : typeclass_instances.] *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 569
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition equiv_O_inverts {A B : Type} `{In O A} `{In O B}
      (f : A -&gt; B) `{O_inverts f}
    : A &lt;~&gt; B
    := Build_Equiv _ _ f (isequiv_O_inverts f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 572
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

    Definition isequiv_O_rec_O_inverts
           {A B : Type} `{In O B} (f : A -&gt; B) `{O_inverts f}
    : IsEquiv (O_rec f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 576
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 577
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply isequiv_O_inverts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 578
Time: 0.058s">
<div class="time" style="width: 2.2933965994464%"></div>
<pre>
      refine (cancelR_isequiv (O_functor (to O A))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 579
Time: 0.048s">
<div class="time" style="width: 1.8979833926453%"></div>
<pre>
      refine (isequiv_homotopic (O_functor (O_rec f o to O A))
                                (O_functor_compose _ _)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 581
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      refine (isequiv_homotopic (O_functor f)
               (O_functor_homotopy _ _ (fun x =&gt; (O_rec_beta f x)^))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 583
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 584
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** If a map is inverted by the representable functor [? -&gt; Z] for all [O]-modal types [Z], then it is inverted by [O].  First we prove a version that doesn't require funext. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 587
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_inverts_by_yoneda' {A : Type@{i}} {B : Type@{j}} (f : A -&gt; B)
               (** Without the universe annotations, the result ends up insufficiently polymorphic. *)
               (e : forall (Z:Type@{k}), In O Z -&gt; ExtendableAlong@{i j k l} 2 f (fun _ =&gt; Z))
      : O_inverts f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 590
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 591
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      serapply isequiv_adjointify.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 592
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 593
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> exact (O_rec (fst (e (O A) _) (to O A)).1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 593
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 594
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre> serapply O_indpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 594
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 594
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 595
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        assert (e1 := fun h k =&gt; fst (snd (e (O B) _) h k)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 596
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn in e1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 596
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        refine ((e1 (fun y =&gt; O_functor f ((fst (e (O A) _) (to O A)).1 y)) (to O B) _).1 b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 597
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 598
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
        rewrite ((fst (e (O A) (O_inO A)) (to O A)).2 a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 599
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 600
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 601
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre> serapply O_indpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 601
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 601
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
        rewrite to_O_natural, O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 602
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact ((fst (e (O A) (O_inO A)) (to O A)).2 a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 603
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 604
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** And the version with funext.  Use it with universe parameters [i j k l lplus l l l l]. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 607
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition O_inverts_by_yoneda `{Funext}
               {A : Type@{i}} {B : Type@{j}} (f : A -&gt; B)
               (e : forall (Z:Type@{k}), In@{Ou Oa k} O Z -&gt;
                                         IsEquiv@{l l} (fun g:B-&gt;Z =&gt; g o f))
      : O_inverts f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 611
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 612
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply O_inverts_by_yoneda'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 613
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros Z ?.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 614
Time: 0.094s">
<div class="time" style="width: 3.7168841439304%"></div>
<pre>
      apply (equiv_extendable_isequiv 0 _ _)^-1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 615
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rapply e.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 616
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 617
Time: 0.005s">
<div class="time" style="width: 0.19770660340055%"></div>
<pre>

    Definition to_O_inv_natural {A B : Type} `{In O A} `{In O B}
               (f : A -&gt; B)
    : (to O B)^-1 o (O_functor f) == f o (to O A)^-1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 621
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 622
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (O_indpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 623
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply moveR_equiv_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 624
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (to_O_natural f x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 625
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      do 2 apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 626
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      symmetry; apply eissect.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 627
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 628
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Two maps between modal types that become equal after applying [O_functor] are already equal. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 631
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition O_functor_faithful_inO {A B : Type} `{In O A} `{In O B}
      (f g : A -&gt; B) (e : O_functor f == O_functor g)
      : f == g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 633
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 634
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 635
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      refine (ap f (eissect (to O A) x)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 636
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      refine (_ @ ap g (eissect (to O A) x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 637
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
      transitivity ((to O B)^-1 (O_functor f (to O A x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 638
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 639
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> symmetry; apply to_O_inv_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 640
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre> transitivity ((to O B)^-1 (O_functor g (to O A x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 640
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 641
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap, e.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 641
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 642
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply to_O_inv_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 642
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 643
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Any map to a type in the subuniverse that is inverted by [O] must be equivalent to [to O].  More precisely, the type of such maps is contractible. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 646
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition typeof_to_O (A : Type)
      := { OA : Type &amp; { Ou : A -&gt; OA &amp; ((In O OA) * (O_inverts Ou)) }}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 647
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance contr_typeof_O_unit `{Univalence} (A : Type)
    : Contr (typeof_to_O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 650
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 651
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      exists (O A ; (to O A ; (_ , _))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 652
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
      intros [OA [Ou [? ?]]].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 653
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (f := O_rec Ou : O A -&gt; OA).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 654
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      pose (g := (O_functor Ou)^-1 o to O OA : (OA -&gt; O A)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 655
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      assert (IsEquiv f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 656
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 657
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (isequiv_adjointify f g _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 657
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 658
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_faithful_inO; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 658
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          rewrite O_functor_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 659
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
          rewrite O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 660
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 661
Time: 0.008s">
<div class="time" style="width: 0.31633056544089%"></div>
<pre>
          rewrite (O_functor_compose (to O OA) (O_functor Ou)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 662
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
          rewrite O_functor_wellpointed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 663
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
          rewrite (to_O_natural (O_functor Ou)^-1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 664
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          refine (to_O_natural f _ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 665
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          set (y := (O_functor Ou)^-1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 666
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
          transitivity (O_functor Ou y); try apply eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 667
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold f, O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 668
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply O_rec_postcompose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 669
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 670
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> refine (O_indpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 670
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 671
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
          rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 672
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 672
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply moveR_equiv_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 673
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
          symmetry; apply to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 674
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 675
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      simple refine (path_sigma _ _ _ _ _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 676
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 677
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (path_universe f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 677
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 678
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre> rewrite transport_sigma.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 678
Time: 0.047s">
<div class="time" style="width: 1.8584420719652%"></div>
<pre>
        simple refine (path_sigma _ _ _ _ _); cbn; try apply path_ishprop.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 679
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply path_arrow; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 680
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        rewrite transport_arrow_fromconst.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 681
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        rewrite transport_path_universe.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 682
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold f; apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 683
Time: 0.02s">
<div class="time" style="width: 0.79082641360221%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 684
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>

  End OInverts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 686
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 688
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** The [Unit] type *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 691
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_unit : In O Unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 691
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 692
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_to_O_retract with (mu := fun x =&gt; tt).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 693
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (@contr Unit _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 694
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 695
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** It follows that any contractible type is in [O]. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 698
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_contr {A : Type} `{Contr A} : In O A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 698
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 699
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      exact (inO_equiv_inO Unit equiv_contr_unit^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 700
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 701
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** And that the reflection of a contractible type is still contractible. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 704
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance contr_O_contr {A : Type} `{Contr A} : Contr (O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 704
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 705
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      exact (contr_equiv A (to O A)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 706
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 707
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Dependent product and arrows *)
    (** Theorem 7.7.2 *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 711
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_forall {fs : Funext} (A:Type) (B:A -&gt; Type)
    : (forall x, (In O (B x)))
      -&gt; (In O (forall x:A, (B x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 713
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 714
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 715
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (ev := fun x =&gt; (fun (f:(forall x, (B x))) =&gt; f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 716
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (zz := fun x:A =&gt; O_rec (ev x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 717
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_to_O_retract with (mu := fun z =&gt; fun x =&gt; zz x z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 718
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro phi.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 719
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold zz, ev; clear zz; clear ev.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 720
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_forall; intro x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 721
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (O_rec_beta (fun f : forall x0, (B x0) =&gt; f x) phi).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 722
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 723
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance inO_arrow {fs : Funext} (A B : Type) `{In O B}
    : In O (A -&gt; B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 726
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 727
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_forall.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 728
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 729
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 729
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 730
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Product *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 733
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_prod (A B : Type) `{In O A} `{In O B}
    : In O (A*B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 734
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 735
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      apply inO_to_O_retract with
        (mu := fun X =&gt; (@O_rec _ (A * B) A _ fst X , O_rec snd X)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 737
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros [a b]; apply path_prod; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 738
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 739
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_rec_beta fst (a,b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 739
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 740
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_rec_beta snd (a,b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 740
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 741
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** We show that [OA*OB] has the same universal property as [O(A*B)] *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 745
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition equiv_O_prod_unit_precompose
               {fs : Funext} (A B C : Type) `{In O C}
    : ((O A) * (O B) -&gt; C) &lt;~&gt; (A * B -&gt; C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 747
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 748
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (equiv_uncurry A B C oE _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 749
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ oE (equiv_uncurry (O A) (O B) C)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 750
Time: 0.007s">
<div class="time" style="width: 0.27678924476078%"></div>
<pre>
      refine (equiv_o_to_O _ A (B -&gt; C) oE _); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 751
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_postcompose'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 752
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (equiv_o_to_O _ B C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 753
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 754
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The preceding equivalence turns out to be actually (judgmentally!) precomposition with the following function. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 757
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_prod_unit (A B : Type) : A * B -&gt; O A * O B
      := functor_prod (to O A) (to O B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 758
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** From this, we can define the comparison map for products, and show that precomposing with it is also an equivalence. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 761
Time: 0.01s">
<div class="time" style="width: 0.39541320680111%"></div>
<pre>Definition O_prod_cmp (A B : Type) : O (A * B) -&gt; O A * O B
      := O_rec (O_prod_unit A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 762
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance isequiv_O_prod_cmp (A B : Type)
    : IsEquiv (O_prod_cmp A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 765
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 766
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simple refine (isequiv_adjointify _ _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 767
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 768
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply prod_ind; intro a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 768
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply O_rec; intro b; revert a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 769
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply O_rec; intro a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 770
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply (to O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 771
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (a, b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 772
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 772
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 773
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold prod_ind, O_prod_cmp, O_prod_unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 773
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        intros [oa ob].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 774
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>
        revert ob; refine (O_indpaths _ _ _); intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 775
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>
        revert oa; refine (O_indpaths _ _ _); intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 776
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 777
Time: 0.012s">
<div class="time" style="width: 0.47449584816133%"></div>
<pre> abstract (repeat rewrite O_rec_beta; reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 777
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 777
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 778
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold prod_ind, O_prod_cmp, O_prod_unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 778
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
        refine (O_indpaths _ _ _); intros [a b]; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 779
Time: 0.011s">
<div class="time" style="width: 0.43495452748122%"></div>
<pre>
        abstract (repeat (rewrite O_rec_beta; cbn); reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 780
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 780
Time: 0.007s">
<div class="time" style="width: 0.27678924476078%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 781
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

    Definition isequiv_O_prod_cmp_precompose
      {fs : Funext} (A B C : Type) {C_inO : In O C}
    : IsEquiv (fun h : O A * O B -&gt; C =&gt; h o O_prod_cmp A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 785
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 786
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      apply isequiv_precompose; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 787
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 788
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

    Definition equiv_O_prod_cmp (A B : Type)
    : O (A * B) &lt;~&gt; (O A * O B)
    := Build_Equiv _ _ (O_prod_cmp A B) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 792
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Pullbacks *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 796
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Global Instance inO_pullback {A B C} (f : B -&gt; A) (g : C -&gt; A)
           `{In O A} `{In O B} `{In O C}
      : In O (Pullback f g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 798
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 799
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      serapply inO_to_O_retract.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 800
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 801
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros op.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 801
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exists (O_rec pr1 op).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 802
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        exists (O_rec (fun p =&gt; p.2.1) op).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 803
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
        revert op; apply O_indpaths; intros [b [c a]].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 804
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        refine (ap f (O_rec_beta _ _) @ _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 805
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        refine (a @ ap g (O_rec_beta _ _)^).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 806
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 807
Time: 0.012s">
<div class="time" style="width: 0.47449584816133%"></div>
<pre> intros [b [c a]]; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 807
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>
        serapply path_sigma'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 808
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 809
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 809
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 809
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
        refine (transport_sigma' _ _ @ _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 810
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>
        serapply path_sigma'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 811
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 812
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 812
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 812
Time: 0.09s">
<div class="time" style="width: 3.55871886121%"></div>
<pre>
        abstract (
          rewrite transport_paths_Fr;
          rewrite transport_paths_Fl;
          rewrite O_indpaths_beta;
          rewrite concat_V_pp;
          rewrite ap_V;
          apply concat_pV_p ).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 819
Time: 0.053s">
<div class="time" style="width: 2.0956899960459%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 820
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Dependent sums *)
    (** Theorem 7.7.4, (ii) =&gt; (i) *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 824
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition inO_sigma_from_O_ind@{i j}
    : (forall (A:Type@{i}) (B: O_reflector@{Ou Oa i} O A -&gt; Type@{j}) `{forall a, In@{Ou Oa j} O (B a)}
              (g : forall (a:A), (B (to@{Ou Oa i} O A a))),
         sig@{i j} (fun f : forall (z:O_reflector@{Ou Oa i} O A), (B z) =&gt; forall a:A, f (to@{Ou Oa i} O A a) = g a))
      -&gt;
      (forall (A:Type@{i}) (B:A -&gt; Type@{j}) `{In@{Ou Oa i} O A} `{forall a, In@{Ou Oa j} O (B a)},
         (In@{Ou Oa j} O (sig@{i j} (fun x:A =&gt; B x)))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 830
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 831
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros H A B ? ?.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 832
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
             pose (h := fun x =&gt; @O_rec@{Ou Oa i i i j i} _ ({x:A &amp; B x}) A _ pr1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 833
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      pose (p := (fun z =&gt; O_rec_beta pr1 z)
                 : h o (to O _) == pr1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 835
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (g := fun z =&gt; (transport B ((p z)^) z.2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 836
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simpl in *.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 837
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      specialize (H ({x:A &amp; B x}) (fun x =&gt; B (h x)) _ g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 838
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      destruct H as [f q].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 839
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_to_O_retract@{i} with (mu := fun w =&gt; (h w; f w)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 840
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros [x1 x2].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 841
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simple refine (path_sigma B _ _ _ _); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 842
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 843
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 843
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 844
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (ap _ (q (x1;x2)) @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 844
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold g; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 845
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (transport_pV B _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 845
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 846
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** For (i) =&gt; (ii) we first prove a "local" version, that if a *particular* sigma-type is in [O] then it admits extensions. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 849
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition extension_from_inO_sigma@{i j k}
               {A:Type@{i}} (B: (O A) -&gt; Type@{j})
               {H : In@{Ou Oa k} O (sig@{i j} (fun z:O A =&gt; B z))}
               (g : forall x, B (to O A x))
      : ExtensionAlong@{i i j k k} (to O A) B g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 853
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 854
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      set (Z := sigT B : Type@{k}) in *.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 855
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (g' := (fun a:A =&gt; (to O A a ; g a)) : A -&gt; Z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 856
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (f' := O_rec@{Ou Oa i k i k k} g').</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 857
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (eqf := (O_rec_beta g')  : f' o to O A == g').</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 858
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      pose (eqid := O_indpaths@{Ou Oa i i i i i}
                    (pr1 o f') idmap (fun x =&gt; ap@{k i} pr1 (eqf x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 860
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exists (fun z =&gt; transport B (eqid z) ((f' z).2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 861
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 862
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold eqid.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 862
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      refine (_ @ pr2_path (O_rec_beta g' a)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 863
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      refine (ap@{i k} (fun p =&gt; transport B p (O_rec g' (to O A a)).2) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 864
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
      serapply O_indpaths_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 865
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 866
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** We then deduce the general version from this.  Note that although here we see three universe parameters, after the section closes this definition ends up with five universe parameters [Ou Oa i j k]. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 869
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition O_ind_from_inO_sigma@{i j k}
               (H : forall (A:Type@{i}) (B:A -&gt; Type@{j})
                           {A_inO : In@{Ou Oa i} O A}
                           `{forall a, In@{Ou Oa j} O (B a)},
                   (In@{Ou Oa k} O (sig@{i j} (fun x:A =&gt; B x))))
               (A:Type@{i}) (B: (O A) -&gt; Type@{j}) `{forall a, In@{Ou Oa j} O (B a)}
               (g : forall (a:A), (B (to O A a)))
      := @extension_from_inO_sigma@{i j k} A B (H (O A) B) g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 876
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** In fact, we can enhance [extension_from_inO_sigma] to a local version of [extendable_to_O], as stated in CORS Proposition 2.8 (but our version avoids funext by using [ooExtendableAlong], as usual). *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 879
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition extendable_from_inO_sigma
               {A:Type@{i}} (B: (O A) -&gt; Type@{j})
               {H : In O (sig (fun z:O A =&gt; B z))}
      : ooExtendableAlong@{i i j k} (to O A) B.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 882
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 883
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros n; generalize dependent A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 884
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      induction n as [|n IHn]; intros; [ exact tt | cbn ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 885
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (extension_from_inO_sigma B , _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 886
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros h k; apply IHn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 887
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      set (Z := sigT B) in *.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 888
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (W := sigT (fun a =&gt; B a * B a)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 889
Time: 0.013s">
<div class="time" style="width: 0.51403716884144%"></div>
<pre>
      refine (inO_equiv_inO' (Pullback (A := W) (fun a:O A =&gt; (a;(h a,k a)))
                                       (fun z:Z =&gt; (z.1;(z.2,z.2)))) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 891
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 892
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre> serapply inO_pullback.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 892
Time: 0.011s">
<div class="time" style="width: 0.43495452748122%"></div>
<pre>
        exact (inO_equiv_inO' _ (equiv_sigprod_pullback B B)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 893
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 893
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold Pullback.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 894
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** The rest is just contracting a couple of based path spaces.  It seems like it should be less work than this. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 896
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>apply equiv_functor_sigma_id; intros z; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 896
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
      refine (_ oE equiv_functor_sigma_id _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 897
Time: 0.01s">
<div class="time" style="width: 0.39541320680111%"></div>
<pre>
      2:intros; symmetry; apply equiv_path_sigma.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 898
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      refine (_ oE (equiv_sigma_assoc _ _)^-1%equiv); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 899
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ oE equiv_functor_sigma_id _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 900
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      2:intros; apply equiv_sigma_symm.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 901
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ oE (equiv_sigma_assoc' _ _)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 902
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre> 
      refine (_ oE equiv_contr_sigma _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 903
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ oE equiv_functor_sigma_id _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 904
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      2:{</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 905
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> intros; symmetry; etransitivity; revgoals.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 905
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 906
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply equiv_path_prod.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 906
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 907
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply equiv_sigma_prod0.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 907
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 907
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ oE equiv_sigma_assoc' _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 908
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
      refine (_ oE equiv_contr_sigma _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 909
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_path_inverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 910
Time: 0.015s">
<div class="time" style="width: 0.59311981020166%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 911
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Fibers *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 915
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_hfiber {A B : Type} `{In O A} `{In O B}
           (f : A -&gt; B) (b : B)
    : In O (hfiber f b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 917
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 918
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simple refine (inO_to_O_retract _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 919
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 920
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x; simple refine (_;_).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 920
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 921
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_rec pr1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 921
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 922
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> revert x; apply O_indpaths; intros x; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 922
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          refine (ap f (O_rec_beta pr1 x) @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 923
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          exact (x.2).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 924
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 925
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre> intros [a p]; simple refine (path_sigma' _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 925
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 926
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_rec_beta pr1 (a;p)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 926
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 927
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> refine (ap (transport _ _) (O_indpaths_beta _ _ _ _) @ _); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 927
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          refine (transport_paths_Fl _ _ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 928
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply concat_V_pp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 929
Time: 0.008s">
<div class="time" style="width: 0.31633056544089%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 930
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition inO_unsigma {A : Type} (B : A -&gt; Type)
               `{In O A} {B_inO : In O {x:A &amp; B x}} (x : A)
    : In O (B x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 934
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 935
Time: 0.013s">
<div class="time" style="width: 0.51403716884144%"></div>
<pre>
      refine (inO_equiv_inO _ (hfiber_fibration x B)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 936
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** TODO: Why doesn't Coq find this instance? *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 938
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>refine (inO_hfiber pr1 x); assumption.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 938
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 939
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Hint Immediate inO_unsigma : typeclass_instances.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 941
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The reflector preserving hfibers is a characterization of lex modalities.  Here is the comparison map. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 944
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_functor_hfiber {A B} (f : A -&gt; B) (b : B)
    : O (hfiber f b) -&gt; hfiber (O_functor f) (to O B b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 945
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 946
Time: 0.01s">
<div class="time" style="width: 0.39541320680111%"></div>
<pre>
      apply O_rec.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 947
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [a p].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 947
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exists (to O A a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 948
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (to_O_natural f a @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 949
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ap, p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 950
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 951
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Theorem 7.3.9: The reflector [O] can be discarded inside a reflected sum. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 954
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition equiv_O_sigma_O {A} (P : A -&gt; Type)
    : O {x:A &amp; O (P x)} &lt;~&gt; O {x:A &amp; P x}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 955
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 956
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simple refine (equiv_adjointify _ _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 957
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 958
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> apply O_rec; intros [a op]; revert op.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 958
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply O_rec; intros p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 959
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (to O _ (a;p)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 960
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 961
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> apply O_rec; intros [a p].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 961
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (to O _ (a ; to O _ p)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 962
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 963
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> unfold Sect; apply O_indpaths; try exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 963
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        intros [a p]; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 964
Time: 0.011s">
<div class="time" style="width: 0.43495452748122%"></div>
<pre>
        abstract (repeat (simpl rewrite @O_rec_beta); reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 965
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 966
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> unfold Sect; apply O_indpaths; try exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 966
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
        intros [a op]; revert op; apply O_indpaths; try exact _; intros p; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 967
Time: 0.013s">
<div class="time" style="width: 0.51403716884144%"></div>
<pre>
        abstract (repeat (simpl rewrite @O_rec_beta); reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 968
Time: 0.008s">
<div class="time" style="width: 0.31633056544089%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 969
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Equivalences *)

    (** Naively it might seem that we need closure under Sigmas (hence a modality) to deduce closure under [Equiv], but in fact the above closure under fibers is sufficient.  This appears as part of the proof of Proposition 2.18 of CORS.  For later use, we try to reduce the number of universe parameters (but we don't completely control them all). *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 974
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_equiv `{Funext} (A : Type@{i}) (B : Type@{j})
           `{In@{Ou Oa i} O A} `{In@{Ou Oa j} O B}
      : In@{Ou Oa k} O (A &lt;~&gt; B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 976
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 977
Time: 0.01s">
<div class="time" style="width: 0.39541320680111%"></div>
<pre>
      refine (inO_equiv_inO@{Ou Oa k k k} _ (issig_equiv@{i j k} A B)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 978
Time: 0.028s">
<div class="time" style="width: 1.1071569790431%"></div>
<pre>
      refine (inO_equiv_inO@{Ou Oa k k k} _ (equiv_functor_sigma equiv_idmap@{k}
                                 (fun f =&gt; equiv_biinv_isequiv@{i j k l} f))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 980
Time: 0.01s">
<div class="time" style="width: 0.39541320680111%"></div>
<pre>
      transparent assert (c : (prod@{k k} (A-&gt;B) (prod@{k k} (B-&gt;A) (B-&gt;A)) -&gt; prod@{k k} (A -&gt; A) (B -&gt; B))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 981
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 982
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> intros [f [g h]]; exact (h o f, f o g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 982
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 982
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (U := hfiber@{k k} c (idmap, idmap)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 983
Time: 0.149s">
<div class="time" style="width: 5.8916567813365%"></div>
<pre>
      refine (inO_equiv_inO'@{k k k} U _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 984
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (** Introduces some extra copies of [k] by typeclass inference. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 985
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>unfold hfiber, BiInv; cbn in *.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 985
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      srefine (equiv_adjointify _ _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 986
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 987
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> intros [[f [g h]] p].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 987
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        apply (equiv_inverse (equiv_path_prod _ _)) in p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 988
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        destruct p as [p q]; cbn in *.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 989
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exists f; split; [ exists h | exists g ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 990
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        all:apply ap10; assumption.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 991
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 992
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> intros [f [[g p] [h q]]].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 992
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exists (f,(h,g)); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 993
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        apply path_prod; apply path_arrow; assumption.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 994
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 995
Time: 0.014s">
<div class="time" style="width: 0.55357848952155%"></div>
<pre> intros [f [[g p] [h q]]]; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 995
Time: 0.007s">
<div class="time" style="width: 0.27678924476078%"></div>
<pre>
        apply (path_sigma' _ 1); apply path_prod; apply (path_sigma' _ 1);
          cbn; rewrite transport_1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 997
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
        1:rewrite ap_fst_path_prod.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 998
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
        2:rewrite ap_snd_path_prod.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 999
Time: 0.005s">
<div class="time" style="width: 0.19770660340055%"></div>
<pre>
        all:apply path_forall; intros x; rewrite ap10_path_arrow; reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1000
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1001
Time: 0.108s">
<div class="time" style="width: 4.270462633452%"></div>
<pre> intros [[f [g h]] p]; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1001
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> 
        apply (path_sigma' _ 1); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1002
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
        refine (_ @ eta_path_prod p); apply ap011; apply eta_path_arrow.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1003
Time: 0.025s">
<div class="time" style="width: 0.98853301700277%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1004
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Check inO_equiv@{i j k l k k}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1005
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (** k is max(i,j), while k &lt; l *)

    (** ** Paths *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1009
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition inO_paths@{i j} (S : Type@{i}) {S_inO : In@{Ou Oa i} O S} (x y : S)
    : In@{Ou Oa i} O (x=y).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1010
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1011
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simple refine (inO_to_O_retract@{i} _ _ _); intro u.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1012
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1013
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assert (p : (fun _ : O (x=y) =&gt; x) == (fun _=&gt; y)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1013
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1014
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (O_indpaths _ _ _); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1014
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          intro v; exact v.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1015
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1015
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (p u).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1016
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1017
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1017
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        rewrite O_indpaths_beta; reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1018
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1019
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Global Existing Instance inO_paths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1020
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Truncations  *)

    (** The reflector preserves hprops (and, as we have already seen, contractible types), although it doesn't generally preserve [n]-types for other [n]. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1025
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance ishprop_O_ishprop {A} `{IsHProp A} : IsHProp (O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1025
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1026
Time: 0.017s">
<div class="time" style="width: 0.67220245156188%"></div>
<pre>
      refine ishprop_isequiv_diag.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1027
Time: 0.021s">
<div class="time" style="width: 0.83036773428233%"></div>
<pre>
      refine (isequiv_homotopic (O_prod_cmp A A
                               o O_functor (fun (a:A) =&gt; (a,a))) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1029
Time: 0.013s">
<div class="time" style="width: 0.51403716884144%"></div>
<pre>
      apply O_indpaths; intros x; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1030
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      refine (ap (O_prod_cmp A A) (to_O_natural (fun (a:A) =&gt; (a,a)) x) @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1031
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_prod_cmp; apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1032
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1033
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** If [A] is [In O], then so is [IsTrunc n A]. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1036
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_istrunc `{Funext} {n} {A} `{In O A}
    : In O (IsTrunc n A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1037
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1038
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      generalize dependent A; simple_induction n n IH; intros A ?.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1039
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1040
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (** We have to be slightly clever here: the actual definition of [Contr] involves a sigma, which [O] is not generally closed under, but fortunately we have [equiv_contr_inhabited_allpath]. *)
       </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1041
Time: 0.073s">
<div class="time" style="width: 2.8865164096481%"></div>
<pre>refine (inO_equiv_inO _ equiv_contr_inhabited_allpath^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1041
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1042
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> change (In O (forall x y:A, IsTrunc n (x=y))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1042
Time: 0.026s">
<div class="time" style="width: 1.0280743376829%"></div>
<pre>
        exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1043
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1044
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Coproducts *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1048
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition equiv_O_sum {A B} :
      O (A + B) &lt;~&gt; O (O A + O B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1049
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1050
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simple refine (equiv_adjointify _ _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1051
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1052
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_rec; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1052
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (to O _ (functor_sum (to O A) (to O B) x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1053
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1054
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> apply O_rec; intros [x|x].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1054
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1055
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* Work around https://coq.inria.fr/bugs/show_bug.cgi?id=4525, stack overflow in exact *)
         </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1056
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>let lem := constr:(fun A B =&gt; to O _ o @inl A B) in
          exact (O_rec (lem _ _) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1057
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1058
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> let lem := constr:(fun A B =&gt; to O _ o @inr A B) in
          exact (O_rec (lem _ _) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1059
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1060
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre> apply O_indpaths; intros [x|x].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1060
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
        all:revert x; apply O_indpaths; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1061
Time: 0.029s">
<div class="time" style="width: 1.1466982997232%"></div>
<pre>
        all:abstract (rewrite !O_rec_beta; reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1062
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1063
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre> apply O_indpaths; intros [x|x].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1063
Time: 0.042s">
<div class="time" style="width: 1.6607354685647%"></div>
<pre>
        all:abstract (rewrite !O_rec_beta; cbn;
                      rewrite !O_rec_beta; reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1065
Time: 0.013s">
<div class="time" style="width: 0.51403716884144%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1066
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Coequalizers *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1070
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section OCoeq.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1070
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Context {B A : Type} (f g : B -&gt; A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1071
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

      Definition O_coeq_cmp
      : O (Coeq f g) -&gt; O (Coeq (O_functor f) (O_functor g)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1074
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1075
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1076
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        exact (functor_coeq (to O B) (to O A)
                            (fun y =&gt; (to_O_natural f y)^)
                            (fun y =&gt; (to_O_natural g y)^)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1079
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1080
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

      Definition O_coeq_cmp_inverse
      : O (Coeq (O_functor f) (O_functor g)) -&gt; O (Coeq f g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1083
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1084
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        apply O_rec; simple refine (Coeq_rec _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1085
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1086
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor, coeq.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1086
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1087
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1087
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
          refine ((O_functor_compose f coeq b)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1088
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          refine (_ @ (O_functor_compose g coeq b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1089
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply O_functor_homotopy.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1090
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          intros z; apply cglue.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1091
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1092
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

      Local Definition O_coeq_cmp_eisretr
      : Sect O_coeq_cmp_inverse O_coeq_cmp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1095
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1096
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold O_coeq_cmp, O_coeq_cmp_inverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1097
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        apply O_indpaths; intros z.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1098
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
        rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1099
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        revert z; simple refine (Coeq_ind _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1101
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
          refine ((O_functor_compose _ _ _)^ @ _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1102
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
          revert a; apply O_indpaths, to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1104
Time: 0.035s">
<div class="time" style="width: 1.3839462238039%"></div>
<pre> set (coeq_to :=
                 functor_coeq (to O B) (to O A)
                              (fun y : B =&gt; (to_O_natural f y)^)
                              (fun y : B =&gt; (to_O_natural g y)^)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1107
Time: 0.01s">
<div class="time" style="width: 0.39541320680111%"></div>
<pre>
          apply O_ind2paths; intros b; unfold composeD; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1108
Time: 0.049s">
<div class="time" style="width: 1.9375247133254%"></div>
<pre>
          rewrite transport_paths_FlFr, concat_pp_p; apply moveR_Vp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1109
Time: 0.025s">
<div class="time" style="width: 0.98853301700277%"></div>
<pre>
          rewrite &lt;- (apD (O_indpaths _ _ _) (to_O_natural f b)^).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1110
Time: 0.028s">
<div class="time" style="width: 1.1071569790431%"></div>
<pre>
          rewrite &lt;- (apD (O_indpaths _ _ _) (to_O_natural g b)^).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1111
Time: 0.118s">
<div class="time" style="width: 4.6658758402531%"></div>
<pre>
          rewrite !O_indpaths_beta, !transport_paths_FlFr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          Open Scope long_path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1113
Time: 0.389s">
<div class="time" style="width: 15.381573744563%"></div>
<pre>
          rewrite !ap_V, !inv_V, !concat_p_pp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1114
Time: 0.045s">
<div class="time" style="width: 1.779359430605%"></div>
<pre>
          rewrite (ap_compose _ (O_functor coeq_to)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1115
Time: 0.045s">
<div class="time" style="width: 1.779359430605%"></div>
<pre>
          rewrite Coeq_rec_beta_cglue.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1116
Time: 0.154s">
<div class="time" style="width: 6.0893633847371%"></div>
<pre>
          rewrite !ap_pp, !concat_p_pp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1117
Time: 0.059s">
<div class="time" style="width: 2.3329379201265%"></div>
<pre>
          unfold O_functor_homotopy; rewrite O_indpaths_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1118
Time: 0.283s">
<div class="time" style="width: 11.190193752471%"></div>
<pre>
          rewrite !ap_pp, !concat_p_pp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1119
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
          pose (p := O_functor_compose_compose g coeq coeq_to (to O B b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1120
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>
          apply moveL_pV in p; rewrite concat_pp_p in p; apply moveR_Vp in p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1121
Time: 0.319s">
<div class="time" style="width: 12.613681296955%"></div>
<pre>
          rewrite@A &lt;- p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1122
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> clear p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1122
Time: 0.455s">
<div class="time" style="width: 17.99130090945%"></div>
<pre>
          rewrite@A (to_O_natural_compose g
                       (fun x =&gt; @coeq _ _ (O_functor f) (O_functor g)
                                       (to O A x)) b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1125
Time: 0.055s">
<div class="time" style="width: 2.1747726374061%"></div>
<pre>
          rewrite concat_pp_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1126
Time: 0.469s">
<div class="time" style="width: 18.544879398972%"></div>
<pre>
          rewrite@A (to_O_natural_compose f
                     (fun x =&gt; @coeq _ _ (O_functor f) (O_functor g)
                                     (to O A x)) b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1129
Time: 0.047s">
<div class="time" style="width: 1.8584420719652%"></div>
<pre>
          rewrite &lt;- inv_pp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1130
Time: 0.053s">
<div class="time" style="width: 2.0956899960459%"></div>
<pre>
          rewrite (O_functor_compose_compose f coeq coeq_to (to O B b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1131
Time: 0.1s">
<div class="time" style="width: 3.9541320680111%"></div>
<pre>
          rewrite inv_pp, ap_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1132
Time: 0.592s">
<div class="time" style="width: 23.408461842626%"></div>
<pre>
          rewrite !concat_pp_p; apply whiskerL; rewrite !concat_p_pp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          (** The trick here is to notice that [(fun x =&gt; coeq (to O A (f x)))] is definitionally equal to [(fun x =&gt; coeq_to (coeq (f x)))]. *)
         </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1135
Time: 0.027s">
<div class="time" style="width: 1.067615658363%"></div>
<pre>rewrite &lt;- (to_O_natural_compose
                        (fun x =&gt; coeq (f x)) coeq_to b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1136
Time: 0.037s">
<div class="time" style="width: 1.4630288651641%"></div>
<pre>
          rewrite &lt;- ap_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1137
Time: 0.248s">
<div class="time" style="width: 9.8062475286675%"></div>
<pre>
          rewrite !concat_pp_p; apply whiskerL, moveR_Mp; rewrite !concat_p_pp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1138
Time: 0.03s">
<div class="time" style="width: 1.1862396204033%"></div>
<pre>
          rewrite &lt;- (concat_Ap (fun x =&gt; (to_O_natural coeq_to x)^) (cglue b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1139
Time: 0.161s">
<div class="time" style="width: 6.3661526294978%"></div>
<pre>
          rewrite !concat_pp_p; apply moveL_Mp; rewrite !concat_p_pp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1140
Time: 0.11s">
<div class="time" style="width: 4.3495452748122%"></div>
<pre>
          rewrite ap_V, &lt;- !inv_pp, @to_O_natural_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1141
Time: 0.04s">
<div class="time" style="width: 1.5816528272044%"></div>
<pre>
          rewrite concat_p_Vp, concat_Vp, concat_1p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1142
Time: 0.012s">
<div class="time" style="width: 0.47449584816133%"></div>
<pre>
          rewrite (ap_compose coeq_to (to O (Coeq (O_functor f) (O_functor g)))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1143
Time: 0.022s">
<div class="time" style="width: 0.86990905496244%"></div>
<pre>
          subst coeq_to; rewrite functor_coeq_beta_cglue.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1144
Time: 0.339s">
<div class="time" style="width: 13.404507710558%"></div>
<pre>
          rewrite !ap_pp, &lt;- !ap_compose, !inv_pp, !concat_p_pp, !ap_V, !inv_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1145
Time: 0.025s">
<div class="time" style="width: 0.98853301700277%"></div>
<pre>
          rewrite concat_pp_V, concat_pV_p; reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          Close Scope long_path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre></pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          rewrite !ap_V, !inv_V, !concat_p_pp.
          rewrite (ap_compose _ (O_functor coeq_to)).
          rewrite Coeq_rec_beta_cglue.
          rewrite !ap_pp, !concat_p_pp.
          unfold O_functor_homotopy; rewrite O_indpaths_beta.
          rewrite !ap_pp, !concat_p_pp.
          pose (p := O_functor_compose_compose g coeq coeq_to (to O B b)).
          apply moveL_pV in p; rewrite concat_pp_p in p; apply moveR_Vp in p.
          rewrite@A &lt;- p. clear p.
          rewrite@A (to_O_natural_compose g
                       (fun x =&gt; @coeq _ _ (O_functor f) (O_functor g)
                                       (to O A x)) b).
          rewrite concat_pp_V.
          rewrite@A (to_O_natural_compose f
                     (fun x =&gt; @coeq _ _ (O_functor f) (O_functor g)
                                     (to O A x)) b).
          rewrite &lt;- inv_pp.
          rewrite (O_functor_compose_compose f coeq coeq_to (to O B b)).
          rewrite inv_pp, ap_V.
          rewrite !concat_pp_p; apply whiskerL; rewrite !concat_p_pp.
          (** The trick here is to notice that [(fun x =&gt; coeq (to O A (f x)))] is definitionally equal to [(fun x =&gt; coeq_to (coeq (f x)))]. *)
          rewrite &lt;- (to_O_natural_compose
                        (fun x =&gt; coeq (f x)) coeq_to b).
          rewrite &lt;- ap_compose.
          rewrite !concat_pp_p; apply whiskerL, moveR_Mp; rewrite !concat_p_pp.
          rewrite &lt;- (concat_Ap (fun x =&gt; (to_O_natural coeq_to x)^) (cglue b)).
          rewrite !concat_pp_p; apply moveL_Mp; rewrite !concat_p_pp.
          rewrite ap_V, &lt;- !inv_pp, @to_O_natural_compose.
          rewrite concat_p_Vp, concat_Vp, concat_1p.
          rewrite (ap_compose coeq_to (to O (Coeq (O_functor f) (O_functor g)))).
          subst coeq_to; rewrite functor_coeq_beta_cglue.
          rewrite !ap_pp, &lt;- !ap_compose, !inv_pp, !concat_p_pp, !ap_V, !inv_V.
          rewrite concat_pp_V, concat_pV_p; reflexivity.
         </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Close Scope long_path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1181
Time: 2.529s">
<div class="time" style="width: 100%"></div>
<pre>
      Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

      Local Definition O_coeq_cmp_eissect
      : Sect O_coeq_cmp O_coeq_cmp_inverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1186
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold O_coeq_cmp, O_coeq_cmp_inverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1187
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        apply O_indpaths; intros z.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1188
Time: 0.012s">
<div class="time" style="width: 0.47449584816133%"></div>
<pre>
        rewrite to_O_natural, O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        revert z; simple refine (Coeq_ind _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1193
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> intros b; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1193
Time: 0.034s">
<div class="time" style="width: 1.3444049031238%"></div>
<pre>
          rewrite transport_paths_FlFr, ap_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1194
Time: 0.027s">
<div class="time" style="width: 1.067615658363%"></div>
<pre>
          rewrite functor_coeq_beta_cglue.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1195
Time: 0.174s">
<div class="time" style="width: 6.8801897983393%"></div>
<pre>
          rewrite !ap_pp, &lt;- !ap_compose; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1196
Time: 0.012s">
<div class="time" style="width: 0.47449584816133%"></div>
<pre>
          rewrite Coeq_rec_beta_cglue.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          Open Scope long_path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1198
Time: 0.121s">
<div class="time" style="width: 4.7844998022934%"></div>
<pre>
          rewrite !inv_pp, !concat_p_pp, !ap_V, !inv_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1199
Time: 0.03s">
<div class="time" style="width: 1.1862396204033%"></div>
<pre>
          apply moveR_pM; rewrite !concat_pp_p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1200
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>
          rewrite (to_O_natural_compose f (@coeq B A f g) b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1201
Time: 0.012s">
<div class="time" style="width: 0.47449584816133%"></div>
<pre>
          rewrite concat_p_Vp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1202
Time: 0.007s">
<div class="time" style="width: 0.27678924476078%"></div>
<pre>
          rewrite &lt;- O_functor_homotopy_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1203
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>
          rewrite O_functor_homotopy_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1204
Time: 0.026s">
<div class="time" style="width: 1.0280743376829%"></div>
<pre>
          rewrite concat_pV_p, !concat_p_pp, ap_V; apply whiskerR.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1205
Time: 0.007s">
<div class="time" style="width: 0.27678924476078%"></div>
<pre>
          rewrite !concat_pp_p; apply moveR_Vp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1206
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
          symmetry; apply to_O_natural_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          Close Scope long_path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre></pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          rewrite !inv_pp, !concat_p_pp, !ap_V, !inv_V.
          apply moveR_pM; rewrite !concat_pp_p.
          rewrite (to_O_natural_compose f (@coeq B A f g) b).
          rewrite concat_p_Vp.
          rewrite &lt;- O_functor_homotopy_V.
          rewrite O_functor_homotopy_beta.
          rewrite concat_pV_p, !concat_p_pp, ap_V; apply whiskerR.
          rewrite !concat_pp_p; apply moveR_Vp.
          symmetry; apply to_O_natural_compose.
         </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Close Scope long_path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1218
Time: 0.369s">
<div class="time" style="width: 14.590747330961%"></div>
<pre>
      Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1219
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

      Global Instance isequiv_O_coeq_cmp
      : IsEquiv O_coeq_cmp
        := isequiv_adjointify _ O_coeq_cmp_inverse
                              O_coeq_cmp_eisretr O_coeq_cmp_eissect.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1224
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

      Definition equiv_O_coeq
      : O (Coeq f g) &lt;~&gt; O (Coeq (O_functor f) (O_functor g))
        := Build_Equiv _ _ O_coeq_cmp _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1228
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

      Definition equiv_O_coeq_to_O (a : A)
        : equiv_O_coeq (to O (Coeq f g) (coeq a))
          = to O (Coeq (O_functor f) (O_functor g)) (coeq (to O A a)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine (to_O_natural _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1235
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

      Definition inverse_equiv_O_coeq_to_O (a : A)
        : equiv_O_coeq^-1 (to O (Coeq (O_functor f) (O_functor g)) (coeq (to O A a)))
          = to O (Coeq f g) (coeq a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1240
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        apply moveR_equiv_V; symmetry; apply equiv_O_coeq_to_O.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1241
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1242
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

    End OCoeq.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Pushouts *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1248
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section OPushout.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1248
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Context {A B C : Type} (f : A -&gt; B) (g : A -&gt; C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1249
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

      Definition equiv_O_pushout
        : O (Pushout f g) &lt;~&gt; O (Pushout (O_functor f) (O_functor g)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1253
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold Pushout.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1254
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
        refine (_ oE equiv_O_coeq (inl o f) (inr o g)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine ((equiv_O_coeq _ _)^-1 oE _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply equiv_O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1257
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
        srefine (@equiv_functor_coeq'
                   _ _ (O_functor (inl o f)) (O_functor (inr o g))
                   _ _ (O_functor (inl o O_functor f))
                   (O_functor (inr o O_functor g)) _ _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1262
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply equiv_to_O; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1262
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1263
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply equiv_O_sum.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1263
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1264
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre> srefine (O_indpaths _ _ _); intros a; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1264
Time: 0.023s">
<div class="time" style="width: 0.90945037564255%"></div>
<pre>
          abstract (rewrite !to_O_natural, O_rec_beta; reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1266
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre> srefine (O_indpaths _ _ _); intros a; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1266
Time: 0.017s">
<div class="time" style="width: 0.67220245156188%"></div>
<pre>
          abstract (rewrite !to_O_natural, O_rec_beta; reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1267
Time: 0.008s">
<div class="time" style="width: 0.31633056544089%"></div>
<pre>
      Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1268
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

      Definition equiv_O_pushout_to_O_pushl (b : B)
        : equiv_O_pushout (to O (Pushout f g) (pushl b))
          = to O (Pushout (O_functor f) (O_functor g)) (pushl (to O B b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1273
Time: 0.02s">
<div class="time" style="width: 0.79082641360221%"></div>
<pre>
        cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1274
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
        unfold O_coeq_cmp, O_coeq_cmp_inverse, Pushout, pushl, push.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1275
Time: 0.06s">
<div class="time" style="width: 2.3724792408066%"></div>
<pre>
        rewrite to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1276
Time: 0.064s">
<div class="time" style="width: 2.5306445235271%"></div>
<pre>
        rewrite to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1277
Time: 0.017s">
<div class="time" style="width: 0.67220245156188%"></div>
<pre>
        rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1279
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
        rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1280
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
        rewrite to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1282
Time: 0.107s">
<div class="time" style="width: 4.2309213127718%"></div>
<pre>
      Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1283
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

      Definition equiv_O_pushout_to_O_pushr (c : C)
        : equiv_O_pushout (to O (Pushout f g) (pushr c))
          = to O (Pushout (O_functor f) (O_functor g)) (pushr (to O C c)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1288
Time: 0.02s">
<div class="time" style="width: 0.79082641360221%"></div>
<pre>
        cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1289
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
        unfold O_coeq_cmp, O_coeq_cmp_inverse, Pushout, pushr, push.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1290
Time: 0.06s">
<div class="time" style="width: 2.3724792408066%"></div>
<pre>
        rewrite to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1291
Time: 0.057s">
<div class="time" style="width: 2.2538552787663%"></div>
<pre>
        rewrite to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1292
Time: 0.017s">
<div class="time" style="width: 0.67220245156188%"></div>
<pre>
        rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1294
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
        rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1295
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
        rewrite to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1296
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1297
Time: 0.118s">
<div class="time" style="width: 4.6658758402531%"></div>
<pre>
      Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1298
Time: 0.019s">
<div class="time" style="width: 0.7512850929221%"></div>
<pre>

      Definition inverse_equiv_O_pushout_to_O_pushl (b : B)
        : equiv_O_pushout^-1 (to O (Pushout (O_functor f) (O_functor g)) (pushl (to O B b)))
          = to O (Pushout f g) (pushl b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1303
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
        apply moveR_equiv_V; symmetry; apply equiv_O_pushout_to_O_pushl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1304
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1305
Time: 0.018s">
<div class="time" style="width: 0.71174377224199%"></div>
<pre>

      Definition inverse_equiv_O_pushout_to_O_pushr (c : C)
        : equiv_O_pushout^-1 (to O (Pushout (O_functor f) (O_functor g)) (pushr (to O C c)))
          = to O (Pushout f g) (pushr c).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1309
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1310
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
        apply moveR_equiv_V; symmetry; apply equiv_O_pushout_to_O_pushr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1311
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1312
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

    End OPushout.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1314
Time: 0.018s">
<div class="time" style="width: 0.71174377224199%"></div>
<pre>

  End Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Decidable.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1318
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** If [Empty] belongs to [O], then [O] preserves decidability. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance decidable_O `{In O Empty} (A : Type) `{Decidable A}
    : Decidable (O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1322
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1323
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      destruct (dec A) as [y|n].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1324
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inl (to O A y)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr (O_rec n)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1327
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Dually, if [O A] is decidable, then [O (Decidable A)]. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_decidable (A : Type) `{Decidable (O A)}
    : O (Decidable A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1332
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      destruct (dec (O A)) as [y|n].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_functor inl y).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (O_functor inr _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply to; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (n (to O A a)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  End Decidable.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Monad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1342
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

    Definition O_monad_mult (A : Type) : O (O A) -&gt; O A
      := O_rec idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1345
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

    Definition O_monad_mult_natural {A B} (f : A -&gt; B)
    : O_functor f o O_monad_mult A == O_monad_mult B o O_functor (O_functor f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1348
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1349
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply O_indpaths; intros x; unfold O_monad_mult.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1350
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      rewrite (to_O_natural (O_functor f) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1351
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      rewrite (O_rec_beta idmap x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1352
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      rewrite (O_rec_beta idmap (O_functor f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1353
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1354
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1355
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition O_monad_unitlaw1 (A : Type)
    : O_monad_mult A o (to O (O A)) == idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1358
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1359
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply O_indpaths; intros x; unfold O_monad_mult.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1360
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (O_rec_beta idmap (to O A x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1361
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1362
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

    Definition O_monad_unitlaw2 (A : Type)
    : O_monad_mult A o (O_functor (to O A)) == idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1365
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply O_indpaths; intros x; unfold O_monad_mult, O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1367
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1368
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1369
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1370
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

    Definition O_monad_mult_assoc (A : Type)
    : O_monad_mult A o O_monad_mult (O A) == O_monad_mult A o O_functor (O_monad_mult A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1373
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1374
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      apply O_indpaths; intros x; unfold O_monad_mult, O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1375
Time: 0.011s">
<div class="time" style="width: 0.43495452748122%"></div>
<pre>
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1377
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1378
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  End Monad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section StrongMonad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1382
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Context {fs : Funext}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1383
Time: 0.031s">
<div class="time" style="width: 1.2257809410834%"></div>
<pre>

    Definition O_monad_strength (A B : Type) : A * O B -&gt; O (A * B)
      := fun aob =&gt; O_rec (fun b a =&gt; to O (A*B) (a,b)) (snd aob) (fst aob).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1386
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>

    Definition O_monad_strength_natural (A A' B B' : Type) (f : A -&gt; A') (g : B -&gt; B')
    : O_functor (functor_prod f g) o O_monad_strength A B ==
      O_monad_strength A' B' o functor_prod f (O_functor g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1390
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1391
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros [a ob].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1392
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> revert a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1392
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1392
Time: 0.034s">
<div class="time" style="width: 1.3444049031238%"></div>
<pre>
      revert ob; apply O_indpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros b; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1394
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      apply path_arrow; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1395
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_monad_strength, O_functor; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1396
Time: 0.017s">
<div class="time" style="width: 0.67220245156188%"></div>
<pre>
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1397
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1398
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1399
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The diagrams for strength, see http://en.wikipedia.org/wiki/Strong_monad *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1402
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition O_monad_strength_unitlaw1 (A : Type)
    : O_functor (@snd Unit A) o O_monad_strength Unit A == @snd Unit (O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1403
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1404
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros [[] oa]; revert oa.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1405
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      apply O_indpaths; intros x; unfold O_monad_strength, O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1406
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1406
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1407
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1408
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1409
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

    Definition O_monad_strength_unitlaw2 (A B : Type)
    : O_monad_strength A B o functor_prod idmap (to O B) == to O (A*B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1412
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1413
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros [a b].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1414
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_monad_strength, functor_prod.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1415
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1415
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1416
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1417
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1418
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>

    Definition O_monad_strength_assoc1 (A B C : Type)
    : O_functor (equiv_prod_assoc A B C)^-1 o O_monad_strength (A*B) C ==
      O_monad_strength A (B*C) o functor_prod idmap (O_monad_strength B C) o (equiv_prod_assoc A B (O C))^-1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1422
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1423
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      intros [[a b] oc].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1424
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      revert a; apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1425
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> revert b; apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1425
Time: 0.172s">
<div class="time" style="width: 6.801107156979%"></div>
<pre>
      revert oc; apply O_indpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1426
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros c; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_arrow; intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_arrow; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_monad_strength, O_functor, functor_prod.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1429
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1429
Time: 0.012s">
<div class="time" style="width: 0.47449584816133%"></div>
<pre>
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1430
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1431
Time: 0.013s">
<div class="time" style="width: 0.51403716884144%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1432
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>

    Definition O_monad_strength_assoc2 (A B : Type)
    : O_monad_mult (A*B) o O_functor (O_monad_strength A B) o O_monad_strength A (O B) ==
      O_monad_strength A B o functor_prod idmap (O_monad_mult B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1436
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1437
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros [a oob].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1438
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> revert a; apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1438
Time: 0.033s">
<div class="time" style="width: 1.3048635824437%"></div>
<pre>
      revert oob; apply O_indpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1439
Time: 0.034s">
<div class="time" style="width: 1.3444049031238%"></div>
<pre> apply O_indpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1439
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros b; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_arrow; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_monad_strength, O_functor, O_monad_mult, functor_prod.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1441
Time: 0.017s">
<div class="time" style="width: 0.67220245156188%"></div>
<pre>
      repeat (rewrite O_rec_beta; simpl).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1442
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1443
Time: 0.015s">
<div class="time" style="width: 0.59311981020166%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1444
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  End StrongMonad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1446
Time: 0.107s">
<div class="time" style="width: 4.2309213127718%"></div>
<pre>

End Reflective_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1448
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Make the [O_inverts] notation global. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Notation O_inverts O f := (IsEquiv (O_functor O f)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Modally connected types *)

(** Connectedness of a type, relative to a modality or reflective subuniverse, can be defined in two equivalent ways: quantifying over all maps into modal types, or by considering just the universal case, the modal reflection of the type itself.  The former requires only core Coq, but blows up the size (universe level) of [IsConnected], since it quantifies over types; moreover, it is not even quite correct since (at least with a polymorphic modality) it should really be quantified over all universes.  Thus, we use the latter, although in most examples it requires HITs to define the modal reflection.

Question: is there a definition of connectedness (say, for n-types) that neither blows up the universe level, nor requires HIT's? *)

(** We give annotations to reduce the number of universe parameters. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1458
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Class IsConnected (O : ReflectiveSubuniverse@{u a}) (A : Type@{i})
  := isconnected_contr_O : Contr@{i} (O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1459
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Existing Instance isconnected_contr_O.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1461
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section ConnectedTypes.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1463
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context (O : ReflectiveSubuniverse).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1464
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Being connected is an hprop *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1467
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance ishprop_isconnected `{Funext} A
  : IsHProp (IsConnected O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1468
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1469
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold IsConnected; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1470
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1471
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Anything equivalent to a connected type is connected. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1474
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition isconnected_equiv (A : Type) {B : Type} (f : A -&gt; B) `{IsEquiv _ _ f}
  : IsConnected O A -&gt; IsConnected O B.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1475
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1476
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>
    intros ?; refine (contr_equiv (O A) (O_functor O f)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1477
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1478
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

  Definition isconnected_equiv' (A : Type) {B : Type} (f : A &lt;~&gt; B)
  : IsConnected O A -&gt; IsConnected O B
    := isconnected_equiv A f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1482
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Connectedness of a type [A] can equivalently be characterized by the fact that any map to an [O]-type [C] is nullhomotopic.  Here is one direction of that equivalence. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1485
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition isconnected_elim {A : Type} `{IsConnected O A} (C : Type) `{In O C} (f : A -&gt; C)
  : NullHomotopy f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1486
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1487
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    set (ff := @O_rec O _ _ _ f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1488
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    exists (ff (center _)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1489
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1490
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1490
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ap ff (contr (to O _ a)) @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1491
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1492
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1493
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** For the other direction of the equivalence, it's sufficient to consider the case when [C] is [O A]. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition isconnected_from_elim_to_O {A : Type}
  : NullHomotopy (to O A) -&gt; IsConnected O A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1497
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1498
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros nh.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1499
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists (nh .1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1500
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply O_indpaths; try exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1501
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x; symmetry; apply (nh .2).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Now the general case follows. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1506
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition isconnected_from_elim {A : Type}
  : (forall (C : Type) `{In O C} (f : A -&gt; C), NullHomotopy f)
    -&gt; IsConnected O A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1508
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1509
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1510
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (isconnected_from_elim_to_O (H (O A) (O_inO A) (to O A))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1511
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1512
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Connected types are closed under sigmas. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1515
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isconnected_sigma {A : Type} {B : A -&gt; Type}
             `{IsConnected O A} `{forall a, IsConnected O (B a)}
  : IsConnected O {a:A &amp; B a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1517
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1518
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply isconnected_from_elim; intros C ? f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1519
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (nB := fun a =&gt; @isconnected_elim (B a) _ C _ (fun b =&gt; f (a;b))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1520
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (nA := isconnected_elim C (fun a =&gt; (nB a).1)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1521
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists (nA.1); intros [a b].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1522
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact ((nB a).2 b @ nA.2 a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1523
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1524
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Contractible types are connected. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1527
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isconnected_contr {A : Type} `{Contr A}
    : IsConnected O A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1528
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1529
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply contr_O_contr; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1530
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1531
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>    

  (** A type which is both connected and truncated is contractible. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1534
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition contr_trunc_conn {A : Type} `{In O A} `{IsConnected O A}
  : Contr A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1535
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1536
Time: 0.005s">
<div class="time" style="width: 0.19770660340055%"></div>
<pre>
    apply (contr_equiv _ (to O A)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1537
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1538
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Any map between connected types is inverted by O. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1541
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance O_inverts_isconnected {A B : Type} (f : A -&gt; B)
             `{IsConnected O A} `{IsConnected O B}
    : O_inverts O f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1543
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1544
Time: 0.013s">
<div class="time" style="width: 0.51403716884144%"></div>
<pre>
    exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1545
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1546
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Here's another way of stating the universal property for mapping out of connected types into modal ones. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1549
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition extendable_const_isconnected_inO@{Ou Oa i j k l m} (n : nat)
             (** Work around https://coq.inria.fr/bugs/show_bug.cgi?id=3811 *)
             (A : Type@{i}) {conn_A : IsConnected@{Ou Oa i} O A}
             (C : Type@{j}) `{In@{Ou Oa j} O C}
  : ExtendableAlong@{i i j j} n (@const@{i i} A Unit tt) (fun _ =&gt; C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1553
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1554
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    generalize dependent C;
      simple_induction n n IHn; intros C ?;
      [ exact tt | split ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1557
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1558
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1558
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exists (fun _ : Unit =&gt; (isconnected_elim@{i j k j j i} C f).1); intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1559
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      symmetry; apply ((isconnected_elim@{i j k j j i} C f).2).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1560
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1561
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros h k.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1561
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (extendable_postcompose'@{i i j j j j l l l l} n _ _ _ _ (IHn (h tt = k tt) (inO_paths@{Ou Oa j m} _ _ _ _))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1562
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros []; apply equiv_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1563
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1564
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

  Definition ooextendable_const_isconnected_inO@{Ou Oa i j k}
             (A : Type@{i}) `{IsConnected@{Ou Oa i} O A}
             (C : Type@{j}) `{In@{Ou Oa j} O C}
  : ooExtendableAlong (@const A Unit tt) (fun _ =&gt; C)
    := fun n =&gt; extendable_const_isconnected_inO@{Ou Oa i j k k j} n A C.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1570
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition isequiv_const_isconnected_inO `{Funext}
             {A : Type} `{IsConnected O A} (C : Type) `{In O C}
  : IsEquiv (@const A C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1574
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1575
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
    refine (@isequiv_compose _ _ (fun c u =&gt; c) _ _ _
              (isequiv_ooextendable (fun _ =&gt; C) (@const A Unit tt)
                                    (ooextendable_const_isconnected_inO A C))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1578
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1579
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>

End ConnectedTypes.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1581
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Modally truncated maps *)

(** A map is "in [O]" if each of its fibers is. *)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1586
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>Class MapIn (O : ReflectiveSubuniverse) {A B : Type} (f : A -&gt; B)
  := inO_hfiber_ino_map : forall (b:B), In O (hfiber f b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1587
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Existing Instance inO_hfiber_ino_map.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1589
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section ModalMaps.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1591
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context (O : ReflectiveSubuniverse).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1592
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Any equivalence is modal *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1595
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance mapinO_isequiv {A B : Type} (f : A -&gt; B) `{IsEquiv _ _ f}
  : MapIn O f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1596
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1597
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1598
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (fcontr_isequiv f _ b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1599
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1600
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1601
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Anything homotopic to a modal map is modal. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1604
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition mapinO_homotopic {A B : Type} (f : A -&gt; B) {g : A -&gt; B}
             (p : f == g) `{MapIn O _ _ f}
  : MapIn O g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1606
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1607
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1608
Time: 0.007s">
<div class="time" style="width: 0.27678924476078%"></div>
<pre>
    refine (inO_equiv_inO (hfiber f b)
                          (equiv_hfiber_homotopic f g p b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1610
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1611
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The projection from a family of modal types is modal. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1614
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance mapinO_pr1 {A : Type} {B : A -&gt; Type}
         `{forall a, In O (B a)}
  : MapIn O (@pr1 A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1616
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1617
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1618
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
    refine (inO_equiv_inO (B a) (hfiber_fibration a B)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1619
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1620
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** A slightly specialized result: if [Empty] is modal, then a map with decidable hprop fibers (such as [inl] or [inr]) is modal. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1623
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance mapinO_hfiber_decidable_hprop {A B : Type} (f : A -&gt; B)
         `{In O Empty}
         `{forall b, IsHProp (hfiber f b)}
         `{forall b, Decidable (hfiber f b)}
  : MapIn O f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1627
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1628
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1629
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    destruct (equiv_decidable_hprop (hfiber f b)) as [e|e].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1630
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1631
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre> exact (inO_equiv_inO Unit e^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1631
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1632
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre> exact (inO_equiv_inO Empty e^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1632
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1633
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Being modal is an hprop *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1636
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance ishprop_mapinO `{Funext} {A B : Type} (f : A -&gt; B)
  : IsHProp (MapIn O f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1637
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1638
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
    apply trunc_forall.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1640
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Any map between modal types is modal. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1643
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance mapinO_between_inO {A B : Type} (f : A -&gt; B)
             `{In O A} `{In O B}
  : MapIn O f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1645
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1646
Time: 0.01s">
<div class="time" style="width: 0.39541320680111%"></div>
<pre>
    intros b; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1647
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1648
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Modal maps cancel on the left *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1651
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition cancelL_mapinO {A B C : Type} (f : A -&gt; B) (g : B -&gt; C)
  : MapIn O g -&gt; MapIn O (g o f) -&gt; MapIn O f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1652
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1653
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros ? ? b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1654
Time: 0.031s">
<div class="time" style="width: 1.2257809410834%"></div>
<pre>
    refine (inO_equiv_inO _ (hfiber_hfiber_compose_map f g b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1655
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1656
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The pullback of a modal map is modal *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1659
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Global Instance mapinO_pullback {A B C}
         (f : B -&gt; A) (g : C -&gt; A) `{MapIn O _ _ g}
  : MapIn O (f^* g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1661
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1662
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1663
Time: 0.03s">
<div class="time" style="width: 1.1862396204033%"></div>
<pre>
    refine (inO_equiv_inO _ (hfiber_pullback_along f g b)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1664
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1665
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance mapinO_pullback' {A B C}
         (g : C -&gt; A) (f : B -&gt; A) `{MapIn O _ _ f}
  : MapIn O (g^*' f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1669
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1670
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros c.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1671
Time: 0.017s">
<div class="time" style="width: 0.67220245156188%"></div>
<pre>
    refine (inO_equiv_inO _ (hfiber_pullback_along' g f c)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1672
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1673
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** [functor_sum] preserves modal maps. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1676
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Global Instance mapinO_functor_sum {A A' B B'}
         (f : A -&gt; A') (g : B -&gt; B') `{MapIn O _ _ f} `{MapIn O _ _ g}
  : MapIn O (functor_sum f g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1678
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1679
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [a|b].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1680
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1681
Time: 0.067s">
<div class="time" style="width: 2.6492684855674%"></div>
<pre> refine (inO_equiv_inO _ (hfiber_functor_sum_l f g a)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1681
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1682
Time: 0.064s">
<div class="time" style="width: 2.5306445235271%"></div>
<pre> refine (inO_equiv_inO _ (hfiber_functor_sum_r f g b)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1682
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1683
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** So does [unfunctor_sum], if both summands are preserved.  These can't be [Instance]s since they require [Ha] and [Hb] to be supplied. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1686
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition mapinO_unfunctor_sum_l {A A' B B'}
         (h : A + B -&gt; A' + B')
         (Ha : forall a:A, is_inl (h (inl a)))
         (Hb : forall b:B, is_inr (h (inr b)))
         `{MapIn O _ _ h}
  : MapIn O (unfunctor_sum_l h Ha).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1691
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1692
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1693
Time: 0.115s">
<div class="time" style="width: 4.5472518782127%"></div>
<pre>
    refine (inO_equiv_inO _ (hfiber_unfunctor_sum_l h Ha Hb a)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1694
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1695
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

  Definition mapinO_unfunctor_sum_r {A A' B B'}
         (h : A + B -&gt; A' + B')
         (Ha : forall a:A, is_inl (h (inl a)))
         (Hb : forall b:B, is_inr (h (inr b)))
         `{MapIn O _ _ h}
  : MapIn O (unfunctor_sum_r h Hb).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1702
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1703
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1704
Time: 0.118s">
<div class="time" style="width: 4.6658758402531%"></div>
<pre>
    refine (inO_equiv_inO _ (hfiber_unfunctor_sum_r h Ha Hb b)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1705
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1706
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>

End ModalMaps.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1708
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Modally connected maps *)

(** Connectedness of a map can again be defined in two equivalent ways: by connectedness of its fibers (as types), or by the lifting property/elimination principle against truncated types.  We use the former; the equivalence with the latter is given below in [conn_map_elim], [conn_map_comp], and [conn_map_from_extension_elim]. *)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1713
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>Class IsConnMap (O : ReflectiveSubuniverse@{u a})
      {A : Type@{i}} {B : Type@{j}} (f : A -&gt; B)
  := isconnected_hfiber_conn_map
     (** The extra universe [k] is &gt;= max(i,j). *)
     : forall b:B, IsConnected@{u a k} O (hfiber@{i j} f b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1717
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Check IsConnMap@{u a i j k}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1718
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Existing Instance isconnected_hfiber_conn_map.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1720
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section ConnectedMaps.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1722
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{Univalence} `{Funext}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1723
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context (O : ReflectiveSubuniverse).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1724
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Any equivalence is connected *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1727
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance conn_map_isequiv {A B : Type} (f : A -&gt; B) `{IsEquiv _ _ f}
  : IsConnMap O f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1728
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1729
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1730
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (fcontr_isequiv f _ b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1731
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    unfold IsConnected; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1732
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1733
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Anything homotopic to a connected map is connected. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1736
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition conn_map_homotopic {A B : Type} (f g : A -&gt; B) (h : f == g)
  : IsConnMap O f -&gt; IsConnMap O g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1737
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1738
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros ? b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1739
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>
    exact (isconnected_equiv O (hfiber f b)
                             (equiv_hfiber_homotopic f g h b) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1741
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1742
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The pullback of a connected map is connected *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1745
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Global Instance conn_map_pullback {A B C}
         (f : B -&gt; A) (g : C -&gt; A) `{IsConnMap O _ _ g}
  : IsConnMap O (f^* g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1747
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1748
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1749
Time: 0.019s">
<div class="time" style="width: 0.7512850929221%"></div>
<pre>
    refine (isconnected_equiv _ _ (hfiber_pullback_along f g b)^-1 _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1750
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1751
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

  Global Instance conn_map_pullback' {A B C}
         (g : C -&gt; A) (f : B -&gt; A) `{IsConnMap O _ _ f}
  : IsConnMap O (g^*' f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1755
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1756
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros c.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1757
Time: 0.02s">
<div class="time" style="width: 0.79082641360221%"></div>
<pre>
    refine (isconnected_equiv _ _ (hfiber_pullback_along' g f c)^-1 _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1758
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1759
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The projection from a family of connected types is connected. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1762
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance conn_map_pr1 {A : Type} {B : A -&gt; Type}
         `{forall a, IsConnected O (B a)}
  : IsConnMap O (@pr1 A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1764
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1765
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1766
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
    refine (isconnected_equiv O (B a) (hfiber_fibration a B) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1767
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1768
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Being connected is an hprop *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1771
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance ishprop_isconnmap `{Funext} {A B : Type} (f : A -&gt; B)
  : IsHProp (IsConnMap O f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1772
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1773
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
    apply trunc_forall.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1774
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1775
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** n-connected maps are orthogonal to n-truncated maps (i.e. familes of n-truncated types). *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1778
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition conn_map_elim
             {A B : Type} (f : A -&gt; B) `{IsConnMap O _ _ f}
             (P : B -&gt; Type) `{forall b:B, In O (P b)}
             (d : forall a:A, P (f a))
  : forall b:B, P b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1782
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1783
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1784
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    refine (pr1 (isconnected_elim O _ _)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1785
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [a p].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1786
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (transport P p (d a)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1787
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1788
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

  Definition conn_map_comp
             {A B : Type} (f : A -&gt; B) `{IsConnMap O _ _ f}
             (P : B -&gt; Type) `{forall b:B, In O (P b)}
             (d : forall a:A, P (f a))
  : forall a:A, conn_map_elim f P d (f a) = d a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1794
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1795
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1796
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold conn_map_elim.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1796
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    set (fibermap := (fun a0p : hfiber f (f a)
                      =&gt; let (a0, p) := a0p in transport P p (d a0))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1798
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
    destruct (isconnected_elim O (P (f a)) fibermap) as [x e].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1799
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change (d a) with (fibermap (a;1)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1800
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply inverse, e.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1801
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1802
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** A map which is both connected and modal is an equivalence. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1805
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition isequiv_conn_ino_map {A B : Type} (f : A -&gt; B)
             `{IsConnMap O _ _ f} `{MapIn O _ _ f}
  : IsEquiv f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1807
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1808
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply isequiv_fcontr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1809
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1809
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    apply (contr_trunc_conn O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1810
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1811
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We can re-express this in terms of extensions. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1814
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma extension_conn_map_elim
        {A B : Type} (f : A -&gt; B) `{IsConnMap O _ _ f}
        (P : B -&gt; Type) `{forall b:B, In O (P b)}
        (d : forall a:A, P (f a))
  : ExtensionAlong f P d.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1818
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1819
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists (conn_map_elim f P d).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1820
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply conn_map_comp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1821
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1822
Time: 0.01s">
<div class="time" style="width: 0.39541320680111%"></div>
<pre>

  Definition extendable_conn_map_inO (n : nat)
             {A B : Type} (f : A -&gt; B) `{IsConnMap O _ _ f}
             (P : B -&gt; Type) `{forall b:B, In O (P b)}
  : ExtendableAlong n f P.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1827
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1828
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    generalize dependent P.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1829
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simple_induction n n IHn; intros P ?; [ exact tt | split ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1830
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1831
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros d; apply extension_conn_map_elim; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1831
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1832
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> intros h k; apply IHn; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1832
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1833
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

  Definition ooextendable_conn_map_inO
             {A B : Type} (f : A -&gt; B) `{IsConnMap O _ _ f}
             (P : B -&gt; Type) `{forall b:B, In O (P b)}
  : ooExtendableAlong f P
    := fun n =&gt; extendable_conn_map_inO n f P.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1839
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

  Lemma allpath_extension_conn_map
        {A B : Type} (f : A -&gt; B) `{IsConnMap O _ _ f}
        (P : B -&gt; Type) `{forall b:B, In O (P b)}
        (d : forall a:A, P (f a))
        (e e' : ExtensionAlong f P d)
  : e = e'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1846
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1847
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_extension.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1848
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
    refine (extension_conn_map_elim _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1849
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1850
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** It follows that [conn_map_elim] is actually an equivalence. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1853
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem isequiv_o_conn_map 
          {A B : Type} (f : A -&gt; B) `{IsConnMap O _ _ f}
          (P : B -&gt; Type) `{forall b:B, In O (P b)}
  : IsEquiv (fun (g : forall b:B, P b) =&gt; g oD f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1856
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1857
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply isequiv_fcontr; intros d.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1858
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply contr_inhabited_hprop.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1859
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1860
Time: 0.12s">
<div class="time" style="width: 4.7449584816133%"></div>
<pre> refine (@trunc_equiv' {g : forall b, P b &amp; g oD f == d} _ _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1860
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1861
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (equiv_functor_sigma_id _); intros g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1861
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply equiv_path_forall.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1862
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1862
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply hprop_allpath.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1863
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros g h.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1863
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (allpath_extension_conn_map f P d g h).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1864
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1865
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exists (conn_map_elim f P d).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1865
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      apply path_forall; intros x; apply conn_map_comp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1866
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1867
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Conversely, if a map satisfies this elimination principle (expressed via extensions), then it is connected.  This completes the proof of Lemma 7.5.7 from the book. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1870
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma conn_map_from_extension_elim {A B : Type} (f : A -&gt; B)
  : (forall (P : B -&gt; Type) {P_inO : forall b:B, In O (P b)}
            (d : forall a:A, P (f a)),
       ExtensionAlong f P d)
    -&gt; IsConnMap O f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1874
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1875
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros Hf b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1876
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply isconnected_from_elim_to_O.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1876
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
    assert (e := Hf (fun b =&gt; O (hfiber f b)) _ (fun a =&gt; to O _ (a;1))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1877
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists (e.1 b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1878
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [a p].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1879
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1879
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    symmetry; apply (e.2).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1880
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1881
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Lemma 7.5.6: Connected maps compose and cancel on the right. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1884
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Global Instance conn_map_compose {A B C : Type} (f : A -&gt; B) (g : B -&gt; C)
         `{IsConnMap O _ _ f} `{IsConnMap O _ _ g}
  : IsConnMap O (g o f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1886
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1887
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply conn_map_from_extension_elim; intros P ? d.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1888
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
    exists (conn_map_elim g P (conn_map_elim f (P o g) d)); intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1889
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    exact (conn_map_comp g P _ _ @ conn_map_comp f (P o g) d a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1890
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1891
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>      

  Definition cancelR_conn_map {A B C : Type} (f : A -&gt; B) (g : B -&gt; C)
         `{IsConnMap O _ _ f} `{IsConnMap O _ _ (g o f)}
  :  IsConnMap O g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1895
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1896
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply conn_map_from_extension_elim; intros P ? d.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1897
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    exists (conn_map_elim (g o f) P (d oD f)); intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1898
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
    pattern b; refine (conn_map_elim f _ _ b); intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1899
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    exact (conn_map_comp (g o f) P (d oD f) a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1900
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1901
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Connected maps also cancel with equivalences on the other side. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1904
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition cancelR_isequiv_conn_map {A B C : Type} (f : A -&gt; B) (g : B -&gt; C)
         `{IsEquiv _ _ g} `{IsConnMap O _ _ (g o f)}
    : IsConnMap O f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1906
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1907
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1908
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    srefine (isconnected_equiv' O (hfiber (g o f) (g b)) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1909
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (equiv_inverse (equiv_functor_sigma_id (fun a =&gt; equiv_ap g (f a) b))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1910
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1911
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>

  Definition cancelR_equiv_conn_map {A B C : Type} (f : A -&gt; B) (g : B &lt;~&gt; C)
         `{IsConnMap O _ _ (g o f)}
    : IsConnMap O f
    := cancelR_isequiv_conn_map f g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1916
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The constant map to [Unit] is connected just when its domain is. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1919
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition isconnected_conn_map_to_unit {A : Type}
             `{IsConnMap O _ _ (@const A Unit tt)}
  : IsConnected O A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1921
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1922
Time: 0.006s">
<div class="time" style="width: 0.23724792408066%"></div>
<pre>
    refine (isconnected_equiv O (hfiber (@const A Unit tt) tt)
              (equiv_sigma_contr (fun a:A =&gt; const tt a = tt)) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1924
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1925
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Hint Immediate isconnected_conn_map_to_unit : typeclass_instances.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1927
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance conn_map_to_unit_isconnected {A : Type}
         `{IsConnected O A}
  : IsConnMap O (@const A Unit tt).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1931
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1932
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros u.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1933
Time: 0.007s">
<div class="time" style="width: 0.27678924476078%"></div>
<pre>
    refine (isconnected_equiv O A
              (equiv_sigma_contr (fun a:A =&gt; const tt a = u))^-1 _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1935
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1936
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (* Lemma 7.5.10: A map to a type in [O] exhibits its codomain as the [O]-reflection of its domain if it is [O]-connected.  (The converse is true if and only if [O] is a modality.) *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1939
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition isequiv_O_rec_conn_map {A B : Type} `{In O B}
             (f : A -&gt; B) `{IsConnMap O _ _ f}
  : IsEquiv (O_rec f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1941
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1942
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
    refine (isequiv_adjointify _ (conn_map_elim f (fun _ =&gt; O A) (to O A)) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1943
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1944
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1944
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> pattern x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1944
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
      refine (conn_map_elim f _ _ x); intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1945
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      exact (ap (O_rec f)
                (conn_map_comp f (fun _ =&gt; O A) (to O A) a)
                @ O_rec_beta f a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1948
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1949
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> apply O_indpaths; intros a; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1949
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap _ (O_rec_beta f a) @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1950
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (conn_map_comp f (fun _ =&gt; O A) (to O A) a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1951
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1952
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Lemma 7.5.12 *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1955
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section ConnMapFunctorSigma.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1955
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Context {A B : Type} {P : A -&gt; Type} {Q : B -&gt; Type}
            (f : A -&gt; B) (g : forall a, P a -&gt; Q (f a))
            `{forall a, IsConnMap O (g a)}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1959
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

    Definition equiv_O_hfiber_functor_sigma (b:B) (v:Q b)
    : O (hfiber (functor_sigma f g) (b;v)) &lt;~&gt; O (hfiber f b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1962
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1963
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      equiv_via (O {w : hfiber f b &amp; hfiber (g w.1) ((w.2)^ # v)}).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1964
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1965
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> apply equiv_O_functor, hfiber_functor_sigma.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1965
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1965
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      equiv_via (O {w : hfiber f b &amp; O (hfiber (g w.1) ((w.2)^ # v))}).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1966
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1967
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> symmetry; apply equiv_O_sigma_O.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1967
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1967
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1968
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
      apply equiv_sigma_contr; intros [a p]; simpl; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1969
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1970
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance conn_map_functor_sigma `{IsConnMap O _ _ f}
    : IsConnMap O (functor_sigma f g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1973
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1974
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros [b v].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1975
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
      refine (contr_equiv' _ (equiv_inverse (equiv_O_hfiber_functor_sigma b v))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1976
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1977
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition conn_map_base_inhabited (inh : forall b, Q b)
               `{IsConnMap O _ _ (functor_sigma f g)}
    : IsConnMap O f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1981
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1982
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1983
Time: 0.011s">
<div class="time" style="width: 0.43495452748122%"></div>
<pre>
      refine (contr_equiv _ (equiv_O_hfiber_functor_sigma b (inh b))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1984
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1985
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>

  End ConnMapFunctorSigma.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1987
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Lemma 7.5.13.  The "if" direction is a special case of [conn_map_functor_sigma], so we prove only the "only if" direction. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1990
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Definition conn_map_fiber
             {A : Type} {P Q : A -&gt; Type} (f : forall a, P a -&gt; Q a)
             `{IsConnMap O _ _ (functor_sigma idmap f)}
  : forall a, IsConnMap O (f a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1993
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1994
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a q.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1995
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
    refine (isconnected_equiv' O (hfiber (functor_sigma idmap f) (a;q)) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1996
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (hfiber_functor_sigma_idmap P Q f a q).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1997
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1998
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Lemma 7.5.14: Connected maps are inverted by [O]. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2001
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance O_inverts_conn_map {A B : Type} (f : A -&gt; B)
         `{IsConnMap O _ _ f}
  : IsEquiv (O_functor O f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2003
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2004
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simple refine (isequiv_adjointify _ _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2005
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2006
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_rec; intros y.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2006
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
      exact (O_functor O pr1 (center (O (hfiber f y)))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2007
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2008
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> unfold Sect; apply O_indpaths; try exact _; intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2008
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      refine (ap (O_functor O f) (O_rec_beta _ b) @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2009
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      refine ((O_functor_compose _ _ _ _)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2010
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      set (x := (center (O (hfiber f b)))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2011
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      clearbody x; revert x; apply O_indpaths; try exact _; intros [a p].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2012
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
      refine (O_rec_beta (to O B o (f o pr1)) (a;p) @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2013
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (ap (to O B) p).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2014
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2015
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre> unfold Sect; apply O_indpaths; try exact _; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2015
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      refine (ap (O_rec _) (to_O_natural O f a) @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2016
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (O_rec_beta _ _ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2017
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
      transitivity (O_functor O pr1 (to O (hfiber f (f a)) (a;1))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2018
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2019
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap, contr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2019
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2020
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (to_O_natural _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2020
Time: 0.007s">
<div class="time" style="width: 0.27678924476078%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2021
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** As a consequence, connected maps between modal types are equivalences. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2024
Time: 0.022s">
<div class="time" style="width: 0.86990905496244%"></div>
<pre>Definition isequiv_conn_map_ino {A B : Type} (f : A -&gt; B)
         `{In O A} `{In O B} `{IsConnMap O _ _ f}
    : IsEquiv f
    := isequiv_commsq' f (O_functor O f) (to O A) (to O B) (to_O_natural O f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2027
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Connectedness is preserved by [O_functor]. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2030
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>Global Instance conn_map_O_functor {A B} (f : A -&gt; B) `{IsConnMap O _ _ f}
    : IsConnMap O (O_functor O f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2031
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2032
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2033
Time: 0.015s">
<div class="time" style="width: 0.59311981020166%"></div>
<pre>
    erapply conn_map_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2034
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2035
Time: 0.018s">
<div class="time" style="width: 0.71174377224199%"></div>
<pre>

End ConnectedMaps.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2037
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** ** Separated subuniverses *)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2041
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Separated.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2041
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Universes Ou Oa.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2042
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {O' O : ReflectiveSubuniverse@{Ou Oa}} {sep : IsSepFor@{Ou Oa} O' O}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2043
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance inSepO_inO {A : Type} `{In O A} : In O' A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2045
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2046
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>
    rapply inSepO_from_inO_paths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2047
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2048
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance inSepO_hprop {A : Type} {hp : IsHProp A} : In O' A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2050
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2051
Time: 0.005s">
<div class="time" style="width: 0.19770660340055%"></div>
<pre>
    rapply inSepO_from_inO_paths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2052
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2053
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Proposition 2.18 of CORS.  Since we have universe-polymorphic RSUs, we can state it in the simpler form "[Type_ O] is in [O']".  Note the universe parameters: [Type_@{Ou Oa j i}] is a subtype of [Type@{i}], which is an element of [Type@{j}] (so that [i&lt;j]).  The extra parameter [k] is required by separatedness. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2056
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inSepO_typeO@{i j k} `{Univalence} : In O' (Type_@{Ou Oa j i} O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2056
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2057
Time: 0.084s">
<div class="time" style="width: 3.3214709371293%"></div>
<pre>
    rapply inSepO_from_inO_paths@{Ou Oa j k}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2058
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1:exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2059
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** For some reason, if we keep [A] and [B] in [Type_ O] and coerce them to [Type] (or write [A.1] and [B.1]), instead of destructing them into elements of [Type], then the universes get collapsed to [i=a] and [j=u].  I can't figure out why that is; maybe a bug in Coq? *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2061
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>intros [A A_inO] [B B_inO].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2061
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (inO_equiv@{Ou Oa i i i j i i} O A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2062
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (inO_equiv_inO'@{Ou Oa i j j} O (A &lt;~&gt; B) (equiv_compose'@{i j j} _ _)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2063
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2064
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (equiv_path_TypeO@{Ou Oa j i} O (A;_) (B;_)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2064
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2065
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply equiv_path_universe.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2065
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2066
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Lemma 2.21 of CORS *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2069
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inSepO_sigma {X : Type} {P : X -&gt; Type} `{In O' X} `{forall x, In O (P x)}
    : In O' (sig P).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2070
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2071
Time: 0.051s">
<div class="time" style="width: 2.0166073546856%"></div>
<pre>
    rapply inSepO_from_inO_paths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2072
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1:exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2073
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [x p] [y q].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2074
Time: 0.034s">
<div class="time" style="width: 1.3444049031238%"></div>
<pre>
    refine (inO_equiv_inO' O _ (equiv_path_sigma P (x;p) (y;q))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2075
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2076
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Proposition 2.22 of CORS (in funext-free form).  Universe parameters are [i j k kplus kplus kplus]. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2079
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition extendable_toSepO_inO
             {X : Type@{i}} (P : O' X -&gt; Type@{j}) `{forall x, In@{Ou Oa j} O (P x)}
    : ooExtendableAlong@{i i j k} (to O' X) P.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2081
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2082
Time: 0.059s">
<div class="time" style="width: 2.3329379201265%"></div>
<pre>
    rapply extendable_from_inO_sigma@{Ou Oa i j k kplus k k k kplus k k kplus}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2083
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2084
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** And now the version with funext.  Universe parameters are [i j k kplus kplus kplus]. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2087
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>Definition isequiv_toSepO_inO `{Funext}
             {X : Type@{i}} (P : O' X -&gt; Type@{j}) `{forall x, In@{Ou Oa j} O (P x)}
    : IsEquiv@{k k} (fun g : (forall y, P y) =&gt; g o to O' X)
    := isequiv_ooextendable@{i i j k k k k k k k k} _ _ (extendable_toSepO_inO P).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2090
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

  Definition equiv_toSepO_inO@{i j k kplus} `{Funext}
             {X : Type@{i}} (P : O' X -&gt; Type@{j}) `{forall x, In O (P x)}
    : (forall y, P y) &lt;~&gt; (forall x, P (to O' X x))
    := Build_Equiv _ _ _ (isequiv_toSepO_inO@{i j k kplus kplus kplus} P).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2095
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Proposition 2.26 of CORS *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2098
Time: 0.044s">
<div class="time" style="width: 1.7398181099249%"></div>
<pre>Definition path_SepO {X : Type@{i}} (x y : X)
    : O (x = y) -&gt; (to O' X x = to O' X y)
    := O_rec (O := O) (@ap X (O' X) (to O' X) x y).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance isequiv_path_SepO `{Univalence} {X : Type@{i}} (x y : X)
    : IsEquiv (path_SepO x y).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (* First we define a family [P : O' X -&gt; Type] of [O]-modal types that extends [O (x = ?) : X -&gt; Type], using the fact that the universe of [O]-modal types is [O']-modal.  [Pb] is its non-definitional computation rule that we will have to transport across.  *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>pose (Oxeq := fun y : X =&gt; (O (x = y); O_inO (x = y)) : Type_ O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2106
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    assert (Pb := fun y =&gt; (O_rec_beta@{Ou Oa i j j i j} Oxeq y)..1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2107
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    set (P := O_rec Oxeq) in *; subst Oxeq; cbn in *.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (* We will first construct an equivalence [P y' &lt;~&gt; (to O' X x = y')] by a version of encode-decode, then show that when [y' = to O' X y] this equivalence is homotopic to [path_SepO]. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>serapply isequiv_homotopic'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* First we generalize from [y:X] to [y':O' X]. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>refine (_ oE equiv_path _ _ (Pb y)^).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      generalize (to O' X y) as y'; clear y.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* Now by a standard result, it suffices to show that [P] is a pointed predicate whose total space is contractible. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>apply equiv_path_from_contr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* The point is just the image of [idpath x], but we have to transport it across [Pb] to put it in the right type. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>1:exact (transport idmap (Pb x)^ (to O _ idpath)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* The same point supplies the center of contraction. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2119
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>exists (to O' X x; transport idmap (Pb x)^ (to O _ idpath)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros [y' p]; revert y' p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* To construct a contraction, we first observe that it suffices to return to the case [y:X]. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2122
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>pose (H1 := @inSepO_sigma); pose (H2 := @inO_paths_from_inSepO); pose (H3 := @inO_forall);
        refine ((extension_from_inO_sigma O' _ _).1); clear H1 H2 H3.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros y.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* Now we have to transport [p] again across the computation rule [Pb]. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2126
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>equiv_intro (equiv_path _ _ (Pb y)^) p; revert p; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* We claim that once again, it suffices to assume [p:x=y]. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2128
Time: 0.063s">
<div class="time" style="width: 2.491103202847%"></div>
<pre>refine ((extension_from_inO_sigma O _ _).1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2129
Time: 0.046s">
<div class="time" style="width: 1.8189007512851%"></div>
<pre> refine (inO_equiv_inO' _ (to O' X x = to O' X y) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        (* First we change the equality in a sigma-type to a pair of equalities. *)
       </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>refine (equiv_functor_sigma_id _ oE _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        1:intros p; apply equiv_path_sigma.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        (* Now we rearrange things to see that the two extra components are equivalent to a contractible based path space. *)
       </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2134
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2134
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (equiv_sigma_symm _ oE _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2134
Time: 0.1s">
<div class="time" style="width: 3.9541320680111%"></div>
<pre>
        refine ((equiv_sigma_contr _)^-1%equiv).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine (@contr_equiv' _ _ _ (@contr_basedpaths (O (x = y)) _)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply equiv_functor_sigma_id; intros q; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (equiv_moveL_transport_V idmap (Pb y) _ q).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* Now it's easy by path induction. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2140
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>intros p; destruct p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (* Finally, since [path_SepO] is the unique map making a commutative triangle with [to O' X], to show that the above equivalence is homotopic to [path_SepO] it suffices to show that it also makes that triangle commute. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>{</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2143
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre> unfold equiv_path_from_contr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2143
Time: 0.065s">
<div class="time" style="width: 2.5701858442072%"></div>
<pre>
      apply O_indpaths; intros p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2144
Time: 0.003s">
<div class="time" style="width: 0.11862396204033%"></div>
<pre>
      refine (_ @ (O_rec_beta _ _)^).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* In fact it's easier to show that the *inverse* of this equivalence makes the triangle commute in the other direction. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2147
Time: 0.015s">
<div class="time" style="width: 0.59311981020166%"></div>
<pre>apply moveR_equiv_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* Which is true by a simple path induction, since that inverse was in turn defined by a path induction. *)
     </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2149
Time: 0.026s">
<div class="time" style="width: 1.0280743376829%"></div>
<pre>destruct p; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2150
Time: 0.157s">
<div class="time" style="width: 6.2079873467774%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2151
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

  Definition equiv_path_SepO `{Univalence} {A : Type} (x y : A)
    : O (x = y) &lt;~&gt; (to O' A x = to O' A y)
    := Build_Equiv _ _ _ (isequiv_path_SepO x y).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance conn_map_toSepO@{i} {X : Type@{i} }
    : IsConnMap O (to O' X).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply conn_map_from_extension_elim@{Ou Oa i i i i}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros Q Q_inO h.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (fst (extendable_toSepO_inO@{i i i Ou Ou Ou} _ 1%nat) h).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** A strengthening of Lemma 2.27 of CORS.  We provide a different proof that doesn't require [Funext]. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance conn_map_functor_sigma_toSepO@{i j}
         {X : Type@{i} } (P : O' X -&gt; Type@{j})
    : IsConnMap O (functor_sigma@{i j i j} (Q := P) (to O' X) (fun x =&gt; idmap)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2169
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>
    serapply conn_map_functor_sigma@{Ou Oa i i i i i i i i i i i i i i Ou i i i i i i i Ou i i}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2171
Time: 0.009s">
<div class="time" style="width: 0.355871886121%"></div>
<pre>

  Definition equiv_functor_sigma_to_SepO@{i j}
             {X : Type@{i} } (P : O' X -&gt; Type@{j})
    : (O {x : X &amp; P (to O' X x)}) &lt;~&gt; (O {ox : O' X &amp; P ox})
    := Build_Equiv _ _ (O_functor O (functor_sigma@{i j i j} _ _)) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Corollary 2.29 of CORS *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2179
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre>Global Instance SepO_inverts_functor_hfiber `{Univalence}
         {Y X : Type@{i} } (f : Y -&gt; X) (x : X)
    : O_inverts O (functor_hfiber@{i i i i} (fun y =&gt; (to_O_natural O' f y)^) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    serapply isequiv_homotopic'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold hfiber.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ oE (equiv_inverse (equiv_O_sigma_O O _))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (equiv_functor_sigma_to_SepO@{i i} _ oE _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2186
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_functor_sigma_id; intros y; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ oE equiv_path_SepO (f y) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_concat_l, to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2191
Time: 0.002s">
<div class="time" style="width: 0.079082641360221%"></div>
<pre> apply O_indpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2191
Time: 0.025s">
<div class="time" style="width: 0.98853301700277%"></div>
<pre>
      intros [y p]; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2192
Time: 0.081s">
<div class="time" style="width: 3.202846975089%"></div>
<pre>
      abstract (
        rewrite O_rec_beta;
        rewrite !(to_O_natural O _ _);
        apply ap; refine (path_sigma' _ 1 _); cbn;
        unfold path_SepO;
        rewrite O_rec_beta, inv_V; reflexivity
      ).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2199
Time: 0.012s">
<div class="time" style="width: 0.47449584816133%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2200
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

  Definition equiv_SepO_functor_hfiber `{Univalence}
             {Y X : Type@{i} } (f : Y -&gt; X) (x : X)
    := Build_Equiv _ _ _ (SepO_inverts_functor_hfiber f x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Proposition 2.30 of CORS *)
  (* Making this an [Instance] breaks typeclass inference in various places. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition conn_map_SepO_inverts `{Univalence} {Y X : Type@{i}} (f : Y -&gt; X)
         `{O_inverts O' f}
    : IsConnMap@{Ou Oa i i i} O f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2212
Time: 0.004s">
<div class="time" style="width: 0.15816528272044%"></div>
<pre>
    refine (contr_equiv' (O (hfiber (O_functor O' f) (to O' X x))) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact ((equiv_SepO_functor_hfiber f x)^-1%equiv).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2215
Time: 0.101s">
<div class="time" style="width: 3.9936733886912%"></div>
<pre>

End Separated.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


End ReflectiveSubuniverses_Theory.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Restriction of a family of reflective subuniverses *)

(** Recall that an implementation of [ReflectiveSubuniverses] is a family of reflective subuniverses indexed by the type [ReflectiveSubuniverse].  Sometimes we want to consider only a subfamily of a known one, or more generally a restriction of such a family along a function.  The second-class nature of modules makes this a bit of a pain to construct, but we can do it. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2224
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Type ReflectiveSubuniverses_Restriction_Data (Os : ReflectiveSubuniverses).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2224
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter New_ReflectiveSubuniverse@{u a} : Type2@{u a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2226
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter ReflectiveSubuniverses_restriction@{u a}
  : New_ReflectiveSubuniverse@{u a} -&gt; Os.ReflectiveSubuniverse@{u a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End ReflectiveSubuniverses_Restriction_Data.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2231
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Module ReflectiveSubuniverses_Restriction
       (Os : ReflectiveSubuniverses)
       (Res : ReflectiveSubuniverses_Restriction_Data Os)
&lt;: ReflectiveSubuniverses.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2236
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition ReflectiveSubuniverse := Res.New_ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_reflector@{u a i} (O : ReflectiveSubuniverse@{u a})
    := Os.O_reflector@{u a i} (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2241
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition In@{u a i} (O : ReflectiveSubuniverse@{u a})
    := Os.In@{u a i} (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition O_inO@{u a i} (O : ReflectiveSubuniverse@{u a})
    := Os.O_inO@{u a i} (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition to@{u a i} (O : ReflectiveSubuniverse@{u a})
    := Os.to@{u a i} (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inO_equiv_inO@{u a i j k} (O : ReflectiveSubuniverse@{u a})
    := Os.inO_equiv_inO@{u a i j k} (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2249
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition hprop_inO@{u a i} (H : Funext) (O : ReflectiveSubuniverse@{u a})
    := Os.hprop_inO@{u a i} H (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2251
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition extendable_to_O@{u a i j k} (O : ReflectiveSubuniverse@{u a})
    := @Os.extendable_to_O@{u a i j k} (Res.ReflectiveSubuniverses_restriction@{u a} O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2253
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition IsSepFor@{u a} (O' O : ReflectiveSubuniverse@{u a})
    := @Os.IsSepFor@{u a} (Res.ReflectiveSubuniverses_restriction@{u a} O') (Res.ReflectiveSubuniverses_restriction@{u a} O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inO_paths_from_inSepO@{u a i iplus} (O' O : ReflectiveSubuniverse@{u a})
    := @Os.inO_paths_from_inSepO@{u a i iplus} (Res.ReflectiveSubuniverses_restriction@{u a} O') (Res.ReflectiveSubuniverses_restriction@{u a} O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2257
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inSepO_from_inO_paths@{u a i iplus} (O' O : ReflectiveSubuniverse@{u a})
    := @Os.inSepO_from_inO_paths@{u a i iplus} (Res.ReflectiveSubuniverses_restriction@{u a} O') (Res.ReflectiveSubuniverses_restriction@{u a} O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2259
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End ReflectiveSubuniverses_Restriction.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Union of families of reflective subuniverses *)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module ReflectiveSubuniverses_FamUnion
       (Os1 Os2 : ReflectiveSubuniverses)
&lt;: ReflectiveSubuniverses.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition ReflectiveSubuniverse@{u a} : Type2@{u a}
    := Os1.ReflectiveSubuniverse@{u a} + Os2.ReflectiveSubuniverse@{u a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Coercion RSU_inl := inl : Os1.ReflectiveSubuniverse -&gt; ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2271
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Coercion RSU_inr := inr : Os2.ReflectiveSubuniverse -&gt; ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_reflector@{u a i} : forall (O : ReflectiveSubuniverse@{u a}),
                             Type2le@{i a} -&gt; Type2le@{i a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2275
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2276
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.O_reflector@{u a i} O)
                  | exact (Os2.O_reflector@{u a i} O) ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2279
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition In@{u a i} : forall (O : ReflectiveSubuniverse@{u a}),
                             Type2le@{i a} -&gt; Type2le@{i a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.In@{u a i} O)
                  | exact (Os2.In@{u a i} O) ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_inO@{u a i}
  : forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}),
      In@{u a i} O (O_reflector@{u a i} O T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2290
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.O_inO@{u a i} O)
                  | exact (Os2.O_inO@{u a i} O) ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2294
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition to@{u a i} : forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}),
                   T -&gt; O_reflector@{u a i} O T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.to@{u a i} O)
                  | exact (Os2.to@{u a i} O) ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition inO_equiv_inO@{u a i j k} :
      forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}) (U : Type@{j})
             (T_inO : In@{u a i} O T) (f : T -&gt; U) (feq : IsEquiv f),
        In@{u a j} O U.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2307
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (Os1.inO_equiv_inO@{u a i j k} O)
                  | exact (Os2.inO_equiv_inO@{u a i j k} O) ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2309
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition hprop_inO@{u a i}
  : Funext -&gt; forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}),
                IsHProp (In@{u a i} O T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros ? [O|O]; [ exact (Os1.hprop_inO@{u a i} _ O)
                    | exact (Os2.hprop_inO@{u a i} _ O) ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2317
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2318
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition extendable_to_O@{u a i j k}
  : forall (O : ReflectiveSubuniverse@{u a}) {P : Type2le@{i a}} {Q : Type2le@{j a}} {Q_inO : In@{u a j} O Q},
      ooExtendableAlong@{i i j k} (to O P) (fun _ =&gt; Q).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2322
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2323
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O|O]; [ exact (@Os1.extendable_to_O@{u a i j k} O)
                  | exact (@Os2.extendable_to_O@{u a i j k} O) ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition IsSepFor@{u a}
    : forall (O' O : ReflectiveSubuniverse@{u a}), Type@{u}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [O'|O'] [O|O];
      [ exact (@Os1.IsSepFor@{u a} O' O)
      | exact Empty
      | exact Empty
      | exact (@Os2.IsSepFor@{u a} O' O) ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition inO_paths_from_inSepO@{u a i iplus}
    : forall (O' O : ReflectiveSubuniverse@{u a}) (sep : IsSepFor O' O)
             (A : Type@{i}) (A_inO : In@{u a i} O' A) (x y : A),
      In@{u a i} O (x = y).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2342
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    intros [O'|O'] [O|O];
      [ exact (@Os1.inO_paths_from_inSepO@{u a i iplus} O' O)
      | contradiction
      | contradiction
      | exact (@Os2.inO_paths_from_inSepO@{u a i iplus} O' O) ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2347
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2348
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition inSepO_from_inO_paths@{u a i iplus}
    : forall (O' O : ReflectiveSubuniverse@{u a}) (sep : IsSepFor O' O)
             (A : Type@{i}),
      (forall (x y : A), In@{u a i} O (x = y)) -&gt; In@{u a i} O' A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2353
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2354
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>
    intros [O'|O'] [O|O];
      [ exact (@Os1.inSepO_from_inO_paths@{u a i iplus} O' O)
      | contradiction
      | contradiction
      | exact (@Os2.inSepO_from_inO_paths@{u a i iplus} O' O) ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2359
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2360
Time: 0.001s">
<div class="time" style="width: 0.039541320680111%"></div>
<pre>

End ReflectiveSubuniverses_FamUnion.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2363
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** For examples of reflective subuniverses, see the examples of modalities listed in the file [Modality], and also [Localization]. *)

</pre>
</div>
</body>
</html>

